import{r as e,a as t,u as n,b as r,L as s,g as i,R as a,c as o,d as l,O as c,N as u,B as h,e as d,f as m}from"./vendor-786b7556.js";import{m as f,A as p}from"./ui-2903c4e2.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var g={exports:{}},y={},v=e,w=Symbol.for("react.element"),b=Symbol.for("react.fragment"),x=Object.prototype.hasOwnProperty,_=v.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,I={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,n){var r,s={},i=null,a=null;for(r in void 0!==n&&(i=""+n),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(a=t.ref),t)x.call(t,r)&&!I.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:w,type:e,key:i,ref:a,props:s,_owner:_.current}}y.Fragment=b,y.jsx=k,y.jsxs=k,g.exports=y;var S=g.exports,T={},E=t;T.createRoot=E.createRoot,T.hydrateRoot=E.hydrateRoot;const N="https://discord.com/api/v10",A=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=63&s|128):55296==(64512&s)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(s=65536+((1023&s)<<10)+(1023&e.charCodeAt(++r)),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=63&s|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=63&s|128)}return t},C={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<e.length;s+=3){const t=e[s],i=s+1<e.length,a=i?e[s+1]:0,o=s+2<e.length,l=o?e[s+2]:0,c=t>>2,u=(3&t)<<4|a>>4;let h=(15&a)<<2|l>>6,d=63&l;o||(d=64,i||(h=64)),r.push(n[c],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(A(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const s=e[n++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=e[n++];t[r++]=String.fromCharCode((31&s)<<6|63&i)}else if(s>239&&s<365){const i=((7&s)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(i>>10)),t[r++]=String.fromCharCode(56320+(1023&i))}else{const i=e[n++],a=e[n++];t[r++]=String.fromCharCode((15&s)<<12|(63&i)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<e.length;){const t=n[e.charAt(s++)],i=s<e.length?n[e.charAt(s)]:0;++s;const a=s<e.length?n[e.charAt(s)]:64;++s;const o=s<e.length?n[e.charAt(s)]:64;if(++s,null==t||null==i||null==a||null==o)throw new j;const l=t<<2|i>>4;if(r.push(l),64!==a){const e=i<<4&240|a>>2;if(r.push(e),64!==o){const e=a<<6&192|o;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class j extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const R=function(e){return function(e){const t=A(e);return C.encodeByteArray(t,!0)}(e).replace(/\./g,"")},D=function(e){try{return C.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const P=()=>
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,O=()=>{try{return P()||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e={}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&D(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},M=e=>{var t,n;return null===(n=null===(t=O())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},L=e=>{const t=M(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},U=()=>{var e;return null===(e=O())||void 0===e?void 0:e.config},F=e=>{var t;return null===(t=O())||void 0===t?void 0:t[`_${e}`]};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
let V=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}};
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[R(JSON.stringify({alg:"none",type:"JWT"})),R(JSON.stringify(i)),""].join(".")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function G(){return!function(){var e;const t=null===(e=O())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(n){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function q(){try{return"object"==typeof indexedDB}catch(e){return!1}}class z extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,z.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,K.prototype.create)}}class K{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],i=s?function(e,t){return e.replace(H,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(s,n):"Error",a=`${this.serviceName}: ${i} (${r}).`;return new z(r,a,n)}}const H=/\{\$([^}]+)}/g;function W(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const s of n){if(!r.includes(s))return!1;const n=e[s],i=t[s];if(Q(n)&&Q(i)){if(!W(n,i))return!1}else if(n!==i)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Q(e){return null!==e&&"object"==typeof e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}class J{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=Y),void 0===r.error&&(r.error=Y),void 0===r.complete&&(r.complete=Y);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),s}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!=typeof console&&console.error&&console.error(n)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function Y(){}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z(e){return e&&e._delegate?e._delegate:e}class ee{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const te="[DEFAULT]";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new V;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e))try{this.getOrInitializeService({instanceIdentifier:te})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(e=te){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=te){return this.instances.has(e)}getOptions(e=te){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,i]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(s)&&i.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),s=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const s of n)try{s(e,t)}catch(r){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===te?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(s){}var r;return n||null}normalizeInstanceIdentifier(e=te){return this.component?this.component.multipleInstances?e:te:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class re{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new ne(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var se,ie;(ie=se||(se={}))[ie.DEBUG=0]="DEBUG",ie[ie.VERBOSE=1]="VERBOSE",ie[ie.INFO=2]="INFO",ie[ie.WARN=3]="WARN",ie[ie.ERROR=4]="ERROR",ie[ie.SILENT=5]="SILENT";const ae={debug:se.DEBUG,verbose:se.VERBOSE,info:se.INFO,warn:se.WARN,error:se.ERROR,silent:se.SILENT},oe=se.INFO,le={[se.DEBUG]:"log",[se.VERBOSE]:"log",[se.INFO]:"info",[se.WARN]:"warn",[se.ERROR]:"error"},ce=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),s=le[t];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[s](`[${r}]  ${e.name}:`,...n)};class ue{constructor(e){this.name=e,this._logLevel=oe,this._logHandler=ce,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in se))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?ae[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,se.DEBUG,...e),this._logHandler(this,se.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,se.VERBOSE,...e),this._logHandler(this,se.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,se.INFO,...e),this._logHandler(this,se.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,se.WARN,...e),this._logHandler(this,se.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,se.ERROR,...e),this._logHandler(this,se.ERROR,...e)}}let he,de;const me=new WeakMap,fe=new WeakMap,pe=new WeakMap,ge=new WeakMap,ye=new WeakMap;let ve={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return fe.get(e);if("objectStoreNames"===t)return e.objectStoreNames||pe.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return xe(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function we(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(de||(de=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(_e(this),t),xe(me.get(this))}:function(...t){return xe(e.apply(_e(this),t))}:function(t,...n){const r=e.call(_e(this),t,...n);return pe.set(r,t.sort?t.sort():[t]),xe(r)}}function be(e){return"function"==typeof e?we(e):(e instanceof IDBTransaction&&function(e){if(fe.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",i),e.removeEventListener("abort",i)},s=()=>{t(),r()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",s),e.addEventListener("error",i),e.addEventListener("abort",i)}));fe.set(e,t)}(e),t=e,(he||(he=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,ve):e);var t}function xe(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",s),e.removeEventListener("error",i)},s=()=>{t(xe(e.result)),r()},i=()=>{n(e.error),r()};e.addEventListener("success",s),e.addEventListener("error",i)}));return t.then((t=>{t instanceof IDBCursor&&me.set(t,e)})).catch((()=>{})),ye.set(t,e),t}(e);if(ge.has(e))return ge.get(e);const t=be(e);return t!==e&&(ge.set(e,t),ye.set(t,e)),t}const _e=e=>ye.get(e);const Ie=["get","getKey","getAll","getAllKeys","count"],ke=["put","add","delete","clear"],Se=new Map;function Te(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Se.get(t))return Se.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,s=ke.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!Ie.includes(n))return;const i=async function(e,...t){const i=this.transaction(e,s?"readwrite":"readonly");let a=i.store;return r&&(a=a.index(t.shift())),(await Promise.all([a[n](...t),s&&i.done]))[0]};return Se.set(t,i),i}ve=(e=>({...e,get:(t,n,r)=>Te(t,n)||e.get(t,n,r),has:(t,n)=>!!Te(t,n)||e.has(t,n)}))(ve);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ee{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const Ne="@firebase/app",Ae="0.10.13",Ce=new ue("@firebase/app"),je="@firebase/app-compat",Re="@firebase/analytics-compat",De="@firebase/analytics",Pe="@firebase/app-check-compat",Oe="@firebase/app-check",Me="@firebase/auth",Le="@firebase/auth-compat",Ue="@firebase/database",Fe="@firebase/data-connect",Ve="@firebase/database-compat",Be="@firebase/functions",$e="@firebase/functions-compat",Ge="@firebase/installations",qe="@firebase/installations-compat",ze="@firebase/messaging",Ke="@firebase/messaging-compat",He="@firebase/performance",We="@firebase/performance-compat",Qe="@firebase/remote-config",Xe="@firebase/remote-config-compat",Je="@firebase/storage",Ye="@firebase/storage-compat",Ze="@firebase/firestore",et="@firebase/vertexai-preview",tt="@firebase/firestore-compat",nt="firebase",rt="[DEFAULT]",st={[Ne]:"fire-core",[je]:"fire-core-compat",[De]:"fire-analytics",[Re]:"fire-analytics-compat",[Oe]:"fire-app-check",[Pe]:"fire-app-check-compat",[Me]:"fire-auth",[Le]:"fire-auth-compat",[Ue]:"fire-rtdb",[Fe]:"fire-data-connect",[Ve]:"fire-rtdb-compat",[Be]:"fire-fn",[$e]:"fire-fn-compat",[Ge]:"fire-iid",[qe]:"fire-iid-compat",[ze]:"fire-fcm",[Ke]:"fire-fcm-compat",[He]:"fire-perf",[We]:"fire-perf-compat",[Qe]:"fire-rc",[Xe]:"fire-rc-compat",[Je]:"fire-gcs",[Ye]:"fire-gcs-compat",[Ze]:"fire-fst",[tt]:"fire-fst-compat",[et]:"fire-vertex","fire-js":"fire-js",[nt]:"fire-js-all"},it=new Map,at=new Map,ot=new Map;function lt(e,t){try{e.container.addComponent(t)}catch(n){Ce.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function ct(e){const t=e.name;if(ot.has(t))return Ce.debug(`There were multiple attempts to register component ${t}.`),!1;ot.set(t,e);for(const n of it.values())lt(n,e);for(const n of at.values())lt(n,e);return!0}function ut(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function ht(e){return void 0!==e.settings}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dt=new K("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class mt{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ee("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw dt.create("app-deleted",{appName:this._name})}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ft="10.14.1";function pt(e,t={}){let n=e;if("object"!=typeof t){t={name:t}}const r=Object.assign({name:rt,automaticDataCollectionEnabled:!1},t),s=r.name;if("string"!=typeof s||!s)throw dt.create("bad-app-name",{appName:String(s)});if(n||(n=U()),!n)throw dt.create("no-options");const i=it.get(s);if(i){if(W(n,i.options)&&W(r,i.config))return i;throw dt.create("duplicate-app",{appName:s})}const a=new re(s);for(const l of ot.values())a.addComponent(l);const o=new mt(n,r,a);return it.set(s,o),o}function gt(e=rt){const t=it.get(e);if(!t&&e===rt&&U())return pt();if(!t)throw dt.create("no-app",{appName:e});return t}function yt(e,t,n){var r;let s=null!==(r=st[e])&&void 0!==r?r:e;n&&(s+=`-${n}`);const i=s.match(/\s|\//),a=t.match(/\s|\//);if(i||a){const e=[`Unable to register library "${s}" with version "${t}":`];return i&&e.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&e.push("and"),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void Ce.warn(e.join(" "))}ct(new ee(`${s}-version`,(()=>({library:s,version:t})),"VERSION"))}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vt="firebase-heartbeat-store";let wt=null;function bt(){return wt||(wt=function(e,t,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(e,t),o=xe(a);return r&&a.addEventListener("upgradeneeded",(e=>{r(xe(a.result),e.oldVersion,e.newVersion,xe(a.transaction),e)})),n&&a.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),o.then((e=>{i&&e.addEventListener("close",(()=>i())),s&&e.addEventListener("versionchange",(e=>s(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),o}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(vt)}catch(n){console.warn(n)}}}).catch((e=>{throw dt.create("idb-open",{originalErrorMessage:e.message})}))),wt}async function xt(e,t){try{const n=(await bt()).transaction(vt,"readwrite"),r=n.objectStore(vt);await r.put(t,_t(e)),await n.done}catch(n){if(n instanceof z)Ce.warn(n.message);else{const e=dt.create("idb-set",{originalErrorMessage:null==n?void 0:n.message});Ce.warn(e.message)}}}function _t(e){return`${e.name}!${e.options.appId}`}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new St(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=kt();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return;return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}catch(n){Ce.warn(n)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=kt(),{heartbeatsToSend:n,unsentEntries:r}=function(e,t=1024){const n=[];let r=e.slice();for(const s of e){const e=n.find((e=>e.agent===s.agent));if(e){if(e.dates.push(s.date),Tt(n)>t){e.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Tt(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),s=R(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Ce.warn(t),""}}}function kt(){return(new Date).toISOString().substring(0,10)}class St{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!q()&&new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var e;t((null===(e=s.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await bt()).transaction(vt),n=await t.objectStore(vt).get(_t(e));return await t.done,n}catch(t){if(t instanceof z)Ce.warn(t.message);else{const e=dt.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});Ce.warn(e.message)}}}(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return xt(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return xt(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Tt(e){return R(JSON.stringify({version:2,heartbeats:e})).length}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Et;Et="",ct(new ee("platform-logger",(e=>new Ee(e)),"PRIVATE")),ct(new ee("heartbeat",(e=>new It(e)),"PRIVATE")),yt(Ne,Ae,Et),yt(Ne,Ae,"esm2017"),yt("fire-js","");var Nt,At,Ct="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};
/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/(function(){var e;
/** @license
  
   Copyright The Closure Library Authors.
   SPDX-License-Identifier: Apache-2.0
  */function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"==typeof t)for(var s=0;16>s;++s)r[s]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(s=0;16>s;++s)r[s]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],s=e.g[2];var i=e.g[3],a=t+(i^n&(s^i))+r[0]+3614090360&4294967295;a=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=n+(a<<7&4294967295|a>>>25))+((a=i+(s^t&(n^s))+r[1]+3905402710&4294967295)<<12&4294967295|a>>>20))+((a=s+(n^i&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^s&(i^t))+r[3]+3250441966&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^n&(s^i))+r[4]+4118548399&4294967295)<<7&4294967295|a>>>25))+((a=i+(s^t&(n^s))+r[5]+1200080426&4294967295)<<12&4294967295|a>>>20))+((a=s+(n^i&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^s&(i^t))+r[7]+4249261313&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^n&(s^i))+r[8]+1770035416&4294967295)<<7&4294967295|a>>>25))+((a=i+(s^t&(n^s))+r[9]+2336552879&4294967295)<<12&4294967295|a>>>20))+((a=s+(n^i&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^s&(i^t))+r[11]+2304563134&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^n&(s^i))+r[12]+1804603682&4294967295)<<7&4294967295|a>>>25))+((a=i+(s^t&(n^s))+r[13]+4254626195&4294967295)<<12&4294967295|a>>>20))+((a=s+(n^i&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^s&(i^t))+r[15]+1236535329&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^i&(n^s))+r[1]+4129170786&4294967295)<<5&4294967295|a>>>27))+((a=i+(n^s&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|a>>>23))+((a=s+(t^n&(i^t))+r[11]+643717713&4294967295)<<14&4294967295|a>>>18))+((a=n+(i^t&(s^i))+r[0]+3921069994&4294967295)<<20&4294967295|a>>>12))+((a=t+(s^i&(n^s))+r[5]+3593408605&4294967295)<<5&4294967295|a>>>27))+((a=i+(n^s&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|a>>>23))+((a=s+(t^n&(i^t))+r[15]+3634488961&4294967295)<<14&4294967295|a>>>18))+((a=n+(i^t&(s^i))+r[4]+3889429448&4294967295)<<20&4294967295|a>>>12))+((a=t+(s^i&(n^s))+r[9]+568446438&4294967295)<<5&4294967295|a>>>27))+((a=i+(n^s&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|a>>>23))+((a=s+(t^n&(i^t))+r[3]+4107603335&4294967295)<<14&4294967295|a>>>18))+((a=n+(i^t&(s^i))+r[8]+1163531501&4294967295)<<20&4294967295|a>>>12))+((a=t+(s^i&(n^s))+r[13]+2850285829&4294967295)<<5&4294967295|a>>>27))+((a=i+(n^s&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|a>>>23))+((a=s+(t^n&(i^t))+r[7]+1735328473&4294967295)<<14&4294967295|a>>>18))+((a=n+(i^t&(s^i))+r[12]+2368359562&4294967295)<<20&4294967295|a>>>12))+((a=t+(n^s^i)+r[5]+4294588738&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^n^s)+r[8]+2272392833&4294967295)<<11&4294967295|a>>>21))+((a=s+(i^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|a>>>16))+((a=n+(s^i^t)+r[14]+4259657740&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^s^i)+r[1]+2763975236&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^n^s)+r[4]+1272893353&4294967295)<<11&4294967295|a>>>21))+((a=s+(i^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|a>>>16))+((a=n+(s^i^t)+r[10]+3200236656&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^s^i)+r[13]+681279174&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^n^s)+r[0]+3936430074&4294967295)<<11&4294967295|a>>>21))+((a=s+(i^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|a>>>16))+((a=n+(s^i^t)+r[6]+76029189&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^s^i)+r[9]+3654602809&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^n^s)+r[12]+3873151461&4294967295)<<11&4294967295|a>>>21))+((a=s+(i^t^n)+r[15]+530742520&4294967295)<<16&4294967295|a>>>16))+((a=n+(s^i^t)+r[2]+3299628645&4294967295)<<23&4294967295|a>>>9))+((a=t+(s^(n|~i))+r[0]+4096336452&4294967295)<<6&4294967295|a>>>26))+((a=i+(n^(t|~s))+r[7]+1126891415&4294967295)<<10&4294967295|a>>>22))+((a=s+(t^(i|~n))+r[14]+2878612391&4294967295)<<15&4294967295|a>>>17))+((a=n+(i^(s|~t))+r[5]+4237533241&4294967295)<<21&4294967295|a>>>11))+((a=t+(s^(n|~i))+r[12]+1700485571&4294967295)<<6&4294967295|a>>>26))+((a=i+(n^(t|~s))+r[3]+2399980690&4294967295)<<10&4294967295|a>>>22))+((a=s+(t^(i|~n))+r[10]+4293915773&4294967295)<<15&4294967295|a>>>17))+((a=n+(i^(s|~t))+r[1]+2240044497&4294967295)<<21&4294967295|a>>>11))+((a=t+(s^(n|~i))+r[8]+1873313359&4294967295)<<6&4294967295|a>>>26))+((a=i+(n^(t|~s))+r[15]+4264355552&4294967295)<<10&4294967295|a>>>22))+((a=s+(t^(i|~n))+r[6]+2734768916&4294967295)<<15&4294967295|a>>>17))+((a=n+(i^(s|~t))+r[13]+1309151649&4294967295)<<21&4294967295|a>>>11))+((i=(t=n+((a=t+(s^(n|~i))+r[4]+4149444226&4294967295)<<6&4294967295|a>>>26))+((a=i+(n^(t|~s))+r[11]+3174756917&4294967295)<<10&4294967295|a>>>22))^((s=i+((a=s+(t^(i|~n))+r[2]+718787259&4294967295)<<15&4294967295|a>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(s+(a<<21&4294967295|a>>>11))&4294967295,e.g[2]=e.g[2]+s&4294967295,e.g[3]=e.g[3]+i&4294967295}function r(e,t){this.h=t;for(var n=[],r=!0,s=e.length-1;0<=s;s--){var i=0|e[s];r&&i==t||(n[s]=i,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var s=Array(arguments.length-2),i=2;i<arguments.length;i++)s[i-2]=arguments[i];return t.prototype[n].apply(e,s)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,s=this.B,i=this.h,a=0;a<t;){if(0==i)for(;a<=r;)n(this,e,a),a+=this.blockSize;if("string"==typeof e){for(;a<t;)if(s[i++]=e.charCodeAt(a++),i==this.blockSize){n(this,s),i=0;break}}else for(;a<t;)if(s[i++]=e[a++],i==this.blockSize){n(this,s),i=0;break}}this.h=i,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var s={};function i(e){return-128<=e&&128>e?function(e,t){var n=s;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new r([0|e],0>e?-1:0)})):new r([0|e],0>e?-1:0)}function a(e){if(isNaN(e)||!isFinite(e))return o;if(0>e)return d(a(-e));for(var t=[],n=1,s=0;e>=n;s++)t[s]=e/n|0,n*=4294967296;return new r(t,0)}var o=i(0),l=i(1),c=i(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function d(e){for(var t=e.g.length,n=[],s=0;s<t;s++)n[s]=~e.g[s];return new r(n,~e.h).add(l)}function m(e,t){return e.add(d(t))}function f(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function p(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new p(o,o);if(h(e))return t=g(d(e),t),new p(d(t.g),d(t.h));if(h(t))return t=g(e,d(t)),new p(d(t.g),t.h);if(30<e.g.length){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;0>=r.l(e);)n=y(n),r=y(r);var s=v(n,1),i=v(r,1);for(r=v(r,2),n=v(n,2);!u(r);){var c=i.add(r);0>=c.l(e)&&(s=s.add(n),i=c),r=v(r,1),n=v(n,1)}return t=m(e,s.j(t)),new p(s,t)}for(s=o;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),c=(i=a(n)).j(t);h(c)||0<c.l(e);)c=(i=a(n-=r)).j(t);u(i)&&(i=l),s=s.add(i),e=m(e,c)}return new p(s,e)}function y(e){for(var t=e.g.length+1,n=[],s=0;s<t;s++)n[s]=e.i(s)<<1|e.i(s-1)>>>31;return new r(n,e.h)}function v(e,t){var n=t>>5;t%=32;for(var s=e.g.length-n,i=[],a=0;a<s;a++)i[a]=0<t?e.i(a+n)>>>t|e.i(a+n+1)<<32-t:e.i(a+n);return new r(i,e.h)}(e=r.prototype).m=function(){if(h(this))return-d(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(h(this))return"-"+d(this).toString(e);for(var t=a(Math.pow(e,6)),n=this,r="";;){var s=g(n,t).g,i=((0<(n=m(n,s.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(u(n=s))return i+r;for(;6>i.length;)i="0"+i;r=i+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return h(e=m(this,e))?-1:u(e)?0:1},e.abs=function(){return h(this)?d(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],s=0,i=0;i<=t;i++){var a=s+(65535&this.i(i))+(65535&e.i(i)),o=(a>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);s=o>>>16,a&=65535,o&=65535,n[i]=o<<16|a}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return o;if(h(this))return h(e)?d(this).j(d(e)):d(d(this).j(e));if(h(e))return d(this.j(d(e)));if(0>this.l(c)&&0>e.l(c))return a(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],s=0;s<2*t;s++)n[s]=0;for(s=0;s<this.g.length;s++)for(var i=0;i<e.g.length;i++){var l=this.i(s)>>>16,m=65535&this.i(s),p=e.i(i)>>>16,g=65535&e.i(i);n[2*s+2*i]+=m*g,f(n,2*s+2*i),n[2*s+2*i+1]+=l*g,f(n,2*s+2*i+1),n[2*s+2*i+1]+=m*p,f(n,2*s+2*i+1),n[2*s+2*i+2]+=l*p,f(n,2*s+2*i+2)}for(s=0;s<t;s++)n[s]=n[2*s+1]<<16|n[2*s];for(s=t;s<2*t;s++)n[s]=0;return new r(n,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],s=0;s<t;s++)n[s]=this.i(s)&e.i(s);return new r(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],s=0;s<t;s++)n[s]=this.i(s)|e.i(s);return new r(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],s=0;s<t;s++)n[s]=this.i(s)^e.i(s);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,At=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=a,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return d(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=a(Math.pow(n,8)),s=o,i=0;i<t.length;i+=8){var l=Math.min(8,t.length-i),c=parseInt(t.substring(i,i+l),n);8>l?(l=a(Math.pow(n,l)),s=s.j(l).add(a(c))):s=(s=s.j(r)).add(a(c))}return s},Nt=r}).apply(void 0!==Ct?Ct:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var jt,Rt,Dt,Pt,Ot,Mt,Lt,Ut,Ft="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};
/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Ft&&Ft];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var s=n;e=e.split(".");for(var i=0;i<e.length-1;i++){var a=e[i];if(!(a in s))break e;s=s[a]}(r=r(i=s[e=e[e.length-1]]))!=i&&null!=r&&t(s,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,s={next:function(){if(!r&&n<e.length){var s=n++;return{value:t(s,e[s]),done:!1}}return r=!0,{done:!0,value:void 0}}};return s[Symbol.iterator]=function(){return s},s}(this,(function(e,t){return t}))}}));
/** @license
  
   Copyright The Closure Library Authors.
   SPDX-License-Identifier: Apache-2.0
  */
var r=r||{},s=this||self;function i(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function a(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function h(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var s=Array(arguments.length-2),i=2;i<arguments.length;i++)s[i-2]=arguments[i];return t.prototype[n].apply(e,s)}}function d(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function m(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(i(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let s=0;s<r;s++)e[n+s]=t[s]}else e.push(t)}}function f(e){return/^[\s\xa0]*$/.test(e)}function p(){var e=s.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var y=!(-1==p().indexOf("Gecko")||-1!=p().toLowerCase().indexOf("webkit")&&-1==p().indexOf("Edge")||-1!=p().indexOf("Trident")||-1!=p().indexOf("MSIE")||-1!=p().indexOf("Edge"));function v(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function w(e){const t={};for(const n in e)t[n]=e[n];return t}const b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(e,t){let n,r;for(let s=1;s<arguments.length;s++){for(n in r=arguments[s],r)e[n]=r[n];for(let t=0;t<b.length;t++)n=b[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function _(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function I(e){s.setTimeout((()=>{throw e}),0)}function k(){var e=A;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var S=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new T),(e=>e.reset()));class T{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let E,N=!1,A=new class{constructor(){this.h=this.g=null}add(e,t){const n=S.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},C=()=>{const e=s.Promise.resolve(void 0);E=()=>{e.then(j)}};var j=()=>{for(var e;e=k();){try{e.h.call(e.g)}catch(n){I(n)}var t=S;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}N=!1};function R(){this.s=this.s,this.C=this.C}function D(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}R.prototype.s=!1,R.prototype.ma=function(){this.s||(this.s=!0,this.N())},R.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},D.prototype.h=function(){this.defaultPrevented=!0};var P=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};s.addEventListener("test",e,t),s.removeEventListener("test",e,t)}catch(n){}return e}();function O(e,t){if(D.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(y){e:{try{g(t.nodeName);var s=!0;break e}catch(i){}s=!1}s||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:M[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&O.aa.h.call(this)}}h(O,D);var M={2:"touch",3:"pen",4:"mouse"};O.prototype.h=function(){O.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var L="closure_listenable_"+(1e6*Math.random()|0),U=0;function F(e,t,n,r,s){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=s,this.key=++U,this.da=this.fa=!1}function V(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function B(e){this.src=e,this.g={},this.h=0}function $(e,t){var n=t.type;if(n in e.g){var r,s=e.g[n],i=Array.prototype.indexOf.call(s,t,void 0);(r=0<=i)&&Array.prototype.splice.call(s,i,1),r&&(V(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function G(e,t,n,r){for(var s=0;s<e.length;++s){var i=e[s];if(!i.da&&i.listener==t&&i.capture==!!n&&i.ha==r)return s}return-1}B.prototype.add=function(e,t,n,r,s){var i=e.toString();(e=this.g[i])||(e=this.g[i]=[],this.h++);var a=G(e,t,r,s);return-1<a?(t=e[a],n||(t.fa=!1)):((t=new F(t,this.src,i,!!r,s)).fa=n,e.push(t)),t};var q="closure_lm_"+(1e6*Math.random()|0),z={};function K(e,t,n,r,s){if(r&&r.once)return W(e,t,n,r,s);if(Array.isArray(t)){for(var i=0;i<t.length;i++)K(e,t[i],n,r,s);return null}return n=te(n),e&&e[L]?e.K(t,n,a(r)?!!r.capture:!!r,s):H(e,t,n,!1,r,s)}function H(e,t,n,r,s,i){if(!t)throw Error("Invalid event type");var o=a(s)?!!s.capture:!!s,l=Z(e);if(l||(e[q]=l=new B(e)),(n=l.add(t,n,r,o,i)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=Y;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)P||(s=o),void 0===s&&(s=!1),e.addEventListener(t.toString(),r,s);else if(e.attachEvent)e.attachEvent(J(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function W(e,t,n,r,s){if(Array.isArray(t)){for(var i=0;i<t.length;i++)W(e,t[i],n,r,s);return null}return n=te(n),e&&e[L]?e.L(t,n,a(r)?!!r.capture:!!r,s):H(e,t,n,!0,r,s)}function Q(e,t,n,r,s){if(Array.isArray(t))for(var i=0;i<t.length;i++)Q(e,t[i],n,r,s);else r=a(r)?!!r.capture:!!r,n=te(n),e&&e[L]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=G(i=e.g[t],n,r,s))&&(V(i[n]),Array.prototype.splice.call(i,n,1),0==i.length&&(delete e.g[t],e.h--)))):e&&(e=Z(e))&&(t=e.g[t.toString()],e=-1,t&&(e=G(t,n,r,s)),(n=-1<e?t[e]:null)&&X(n))}function X(e){if("number"!=typeof e&&e&&!e.da){var t=e.src;if(t&&t[L])$(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(J(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Z(t))?($(n,e),0==n.h&&(n.src=null,t[q]=null)):V(e)}}}function J(e){return e in z?z[e]:z[e]="on"+e}function Y(e,t){if(e.da)e=!0;else{t=new O(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&X(e),e=n.call(r,t)}return e}function Z(e){return(e=e[q])instanceof B?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"==typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){R.call(this),this.i=new B(this),this.M=this,this.F=null}function re(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"==typeof t)t=new D(t,e);else if(t instanceof D)t.target=t.target||e;else{var s=t;x(t=new D(r,e),s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var a=t.g=n[i];s=se(a,r,!0,t)&&s}if(s=se(a=t.g=e,r,!0,t)&&s,s=se(a,r,!1,t)&&s,n)for(i=0;i<n.length;i++)s=se(a=t.g=n[i],r,!1,t)&&s}function se(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var s=!0,i=0;i<t.length;++i){var a=t[i];if(a&&!a.da&&a.capture==n){var o=a.listener,l=a.ha||a.src;a.fa&&$(e.i,a),s=!1!==o.call(l,r)&&s}}return s&&!r.defaultPrevented}function ie(e,t,n){if("function"==typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:s.setTimeout(e,t||0)}function ae(e){e.g=ie((()=>{e.g=null,e.i&&(e.i=!1,ae(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}h(ne,R),ne.prototype[L]=!0,ne.prototype.removeEventListener=function(e,t,n,r){Q(this,e,t,n,r)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)V(n[r]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ne.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class oe extends R{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ae(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){R.call(this),this.h=e,this.g={}}h(le,R);var ce=[];function ue(e){v(e.g,(function(e,t){this.g.hasOwnProperty(t)&&X(e)}),e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),ue(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var he=s.JSON.stringify,de=s.JSON.parse,me=class{stringify(e){return s.JSON.stringify(e,void 0)}parse(e){return s.JSON.parse(e,void 0)}};function fe(){}function pe(e){return e.h||(e.h=e.i())}function ge(){}fe.prototype.h=null;var ye={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ve(){D.call(this,"d")}function we(){D.call(this,"c")}h(ve,D),h(we,D);var be={},xe=null;function _e(){return xe=xe||new ne}function Ie(e){D.call(this,be.La,e)}function ke(e){const t=_e();re(t,new Ie(t))}function Se(e,t){D.call(this,be.STAT_EVENT,e),this.stat=t}function Te(e){const t=_e();re(t,new Se(t,e))}function Ee(e,t){D.call(this,be.Ma,e),this.size=t}function Ne(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return s.setTimeout((function(){e()}),t)}function Ae(){this.g=!0}function Ce(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var a=1;a<s.length;a++)s[a]=""}}}return he(n)}catch(o){return t}}(e,n)+(r?" "+r:"")}))}be.La="serverreachability",h(Ie,D),be.STAT_EVENT="statevent",h(Se,D),be.Ma="timingevent",h(Ee,D),Ae.prototype.xa=function(){this.g=!1},Ae.prototype.info=function(){};var je,Re={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},De={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Pe(){}function Oe(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Me}function Me(){this.i=null,this.g="",this.h=!1}h(Pe,fe),Pe.prototype.g=function(){return new XMLHttpRequest},Pe.prototype.i=function(){return{}},je=new Pe;var Le={},Ue={};function Fe(e,t,n){e.L=1,e.v=ht(at(t)),e.m=n,e.P=!0,Ve(e,null)}function Ve(e,t){e.F=Date.now(),Ge(e),e.A=at(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),St(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Me,e.g=_n(e.j,n?t:null,!e.m),0<e.O&&(e.M=new oe(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var s="readystatechange";Array.isArray(s)||(s&&(ce[0]=s.toString()),s=ce);for(var i=0;i<s.length;i++){var a=K(n,s[i],r||t.handleEvent,!1,t.h||t);if(!a)break;t.g[a.key]=a}t=e.H?w(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),ke(),function(e,t,n,r,s,i){e.info((function(){if(e.g)if(i)for(var a="",o=i.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");a=2<=h.length&&"type"==h[1]?a+(u+"=")+c+"&":a+(u+"=redacted&")}}else a=null;else a=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+t+"\n"+n+"\n"+a}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function Be(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function $e(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Ue:(n=Number(t.substring(n,r)),isNaN(n)?Le:(r+=1)+n>t.length?Ue:(t=t.slice(r,r+n),e.C=r+n,t))}function Ge(e){e.S=Date.now()+e.I,qe(e,e.I)}function qe(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ne(c(e.ba,e),t)}function ze(e){e.B&&(s.clearTimeout(e.B),e.B=null)}function Ke(e){0==e.j.G||e.J||yn(e.j,e)}function He(e){ze(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ue(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function We(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Ze(n.h,e)))if(!e.K&&Ze(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var s=r;if(0==s[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;gn(n),an(n)}mn(n),Te(18)}}else n.za=s[1],0<n.za-n.T&&37500>s[2]&&n.F&&0==n.v&&!n.C&&(n.C=Ne(c(n.Za,n),6e3));if(1>=Ye(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else wn(n,11)}else if((e.K||n.g==e)&&gn(n),!f(t))for(s=n.Da.g.parse(t),t=0;t<s.length;t++){let c=s[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const s=c[4];null!=s&&(n.Aa=s,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var i=r.h;i.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(et(i,i.h),i.h=null))}if(r.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,ut(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var a=e;if((r=n).qa=xn(r,r.J?r.ia:null,r.W),a.K){tt(r.h,a);var o=a,l=r.L;l&&(o.I=l),o.B&&(ze(o),Ge(o)),r.g=a}else dn(r);0<n.i.length&&ln(n)}else"stop"!=c[0]&&"close"!=c[0]||wn(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?wn(n,7):sn(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}ke()}catch(u){}}Oe.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==en(e)?t.j():this.Y(e)},Oe.prototype.Y=function(e){try{if(e==this.g)e:{const d=en(this.g);var t=this.g.Ba();this.g.Z();if(!(3>d)&&(3!=d||this.g&&(this.h.h||this.g.oa()||tn(this.g)))){this.J||4!=d||7==t||ke(),ze(this);var n=this.g.Z();this.X=n;t:if(Be(this)){var r=tn(this.g);e="";var i=r.length,a=4==en(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){He(this),Ke(this);var o="";break t}this.h.i=new s.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(a&&t==i-1)});r.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==n,function(e,t,n,r,s,i,a){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+t+"\n"+n+"\n"+i+" "+a}))}(this.i,this.u,this.A,this.l,this.R,d,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!f(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Te(12),He(this),Ke(this);break e}Ce(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,We(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<o.length;){if(e=$e(this,o),e==Ue){4==d&&(this.s=4,Te(14),n=!1),Ce(this.i,this.l,null,"[Incomplete Response]");break}if(e==Le){this.s=4,Te(15),Ce(this.i,this.l,o,"[Invalid Chunk]"),n=!1;break}Ce(this.i,this.l,e,null),We(this,e)}if(Be(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=d||0!=o.length||this.h.h||(this.s=1,Te(16),n=!1),this.o=this.o&&n,n){if(0<o.length&&!this.W){this.W=!0;var h=this.j;h.g==this&&h.ba&&!h.M&&(h.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),fn(h),h.M=!0,Te(11))}}else Ce(this.i,this.l,o,"[Invalid Chunked Response]"),He(this),Ke(this)}else Ce(this.i,this.l,o,null),We(this,o);4==d&&He(this),this.o&&!this.J&&(4==d?yn(this.j,this):(this.o=!1,Ge(this)))}else(function(e){const t={};e=(e.g&&2<=en(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(f(e[r]))continue;var n=_(e[r]);const s=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const i=t[s]||[];t[s]=i,i.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,Te(12)):(this.s=0,Te(13)),He(this),Ke(this)}}}catch(d){}},Oe.prototype.cancel=function(){this.J=!0,He(this)},Oe.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(ke(),Te(17)),He(this),this.s=2,Ke(this)):qe(this,this.S-e)};var Qe=class{constructor(e,t){this.g=e,this.map=t}};function Xe(e){this.l=e||10,s.PerformanceNavigationTiming?e=0<(e=s.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Je(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Ye(e){return e.h?1:e.g?e.g.size:0}function Ze(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return d(e.i)}function rt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(i(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(i(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(i(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),s=r.length,a=0;a<s;a++)t.call(void 0,r[a],n&&n[a],e)}Xe.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var st=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function it(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof it){this.h=e.h,ot(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,n=new xt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ct(this,n),this.m=e.m}else e&&(t=String(e).match(st))?(this.h=!1,ot(this,t[1]||"",!0),this.o=dt(t[2]||""),this.g=dt(t[3]||"",!0),lt(this,t[4]),this.l=dt(t[5]||"",!0),ct(this,t[6]||"",!0),this.m=dt(t[7]||"")):(this.h=!1,this.i=new xt(null,this.h))}function at(e){return new it(e)}function ot(e,t,n){e.j=n?dt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ct(e,t,n){t instanceof xt?(e.i=t,function(e,t){t&&!e.j&&(_t(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(It(this,t),St(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=mt(t,wt)),e.i=new xt(t,e.h))}function ut(e,t,n){e.i.set(t,n)}function ht(e){return ut(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function dt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function mt(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,ft),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ft(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}it.prototype.toString=function(){var e=[],t=this.j;t&&e.push(mt(t,gt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(mt(t,gt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(mt(n,"/"==n.charAt(0)?vt:yt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",mt(n,bt)),e.join("")};var pt,gt=/[#\/\?@]/g,yt=/[#\?:]/g,vt=/[#\?]/g,wt=/[#\?@]/g,bt=/#/g;function xt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function _t(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),s=null;if(0<=r){var i=e[n].substring(0,r);s=e[n].substring(r+1)}else i=e[n];t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function It(e,t){_t(e),t=Tt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function kt(e,t){return _t(e),t=Tt(e,t),e.g.has(t)}function St(e,t,n){It(e,t),0<n.length&&(e.i=null,e.g.set(Tt(e,t),d(n)),e.h+=n.length)}function Tt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Et(e,t,n,r,s){try{s&&(s.onload=null,s.onerror=null,s.onabort=null,s.ontimeout=null),r(n)}catch(i){}}function Nt(){this.g=new me}function At(e,t,n){const r=n||"";try{rt(e,(function(e,n){let s=e;a(e)&&(s=he(e)),t.push(r+n+"="+encodeURIComponent(s))}))}catch(s){throw t.push(r+"type="+encodeURIComponent("_badmap")),s}}function Ct(e){this.l=e.Ub||null,this.j=e.eb||!1}function Vt(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Bt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function $t(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Gt(e)}function Gt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function qt(e){let t="";return v(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function zt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=qt(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):ut(e,t,n))}function Kt(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=xt.prototype).add=function(e,t){_t(this),this.i=null,e=Tt(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){_t(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},e.na=function(){_t(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const s=e[r];for(let e=0;e<s.length;e++)n.push(t[r])}return n},e.V=function(e){_t(this);let t=[];if("string"==typeof e)kt(this,e)&&(t=t.concat(this.g.get(Tt(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return _t(this),this.i=null,kt(this,e=Tt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const i=encodeURIComponent(String(r)),a=this.V(r);for(r=0;r<a.length;r++){var s=i;""!==a[r]&&(s+="="+encodeURIComponent(String(a[r]))),e.push(s)}}return this.i=e.join("&")},h(Ct,fe),Ct.prototype.g=function(){return new Vt(this.l,this.j)},Ct.prototype.i=(pt={},function(){return pt}),h(Vt,ne),(e=Vt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Gt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||s).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,$t(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Gt(this)),this.g&&(this.readyState=3,Gt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(void 0!==s.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Bt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?$t(this):Gt(this),3==this.readyState&&Bt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,$t(this))},e.Qa=function(e){this.g&&(this.response=e,$t(this))},e.ga=function(){this.g&&$t(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Vt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),h(Kt,ne);var Ht=/^https?$/i,Wt=["POST","PUT"];function Qt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Xt(e),Yt(e)}function Xt(e){e.A||(e.A=!0,re(e,"complete"),re(e,"error"))}function Jt(e){if(e.h&&void 0!==r&&(!e.v[1]||4!=en(e)||2!=e.Z()))if(e.u&&4==en(e))ie(e.Ea,0,e);else if(re(e,"readystatechange"),4==en(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var i;if(i=0===r){var a=String(e.D).match(st)[1]||null;!a&&s.self&&s.self.location&&(a=s.self.location.protocol.slice(0,-1)),i=!Ht.test(a?a.toLowerCase():"")}n=i}if(n)re(e,"complete"),re(e,"success");else{e.m=6;try{var o=2<en(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",Xt(e)}}finally{Yt(e)}}}function Yt(e,t){if(e.g){Zt(e);const r=e.g,s=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||re(e,"ready");try{r.onreadystatechange=s}catch(n){}}}function Zt(e){e.I&&(s.clearTimeout(e.I),e.I=null)}function en(e){return e.g?e.g.readyState:0}function tn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function nn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function rn(e){this.Aa=0,this.i=[],this.j=new Ae,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=nn("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=nn("baseRetryDelayMs",5e3,e),this.cb=nn("retryDelaySeedMs",1e4,e),this.Wa=nn("forwardChannelMaxRetries",2,e),this.wa=nn("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Xe(e&&e.concurrentRequestLimit),this.Da=new Nt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function sn(e){if(on(e),3==e.G){var t=e.U++,n=at(e.I);if(ut(n,"SID",e.K),ut(n,"RID",t),ut(n,"TYPE","terminate"),un(e,n),(t=new Oe(e,e.j,t)).L=2,t.v=ht(at(n)),n=!1,s.navigator&&s.navigator.sendBeacon)try{n=s.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&s.Image&&((new Image).src=t.v,n=!0),n||(t.g=_n(t.j,null),t.g.ea(t.v)),t.F=Date.now(),Ge(t)}bn(e)}function an(e){e.g&&(fn(e),e.g.cancel(),e.g=null)}function on(e){an(e),e.u&&(s.clearTimeout(e.u),e.u=null),gn(e),e.h.cancel(),e.s&&("number"==typeof e.s&&s.clearTimeout(e.s),e.s=null)}function ln(e){if(!Je(e.h)&&!e.s){e.s=!0;var t=e.Ga;E||C(),N||(E(),N=!0),A.add(t,e),e.B=0}}function cn(e,t){var n;n=t?t.l:e.U++;const r=at(e.I);ut(r,"SID",e.K),ut(r,"RID",n),ut(r,"AID",e.T),un(e,r),e.m&&e.o&&zt(r,e.m,e.o),n=new Oe(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=hn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),Fe(n,r,t)}function un(e,t){e.H&&v(e.H,(function(e,n){ut(t,n,e)})),e.l&&rt({},(function(e,n){ut(t,n,e)}))}function hn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?c(e.l.Na,e.l,e):null;e:{var s=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=s[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let a=!0;for(let o=0;o<n;o++){let n=s[o].g;const l=s[o].map;if(n-=t,0>n)t=Math.max(0,s[o].g-100),a=!1;else try{At(l,e,"req"+n+"_")}catch(i){r&&r(l)}}if(a){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function dn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;E||C(),N||(E(),N=!0),A.add(t,e),e.v=0}}function mn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Ne(c(e.Fa,e),vn(e,e.v)),e.v++,!0)}function fn(e){null!=e.A&&(s.clearTimeout(e.A),e.A=null)}function pn(e){e.g=new Oe(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=at(e.qa);ut(t,"RID","rpc"),ut(t,"SID",e.K),ut(t,"AID",e.T),ut(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ut(t,"TO",e.ja),ut(t,"TYPE","xmlhttp"),un(e,t),e.m&&e.o&&zt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=ht(at(t)),n.m=null,n.P=!0,Ve(n,e)}function gn(e){null!=e.C&&(s.clearTimeout(e.C),e.C=null)}function yn(e,t){var n=null;if(e.g==t){gn(e),fn(e),e.g=null;var r=2}else{if(!Ze(e.h,t))return;n=t.D,tt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var s=e.B;re(r=_e(),new Ee(r,n)),ln(e)}else dn(e);else if(3==(s=t.s)||0==s&&0<t.X||!(1==r&&function(e,t){return!(Ye(e.h)>=e.h.j-(e.s?1:0)||(e.s?(e.i=t.D.concat(e.i),0):1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa)||(e.s=Ne(c(e.Ga,e,t),vn(e,e.B)),e.B++,0)))}(e,t)||2==r&&mn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),s){case 1:wn(e,5);break;case 4:wn(e,10);break;case 3:wn(e,6);break;default:wn(e,2)}}function vn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function wn(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),r=e.Xa;const t=!r;r=new it(r||"//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||ot(r,"https"),ht(r),t?function(e,t){const n=new Ae;if(s.Image){const r=new Image;r.onload=u(Et,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(Et,n,"TestLoadImage: error",!1,t,r),r.onabort=u(Et,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(Et,n,"TestLoadImage: timeout",!1,t,r),s.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ae;const n=new AbortController,r=setTimeout((()=>{n.abort(),Et(0,0,!1,t)}),1e4);fetch(e,{signal:n.signal}).then((e=>{clearTimeout(r),e.ok?Et(0,0,!0,t):Et(0,0,!1,t)})).catch((()=>{clearTimeout(r),Et(0,0,!1,t)}))}(r.toString(),n)}else Te(2);e.G=0,e.l&&e.l.sa(t),bn(e),on(e)}function bn(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(m(e.ka,t),m(e.ka,e.i),e.h.i.length=0,d(e.i),e.i.length=0),e.l.ra()}}function xn(e,t,n){var r=n instanceof it?at(n):new it(n);if(""!=r.g)t&&(r.g=t+"."+r.g),lt(r,r.s);else{var i=s.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var a=new it(null);r&&ot(a,r),t&&(a.g=t),i&&lt(a,i),n&&(a.l=n),r=a}return n=e.D,t=e.ya,n&&t&&ut(r,n,t),ut(r,"VER",e.la),un(e,r),r}function _n(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Kt(new Ct({eb:n})):new Kt(e.pa)).Ha(e.J),t}function In(){}function kn(){}function Sn(e,t){ne.call(this),this.g=new rn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!f(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!f(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Nn(this)}function Tn(e){ve.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function En(){we.call(this),this.status=1}function Nn(e){this.g=e}(e=Kt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():je.g(),this.v=this.o?pe(this.o):pe(je),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(a){return void Qt(this,a)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),i=s.FormData&&e instanceof s.FormData,!(0<=Array.prototype.indexOf.call(Wt,t,void 0))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Zt(this),this.u=!0,this.g.send(e),this.u=!1}catch(a){Qt(this,a)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,re(this,"complete"),re(this,"abort"),Yt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Yt(this,!0)),Kt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Jt(this):this.bb())},e.bb=function(){Jt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<en(this)?this.g.status:-1}catch(pt){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(pt){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),de(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"==typeof this.l?this.l:String(this.l)},(e=rn.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Te(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=xn(this,null,this.W),ln(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const s=new Oe(this,this.j,e);let i=this.o;if(this.S&&(i?(i=w(i),x(i,this.S)):i=this.S),null!==this.m||this.O||(s.H=i,i=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=hn(this,s,t),ut(n=at(this.I),"RID",e),ut(n,"CVER",22),this.D&&ut(n,"X-HTTP-Session-Id",this.D),un(this,n),i&&(this.O?t="headers="+encodeURIComponent(String(qt(i)))+"&"+t:this.m&&zt(n,this.m,i)),et(this.h,s),this.Ua&&ut(n,"TYPE","init"),this.P?(ut(n,"$req",t),ut(n,"SID","null"),s.T=!0,Fe(s,n,null)):Fe(s,n,t),this.G=2}}else 3==this.G&&(e?cn(this,e):0==this.i.length||Je(this.h)||cn(this))},e.Fa=function(){if(this.u=null,pn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Ne(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Te(10),an(this),pn(this))},e.Za=function(){null!=this.C&&(this.C=null,an(this),mn(this),Te(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Te(2)):(this.j.info("Failed to ping google.com"),Te(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=In.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},kn.prototype.g=function(e,t){return new Sn(e,t)},h(Sn,ne),Sn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Sn.prototype.close=function(){sn(this.g)},Sn.prototype.o=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=he(e),e=n);t.i.push(new Qe(t.Ya++,e)),3==t.G&&ln(t)},Sn.prototype.N=function(){this.g.l=null,delete this.j,sn(this.g),delete this.g,Sn.aa.N.call(this)},h(Tn,ve),h(En,we),h(Nn,In),Nn.prototype.ua=function(){re(this.g,"a")},Nn.prototype.ta=function(e){re(this.g,new Tn(e))},Nn.prototype.sa=function(e){re(this.g,new En)},Nn.prototype.ra=function(){re(this.g,"b")},kn.prototype.createWebChannel=kn.prototype.g,Sn.prototype.send=Sn.prototype.o,Sn.prototype.open=Sn.prototype.m,Sn.prototype.close=Sn.prototype.close,Ut=function(){return new kn},Lt=function(){return _e()},Mt=be,Ot={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Re.NO_ERROR=0,Re.TIMEOUT=8,Re.HTTP_ERROR=6,Pt=Re,De.COMPLETE="complete",Dt=De,ge.EventType=ye,ye.OPEN="a",ye.CLOSE="b",ye.ERROR="c",ye.MESSAGE="d",ne.prototype.listen=ne.prototype.K,Rt=ge,Kt.prototype.listenOnce=Kt.prototype.L,Kt.prototype.getLastError=Kt.prototype.Ka,Kt.prototype.getLastErrorCode=Kt.prototype.Ba,Kt.prototype.getStatus=Kt.prototype.Z,Kt.prototype.getResponseJson=Kt.prototype.Oa,Kt.prototype.getResponseText=Kt.prototype.oa,Kt.prototype.send=Kt.prototype.ea,Kt.prototype.setWithCredentials=Kt.prototype.Ha,jt=Kt}).apply(void 0!==Ft?Ft:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});const Vt="@firebase/firestore";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Bt.UNAUTHENTICATED=new Bt(null),Bt.GOOGLE_CREDENTIALS=new Bt("google-credentials-uid"),Bt.FIRST_PARTY=new Bt("first-party-uid"),Bt.MOCK_USER=new Bt("mock-user");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
let $t="10.14.0";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gt=new ue("@firebase/firestore");function qt(){return Gt.logLevel}function zt(e,...t){if(Gt.logLevel<=se.DEBUG){const n=t.map(Wt);Gt.debug(`Firestore (${$t}): ${e}`,...n)}}function Kt(e,...t){if(Gt.logLevel<=se.ERROR){const n=t.map(Wt);Gt.error(`Firestore (${$t}): ${e}`,...n)}}function Ht(e,...t){if(Gt.logLevel<=se.WARN){const n=t.map(Wt);Gt.warn(`Firestore (${$t}): ${e}`,...n)}}function Wt(e){if("string"==typeof e)return e;try{
/**
    * @license
    * Copyright 2020 Google LLC
    *
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    *   http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    */
return t=e,JSON.stringify(t)}catch(n){return e}var t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qt(e="Unexpected state"){const t=`FIRESTORE (${$t}) INTERNAL ASSERTION FAILED: `+e;throw Kt(t),new Error(t)}function Xt(e,t){e||Qt()}function Jt(e,t){return e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Zt extends z{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class nn{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Bt.UNAUTHENTICATED)))}shutdown(){}}class rn{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class sn{constructor(e){this.t=e,this.currentUser=Bt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Xt(void 0===this.o);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let s=new en;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new en,e.enqueueRetryable((()=>r(this.currentUser)))};const i=()=>{const t=s;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},a=e=>{zt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit((e=>a(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?a(e):(zt("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new en)}}),0),i()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(zt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Xt("string"==typeof t.accessToken),new tn(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Xt(null===e||"string"==typeof e),new Bt(e)}}class an{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=Bt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class on{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new an(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(Bt.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class ln{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class cn{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Xt(void 0===this.o);const n=e=>{null!=e.error&&zt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,zt("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{zt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):zt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Xt("string"==typeof e.token),this.R=e.token,new ln(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function un(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=un(40);for(let s=0;s<r.length;++s)n.length<20&&r[s]<t&&(n+=e.charAt(r[s]%62))}return n}}function dn(e,t){return e<t?-1:e>t?1:0}function mn(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}function fn(e){return e+"\0"}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Zt(Yt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Zt(Yt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Zt(Yt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Zt(Yt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return pn.fromMillis(Date.now())}static fromDate(e){return pn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new pn(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?dn(this.nanoseconds,e.nanoseconds):dn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e){this.timestamp=e}static fromTimestamp(e){return new gn(e)}static min(){return new gn(new pn(0,0))}static max(){return new gn(new pn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e,t,n){void 0===t?t=0:t>e.length&&Qt(),void 0===n?n=e.length-t:n>e.length-t&&Qt(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===yn.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof yn?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),s=t.get(r);if(n<s)return-1;if(n>s)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class vn extends yn{construct(e,t,n){return new vn(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Zt(Yt.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new vn(t)}static emptyPath(){return new vn([])}}const wn=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bn extends yn{construct(e,t,n){return new bn(e,t,n)}static isValidIdentifier(e){return wn.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new bn(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const s=()=>{if(0===n.length)throw new Zt(Yt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let i=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Zt(Yt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Zt(Yt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(i=!i,r++):"."!==t||i?(n+=t,r++):(s(),r++)}if(s(),i)throw new Zt(Yt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new bn(t)}static emptyPath(){return new bn([])}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e){this.path=e}static fromPath(e){return new xn(vn.fromString(e))}static fromName(e){return new xn(vn.fromString(e).popFirst(5))}static empty(){return new xn(vn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===vn.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return vn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new xn(new vn(e.slice()))}}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function In(e){return e.fields.find((e=>2===e.kind))}function kn(e){return e.fields.filter((e=>2!==e.kind))}_n.UNKNOWN_ID=-1;class Sn{constructor(e,t){this.fieldPath=e,this.kind=t}}class Tn{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Tn(0,An.min())}}function En(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,s=gn.fromTimestamp(1e9===r?new pn(n+1,0):new pn(n,r));return new An(s,xn.empty(),t)}function Nn(e){return new An(e.readTime,e.key,-1)}class An{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new An(gn.min(),xn.empty(),-1)}static max(){return new An(gn.max(),xn.empty(),-1)}}function Cn(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=xn.comparator(e.documentKey,t.documentKey),0!==n?n:dn(e.largestBatchId,t.largestBatchId)
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */)}const jn="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Rn{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dn(e){if(e.code!==Yt.FAILED_PRECONDITION||e.message!==jn)throw e;zt("LocalStore","Unexpectedly lost primary lease")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Qt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Pn(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Pn?t:Pn.resolve(t)}catch(t){return Pn.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Pn.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Pn.reject(t)}static resolve(e){return new Pn(((t,n)=>{t(e)}))}static reject(e){return new Pn(((t,n)=>{n(e)}))}static waitFor(e){return new Pn(((t,n)=>{let r=0,s=0,i=!1;e.forEach((e=>{++r,e.next((()=>{++s,i&&s===r&&t()}),(e=>n(e)))})),i=!0,s===r&&t()}))}static or(e){let t=Pn.resolve(!1);for(const n of e)t=t.next((e=>e?Pn.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new Pn(((n,r)=>{const s=e.length,i=new Array(s);let a=0;for(let o=0;o<s;o++){const l=o;t(e[l]).next((e=>{i[l]=e,++a,a===s&&n(i)}),(e=>r(e)))}}))}static doWhile(e,t){return new Pn(((n,r)=>{const s=()=>{!0===e()?t().next((()=>{s()}),r):n()};s()}))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new en,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Fn(e,t.error)):this.V.resolve()},this.transaction.onerror=t=>{const n=qn(t.target.error);this.V.reject(new Fn(e,n))}}static open(e,t,n,r){try{return new On(t,e.transaction(r,n))}catch(s){throw new Fn(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(zt("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Bn(t)}}class Mn{constructor(e,t,n){this.name=e,this.version=t,this.p=n,12.2===Mn.S($())&&Kt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return zt("SimpleDb","Removing database:",e),$n(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!q())return!1;if(Mn.v())return!0;const e=$(),t=Mn.S(e),n=0<t&&t<10,r=Ln(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static v(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.C)}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}async M(e){return this.db||(zt("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new Fn(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new Zt(Yt.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new Zt(Yt.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new Fn(e,r))},r.onupgradeneeded=e=>{zt("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.p.O(t,r.transaction,e.oldVersion,this.version).next((()=>{zt("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.N&&(this.db.onversionchange=e=>this.N(e)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const s="readonly"===t;let i=0;for(;;){++i;try{this.db=await this.M(e);const t=On.open(this.db,e,s?"readonly":"readwrite",n),i=r(t).next((e=>(t.g(),e))).catch((e=>(t.abort(e),Pn.reject(e)))).toPromise();return i.catch((()=>{})),await t.m,i}catch(a){const e=a,t="FirebaseError"!==e.name&&i<3;if(zt("SimpleDb","Transaction failed with error:",e.message,"Retrying:",t),this.close(),!t)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Ln(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class Un{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return $n(this.B.delete())}}class Fn extends Zt{constructor(e,t){super(Yt.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Vn(e){return"IndexedDbTransactionError"===e.name}class Bn{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(zt("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(zt("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),$n(n)}add(e){return zt("SimpleDb","ADD",this.store.name,e,e),$n(this.store.add(e))}get(e){return $n(this.store.get(e)).next((t=>(void 0===t&&(t=null),zt("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return zt("SimpleDb","DELETE",this.store.name,e),$n(this.store.delete(e))}count(){return zt("SimpleDb","COUNT",this.store.name),$n(this.store.count())}U(e,t){const n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const e=r.getAll(n.range);return new Pn(((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}}))}{const e=this.cursor(n),t=[];return this.W(e,((e,n)=>{t.push(n)})).next((()=>t))}}G(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new Pn(((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}}))}j(e,t){zt("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.H=!1;const r=this.cursor(n);return this.W(r,((e,t,n)=>n.delete()))}J(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.W(r,t)}Y(e){const t=this.cursor({});return new Pn(((n,r)=>{t.onerror=e=>{const t=qn(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next((e=>{e?r.continue():n()})):n()}}))}W(e,t){const n=[];return new Pn(((r,s)=>{e.onerror=e=>{s(e.target.error)},e.onsuccess=e=>{const s=e.target.result;if(!s)return void r();const i=new Un(s),a=t(s.primaryKey,s.value,i);if(a instanceof Pn){const e=a.catch((e=>(i.done(),Pn.reject(e))));n.push(e)}i.isDone?r():null===i.K?s.continue():s.continue(i.K)}})).next((()=>Pn.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function $n(e){return new Pn(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=qn(e.target.error);n(t)}}))}let Gn=!1;function qn(e){const t=Mn.S($());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new Zt("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Gn||(Gn=!0,setTimeout((()=>{throw e}),0)),e}}return e}class zn{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}X(e){zt("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{zt("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(e){Vn(e)?zt("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",e):await Dn(e)}await this.X(6e4)}))}}class Kn{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.te(t,e)))}te(e,t){const n=new Set;let r=t,s=!0;return Pn.doWhile((()=>!0===s&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((t=>{if(null!==t&&!n.has(t))return zt("IndexBackfiller",`Processing collection: ${t}`),this.ne(e,t,r).next((e=>{r-=e,n.add(t)}));s=!1})))).next((()=>t-r))}ne(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next((n=>{const s=n.changes;return this.localStore.indexManager.updateIndexEntries(e,s).next((()=>this.re(r,n))).next((n=>(zt("IndexBackfiller",`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n)))).next((()=>s.size))}))))}re(e,t){let n=e;return t.changes.forEach(((e,t)=>{const r=Nn(t);Cn(r,n)>0&&(n=r)})),new An(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function Wn(e){return null==e}function Qn(e){return 0===e&&1/e==-1/0}function Xn(e){return"number"==typeof e&&Number.isInteger(e)&&!Qn(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jn(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Zn(t)),t=Yn(e.get(n),t);return Zn(t)}function Yn(e,t){let n=t;const r=e.length;for(let s=0;s<r;s++){const t=e.charAt(s);switch(t){case"\0":n+="";break;case"":n+="";break;default:n+=t}}return n}function Zn(e){return e+""}function er(e){const t=e.length;if(Xt(t>=2),2===t)return Xt(""===e.charAt(0)&&""===e.charAt(1)),vn.emptyPath();const n=t-2,r=[];let s="";for(let i=0;i<t;){const t=e.indexOf("",i);switch((t<0||t>n)&&Qt(),e.charAt(t+1)){case"":const n=e.substring(i,t);let a;0===s.length?a=n:(s+=n,a=s,s=""),r.push(a);break;case"":s+=e.substring(i,t),s+="\0";break;case"":s+=e.substring(i,t+1);break;default:Qt()}i=t+2}return new vn(r)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Hn.oe=-1;const tr=["userId","batchId"];
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nr(e,t){return[e,Jn(t)]}function rr(e,t,n){return[e,Jn(t),n]}const sr={},ir=["prefixPath","collectionGroup","readTime","documentId"],ar=["prefixPath","collectionGroup","documentId"],or=["collectionGroup","readTime","prefixPath","documentId"],lr=["canonicalId","targetId"],cr=["targetId","path"],ur=["path","targetId"],hr=["collectionId","parent"],dr=["indexId","uid"],mr=["uid","sequenceNumber"],fr=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],pr=["indexId","uid","orderedDocumentKey"],gr=["userId","collectionPath","documentId"],yr=["userId","collectionPath","largestBatchId"],vr=["userId","collectionGroup","largestBatchId"],wr=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],br=[...wr,"documentOverlays"],xr=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],_r=xr,Ir=[..._r,"indexConfiguration","indexState","indexEntries"],kr=Ir,Sr=[...Ir,"globals"];
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr extends Rn{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function Er(e,t){const n=Jt(e);return Mn.F(n._e,t)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nr(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Ar(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Cr(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(e,t){this.comparator=e,this.root=t||Dr.EMPTY}insert(e,t){return new jr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Dr.BLACK,null,null))}remove(e){return new jr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Dr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Rr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Rr(this.root,e,this.comparator,!1)}getReverseIterator(){return new Rr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Rr(this.root,e,this.comparator,!0)}}class Rr{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Dr{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=null!=n?n:Dr.RED,this.left=null!=r?r:Dr.EMPTY,this.right=null!=s?s:Dr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,s){return new Dr(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Dr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Dr.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Dr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Dr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Qt();if(this.right.isRed())throw Qt();const e=this.left.check();if(e!==this.right.check())throw Qt();return e+(this.isRed()?0:1)}}Dr.EMPTY=null,Dr.RED=!0,Dr.BLACK=!1,Dr.EMPTY=new class{constructor(){this.size=0}get key(){throw Qt()}get value(){throw Qt()}get color(){throw Qt()}get left(){throw Qt()}get right(){throw Qt()}copy(e,t,n,r,s){return this}insert(e,t,n){return new Dr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Pr{constructor(e){this.comparator=e,this.data=new jr(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Or(this.data.getIterator())}getIteratorFrom(e){return new Or(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof Pr))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Pr(this.comparator);return t.data=e,t}}class Or{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Mr(e){return e.hasNext()?e.getNext():void 0}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e){this.fields=e,e.sort(bn.comparator)}static empty(){return new Lr([])}unionWith(e){let t=new Pr(bn.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Lr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return mn(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new Ur("Invalid base64 string: "+t):t}}(e);return new Fr(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Fr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return dn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Fr.EMPTY_BYTE_STRING=new Fr("");const Vr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Br(e){if(Xt(!!e),"string"==typeof e){let t=0;const n=Vr.exec(e);if(Xt(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:$r(e.seconds),nanos:$r(e.nanos)}}function $r(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Gr(e){return"string"==typeof e?Fr.fromBase64String(e):Fr.fromUint8Array(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qr(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function zr(e){const t=e.mapValue.fields.__previous_value__;return qr(t)?zr(t):t}function Kr(e){const t=Br(e.mapValue.fields.__local_write_time__.timestampValue);return new pn(t.seconds,t.nanos)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr{constructor(e,t,n,r,s,i,a,o,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=i,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l}}class Wr{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Wr("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Wr&&e.projectId===this.projectId&&e.database===this.database}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Xr={nullValue:"NULL_VALUE"};function Jr(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?qr(e)?4:ms(e)?9007199254740991:hs(e)?10:11:Qt()}function Yr(e,t){if(e===t)return!0;const n=Jr(e);if(n!==Jr(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Kr(e).isEqual(Kr(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Br(e.timestampValue),r=Br(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return r=t,Gr(e.bytesValue).isEqual(Gr(r.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return $r(e.geoPointValue.latitude)===$r(t.geoPointValue.latitude)&&$r(e.geoPointValue.longitude)===$r(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return $r(e.integerValue)===$r(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=$r(e.doubleValue),r=$r(t.doubleValue);return n===r?Qn(n)===Qn(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return mn(e.arrayValue.values||[],t.arrayValue.values||[],Yr);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Nr(n)!==Nr(r))return!1;for(const s in n)if(n.hasOwnProperty(s)&&(void 0===r[s]||!Yr(n[s],r[s])))return!1;return!0}(e,t);default:return Qt()}var r}function Zr(e,t){return void 0!==(e.values||[]).find((e=>Yr(e,t)))}function es(e,t){if(e===t)return 0;const n=Jr(e),r=Jr(t);if(n!==r)return dn(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return dn(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=$r(e.integerValue||e.doubleValue),r=$r(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return ts(e.timestampValue,t.timestampValue);case 4:return ts(Kr(e),Kr(t));case 5:return dn(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Gr(e),r=Gr(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let s=0;s<n.length&&s<r.length;s++){const e=dn(n[s],r[s]);if(0!==e)return e}return dn(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=dn($r(e.latitude),$r(t.latitude));return 0!==n?n:dn($r(e.longitude),$r(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return ns(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,s,i;const a=e.fields||{},o=t.fields||{},l=null===(n=a.value)||void 0===n?void 0:n.arrayValue,c=null===(r=o.value)||void 0===r?void 0:r.arrayValue,u=dn((null===(s=null==l?void 0:l.values)||void 0===s?void 0:s.length)||0,(null===(i=null==c?void 0:c.values)||void 0===i?void 0:i.length)||0);return 0!==u?u:ns(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Qr.mapValue&&t===Qr.mapValue)return 0;if(e===Qr.mapValue)return 1;if(t===Qr.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),s=t.fields||{},i=Object.keys(s);r.sort(),i.sort();for(let a=0;a<r.length&&a<i.length;++a){const e=dn(r[a],i[a]);if(0!==e)return e;const t=es(n[r[a]],s[i[a]]);if(0!==t)return t}return dn(r.length,i.length)}(e.mapValue,t.mapValue);default:throw Qt()}}function ts(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return dn(e,t);const n=Br(e),r=Br(t),s=dn(n.seconds,r.seconds);return 0!==s?s:dn(n.nanos,r.nanos)}function ns(e,t){const n=e.values||[],r=t.values||[];for(let s=0;s<n.length&&s<r.length;++s){const e=es(n[s],r[s]);if(e)return e}return dn(n.length,r.length)}function rs(e){return ss(e)}function ss(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Br(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Gr(e.bytesValue).toBase64():"referenceValue"in e?function(e){return xn.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=ss(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const s of t)r?r=!1:n+=",",n+=`${s}:${ss(e.fields[s])}`;return n+"}"}(e.mapValue):Qt()}function is(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function as(e){return!!e&&"integerValue"in e}function os(e){return!!e&&"arrayValue"in e}function ls(e){return!!e&&"nullValue"in e}function cs(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function us(e){return!!e&&"mapValue"in e}function hs(e){var t,n;return"__vector__"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ds(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Ar(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=ds(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=ds(e.arrayValue.values[n]);return t}return Object.assign({},e)}function ms(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}const fs={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function ps(e){return"nullValue"in e?Xr:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?is(Wr.empty(),xn.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?hs(e)?fs:{mapValue:{}}:Qt()}function gs(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?is(Wr.empty(),xn.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?fs:"mapValue"in e?hs(e)?{mapValue:{}}:Qr:Qt()}function ys(e,t){const n=es(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function vs(e,t){const n=es(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e){this.value=e}static empty(){return new ws({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!us(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ds(t)}setAll(e){let t=bn.emptyPath(),n={},r=[];e.forEach(((e,s)=>{if(!t.isImmediateParentOf(s)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=s.popLast()}e?n[s.lastSegment()]=ds(e):r.push(s.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,n,r)}delete(e){const t=this.field(e.popLast());us(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Yr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];us(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Ar(t,((t,n)=>e[t]=n));for(const r of n)delete e[r]}clone(){return new ws(ds(this.value))}}function bs(e){const t=[];return Ar(e.fields,((e,n)=>{const r=new bn([e]);if(us(n)){const e=bs(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new Lr(t)
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class xs{constructor(e,t,n,r,s,i,a){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=s,this.data=i,this.documentState=a}static newInvalidDocument(e){return new xs(e,0,gn.min(),gn.min(),gn.min(),ws.empty(),0)}static newFoundDocument(e,t,n,r){return new xs(e,1,t,gn.min(),n,r,0)}static newNoDocument(e,t){return new xs(e,2,t,gn.min(),gn.min(),ws.empty(),0)}static newUnknownDocument(e,t){return new xs(e,3,t,gn.min(),gn.min(),ws.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(gn.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ws.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ws.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=gn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof xs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new xs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e,t){this.position=e,this.inclusive=t}}function Is(e,t,n){let r=0;for(let s=0;s<e.position.length;s++){const i=t[s],a=e.position[s];if(r=i.field.isKeyField()?xn.comparator(xn.fromName(a.referenceValue),n.key):es(a,n.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function ks(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Yr(e.position[n],t.position[n]))return!1;return!0}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e,t="asc"){this.field=e,this.dir=t}}function Ts(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{}class Ns extends Es{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Us(e,t,n):"array-contains"===t?new $s(e,n):"in"===t?new Gs(e,n):"not-in"===t?new qs(e,n):"array-contains-any"===t?new zs(e,n):new Ns(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Fs(e,n):new Vs(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(es(t,this.value)):null!==t&&Jr(this.value)===Jr(t)&&this.matchesComparison(es(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Qt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class As extends Es{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new As(e,t)}matches(e){return Cs(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Cs(e){return"and"===e.op}function js(e){return"or"===e.op}function Rs(e){return Ds(e)&&Cs(e)}function Ds(e){for(const t of e.filters)if(t instanceof As)return!1;return!0}function Ps(e){if(e instanceof Ns)return e.field.canonicalString()+e.op.toString()+rs(e.value);if(Rs(e))return e.filters.map((e=>Ps(e))).join(",");{const t=e.filters.map((e=>Ps(e))).join(",");return`${e.op}(${t})`}}function Os(e,t){return e instanceof Ns?(n=e,(r=t)instanceof Ns&&n.op===r.op&&n.field.isEqual(r.field)&&Yr(n.value,r.value)):e instanceof As?function(e,t){return t instanceof As&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&Os(n,t.filters[r])),!0)}(e,t):void Qt();var n,r}function Ms(e,t){const n=e.filters.concat(t);return As.create(n,e.op)}function Ls(e){return e instanceof Ns?`${(t=e).field.canonicalString()} ${t.op} ${rs(t.value)}`:e instanceof As?function(e){return e.op.toString()+" {"+e.getFilters().map(Ls).join(" ,")+"}"}(e):"Filter";var t}class Us extends Ns{constructor(e,t,n){super(e,t,n),this.key=xn.fromName(n.referenceValue)}matches(e){const t=xn.comparator(e.key,this.key);return this.matchesComparison(t)}}class Fs extends Ns{constructor(e,t){super(e,"in",t),this.keys=Bs("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Vs extends Ns{constructor(e,t){super(e,"not-in",t),this.keys=Bs("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Bs(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>xn.fromName(e.referenceValue)))}class $s extends Ns{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return os(t)&&Zr(t.arrayValue,this.value)}}class Gs extends Ns{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Zr(this.value.arrayValue,t)}}class qs extends Ns{constructor(e,t){super(e,"not-in",t)}matches(e){if(Zr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Zr(this.value.arrayValue,t)}}class zs extends Ns{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!os(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Zr(this.value.arrayValue,e)))}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(e,t=null,n=[],r=[],s=null,i=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=i,this.endAt=a,this.ue=null}}function Hs(e,t=null,n=[],r=[],s=null,i=null,a=null){return new Ks(e,t,n,r,s,i,a)}function Ws(e){const t=Jt(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>Ps(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>{return(t=e).field.canonicalString()+t.dir;var t})).join(","),Wn(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>rs(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>rs(e))).join(",")),t.ue=e}return t.ue}function Qs(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Ts(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Os(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!ks(e.startAt,t.startAt)&&ks(e.endAt,t.endAt)}function Xs(e){return xn.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Js(e,t){return e.filters.filter((e=>e instanceof Ns&&e.field.isEqual(t)))}function Ys(e,t,n){let r=Xr,s=!0;for(const i of Js(e,t)){let e=Xr,t=!0;switch(i.op){case"<":case"<=":e=ps(i.value);break;case"==":case"in":case">=":e=i.value;break;case">":e=i.value,t=!1;break;case"!=":case"not-in":e=Xr}ys({value:r,inclusive:s},{value:e,inclusive:t})<0&&(r=e,s=t)}if(null!==n)for(let i=0;i<e.orderBy.length;++i)if(e.orderBy[i].field.isEqual(t)){const e=n.position[i];ys({value:r,inclusive:s},{value:e,inclusive:n.inclusive})<0&&(r=e,s=n.inclusive);break}return{value:r,inclusive:s}}function Zs(e,t,n){let r=Qr,s=!0;for(const i of Js(e,t)){let e=Qr,t=!0;switch(i.op){case">=":case">":e=gs(i.value),t=!1;break;case"==":case"in":case"<=":e=i.value;break;case"<":e=i.value,t=!1;break;case"!=":case"not-in":e=Qr}vs({value:r,inclusive:s},{value:e,inclusive:t})>0&&(r=e,s=t)}if(null!==n)for(let i=0;i<e.orderBy.length;++i)if(e.orderBy[i].field.isEqual(t)){const e=n.position[i];vs({value:r,inclusive:s},{value:e,inclusive:n.inclusive})>0&&(r=e,s=n.inclusive);break}return{value:r,inclusive:s}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e,t=null,n=[],r=[],s=null,i="F",a=null,o=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=i,this.startAt=a,this.endAt=o,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function ti(e,t,n,r,s,i,a,o){return new ei(e,t,n,r,s,i,a,o)}function ni(e){return new ei(e)}function ri(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function si(e){return null!==e.collectionGroup}function ii(e){const t=Jt(e);if(null===t.ce){t.ce=[];const e=new Set;for(const r of t.explicitOrderBy)t.ce.push(r),e.add(r.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(e){let t=new Pr(bn.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t})(t).forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.ce.push(new Ss(r,n))})),e.has(bn.keyField().canonicalString())||t.ce.push(new Ss(bn.keyField(),n))}return t.ce}function ai(e){const t=Jt(e);return t.le||(t.le=function(e,t){if("F"===e.limitType)return Hs(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new Ss(e.field,t)}));const n=e.endAt?new _s(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new _s(e.startAt.position,e.startAt.inclusive):null;return Hs(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}(t,ii(e))),t.le}function oi(e,t){const n=e.filters.concat([t]);return new ei(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function li(e,t,n){return new ei(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function ci(e,t){return Qs(ai(e),ai(t))&&e.limitType===t.limitType}function ui(e){return`${Ws(ai(e))}|lt:${e.limitType}`}function hi(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>Ls(e))).join(", ")}]`),Wn(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>{return`${(t=e).field.canonicalString()} (${t.dir})`;var t})).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>rs(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>rs(e))).join(",")),`Target(${t})`}(ai(e))}; limitType=${e.limitType})`}function di(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):xn.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of ii(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&(r=t,!((n=e).startAt&&!function(e,t,n){const r=Is(e,t,n);return e.inclusive?r<=0:r<0}(n.startAt,ii(n),r)||n.endAt&&!function(e,t,n){const r=Is(e,t,n);return e.inclusive?r>=0:r>0}(n.endAt,ii(n),r)));var n,r}function mi(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function fi(e){return(t,n)=>{let r=!1;for(const s of ii(e)){const e=pi(s,t,n);if(0!==e)return e;r=r||s.field.isKeyField()}return 0}}function pi(e,t,n){const r=e.field.isKeyField()?xn.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),s=n.data.field(e);return null!==r&&null!==s?es(r,s):Qt()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Qt()}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,s]of n)if(this.equalsFn(r,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ar(this.inner,((t,n)=>{for(const[r,s]of n)e(r,s)}))}isEmpty(){return Cr(this.inner)}size(){return this.innerSize}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yi=new jr(xn.comparator);function vi(){return yi}const wi=new jr(xn.comparator);function bi(...e){let t=wi;for(const n of e)t=t.insert(n.key,n);return t}function xi(e){let t=wi;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function _i(){return ki()}function Ii(){return ki()}function ki(){return new gi((e=>e.toString()),((e,t)=>e.isEqual(t)))}const Si=new jr(xn.comparator),Ti=new Pr(xn.comparator);function Ei(...e){let t=Ti;for(const n of e)t=t.add(n);return t}const Ni=new Pr(dn);function Ai(){return Ni}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ci(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qn(t)?"-0":t}}function ji(e){return{integerValue:""+e}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ri{constructor(){this._=void 0}}function Di(e,t,n){return e instanceof Mi?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&qr(t)&&(t=zr(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Li?Ui(e,t):e instanceof Fi?Vi(e,t):function(e,t){const n=Oi(e,t),r=$i(n)+$i(e.Pe);return as(n)&&as(e.Pe)?ji(r):Ci(e.serializer,r)}(e,t)}function Pi(e,t,n){return e instanceof Li?Ui(e,t):e instanceof Fi?Vi(e,t):n}function Oi(e,t){return e instanceof Bi?as(n=t)||(r=n)&&"doubleValue"in r?t:{integerValue:0}:null;var n,r}class Mi extends Ri{}class Li extends Ri{constructor(e){super(),this.elements=e}}function Ui(e,t){const n=Gi(t);for(const r of e.elements)n.some((e=>Yr(e,r)))||n.push(r);return{arrayValue:{values:n}}}class Fi extends Ri{constructor(e){super(),this.elements=e}}function Vi(e,t){let n=Gi(t);for(const r of e.elements)n=n.filter((e=>!Yr(e,r)));return{arrayValue:{values:n}}}class Bi extends Ri{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function $i(e){return $r(e.integerValue||e.doubleValue)}function Gi(e){return os(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e,t){this.field=e,this.transform=t}}class zi{constructor(e,t){this.version=e,this.transformResults=t}}class Ki{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ki}static exists(e){return new Ki(void 0,e)}static updateTime(e){return new Ki(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Hi(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Wi{}function Qi(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new ia(e.key,Ki.none()):new ea(e.key,e.data,Ki.none());{const n=e.data,r=ws.empty();let s=new Pr(bn.comparator);for(let e of t.fields)if(!s.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),s=s.add(e)}return new ta(e.key,r,new Lr(s.toArray()),Ki.none())}}function Xi(e,t,n){var r;e instanceof ea?function(e,t,n){const r=e.value.clone(),s=ra(e.fieldTransforms,t,n.transformResults);r.setAll(s),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof ta?function(e,t,n){if(!Hi(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=ra(e.fieldTransforms,t,n.transformResults),s=t.data;s.setAll(na(e)),s.setAll(r),t.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(e,t,n):(r=n,t.convertToNoDocument(r.version).setHasCommittedMutations())}function Ji(e,t,n,r){return e instanceof ea?function(e,t,n,r){if(!Hi(e.precondition,t))return n;const s=e.value.clone(),i=sa(e.fieldTransforms,r,t);return s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null}(e,t,n,r):e instanceof ta?function(e,t,n,r){if(!Hi(e.precondition,t))return n;const s=sa(e.fieldTransforms,r,t),i=t.data;return i.setAll(na(e)),i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):(s=t,i=n,Hi(e.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):i);var s,i}function Yi(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),s=Oi(r.transform,e||null);null!=s&&(null===n&&(n=ws.empty()),n.set(r.field,s))}return n||null}function Zi(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(n=e.fieldTransforms,r=t.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&mn(n,r,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&(n=e.transform,r=t.transform,n instanceof Li&&r instanceof Li||n instanceof Fi&&r instanceof Fi?mn(n.elements,r.elements,Yr):n instanceof Bi&&r instanceof Bi?Yr(n.Pe,r.Pe):n instanceof Mi&&r instanceof Mi);var n,r}(e,t))))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask)));var n,r}class ea extends Wi{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class ta extends Wi{constructor(e,t,n,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function na(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function ra(e,t,n){const r=new Map;Xt(e.length===n.length);for(let s=0;s<n.length;s++){const i=e[s],a=i.transform,o=t.data.field(i.field);r.set(i.field,Pi(a,o,n[s]))}return r}function sa(e,t,n){const r=new Map;for(const s of e){const e=s.transform,i=n.data.field(s.field);r.set(s.field,Di(e,i,t))}return r}class ia extends Wi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class aa extends Wi{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Xi(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ji(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Ji(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Ii();return this.mutations.forEach((r=>{const s=e.get(r.key),i=s.overlayedDocument;let a=this.applyToLocalView(i,s.mutatedFields);a=t.has(r.key)?null:a;const o=Qi(i,a);null!==o&&n.set(r.key,o),i.isValidDocument()||i.convertToNoDocument(gn.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ei())}isEqual(e){return this.batchId===e.batchId&&mn(this.mutations,e.mutations,((e,t)=>Zi(e,t)))&&mn(this.baseMutations,e.baseMutations,((e,t)=>Zi(e,t)))}}class la{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Xt(e.mutations.length===n.length);let r=Si;const s=e.mutations;for(let i=0;i<s.length;i++)r=r.insert(s[i].key,n[i].version);return new la(e,t,n,r)}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ua{constructor(e,t){this.count=e,this.unchangedNames=t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ha,da;function ma(e){if(void 0===e)return Kt("GRPC error has no .code"),Yt.UNKNOWN;switch(e){case ha.OK:return Yt.OK;case ha.CANCELLED:return Yt.CANCELLED;case ha.UNKNOWN:return Yt.UNKNOWN;case ha.DEADLINE_EXCEEDED:return Yt.DEADLINE_EXCEEDED;case ha.RESOURCE_EXHAUSTED:return Yt.RESOURCE_EXHAUSTED;case ha.INTERNAL:return Yt.INTERNAL;case ha.UNAVAILABLE:return Yt.UNAVAILABLE;case ha.UNAUTHENTICATED:return Yt.UNAUTHENTICATED;case ha.INVALID_ARGUMENT:return Yt.INVALID_ARGUMENT;case ha.NOT_FOUND:return Yt.NOT_FOUND;case ha.ALREADY_EXISTS:return Yt.ALREADY_EXISTS;case ha.PERMISSION_DENIED:return Yt.PERMISSION_DENIED;case ha.FAILED_PRECONDITION:return Yt.FAILED_PRECONDITION;case ha.ABORTED:return Yt.ABORTED;case ha.OUT_OF_RANGE:return Yt.OUT_OF_RANGE;case ha.UNIMPLEMENTED:return Yt.UNIMPLEMENTED;case ha.DATA_LOSS:return Yt.DATA_LOSS;default:return Qt()}}(da=ha||(ha={}))[da.OK=0]="OK",da[da.CANCELLED=1]="CANCELLED",da[da.UNKNOWN=2]="UNKNOWN",da[da.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",da[da.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",da[da.NOT_FOUND=5]="NOT_FOUND",da[da.ALREADY_EXISTS=6]="ALREADY_EXISTS",da[da.PERMISSION_DENIED=7]="PERMISSION_DENIED",da[da.UNAUTHENTICATED=16]="UNAUTHENTICATED",da[da.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",da[da.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",da[da.ABORTED=10]="ABORTED",da[da.OUT_OF_RANGE=11]="OUT_OF_RANGE",da[da.UNIMPLEMENTED=12]="UNIMPLEMENTED",da[da.INTERNAL=13]="INTERNAL",da[da.UNAVAILABLE=14]="UNAVAILABLE",da[da.DATA_LOSS=15]="DATA_LOSS";
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const fa=new Nt([4294967295,4294967295],0);function pa(e){const t=(new TextEncoder).encode(e),n=new At;return n.update(t),new Uint8Array(n.digest())}function ga(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),s=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new Nt([n,r],0),new Nt([s,i],0)]}class ya{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new va(`Invalid padding: ${t}`);if(n<0)throw new va(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new va(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new va(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Nt.fromNumber(this.Ie)}Ee(e,t,n){let r=e.add(t.multiply(Nt.fromNumber(n)));return 1===r.compare(fa)&&(r=new Nt([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=pa(e),[n,r]=ga(t);for(let s=0;s<this.hashCount;s++){const e=this.Ee(n,r,s);if(!this.de(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),i=new ya(s,r,t);return n.forEach((e=>i.insert(e))),i}insert(e){if(0===this.Ie)return;const t=pa(e),[n,r]=ga(t);for(let s=0;s<this.hashCount;s++){const e=this.Ee(n,r,s);this.Ae(e)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class va extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e,t,n,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,ba.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new wa(gn.min(),r,new jr(dn),vi(),Ei())}}class ba{constructor(e,t,n,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new ba(n,t,Ei(),Ei(),Ei())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa{constructor(e,t,n,r){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=r}}class _a{constructor(e,t){this.targetId=e,this.me=t}}class Ia{constructor(e,t,n=Fr.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class ka{constructor(){this.fe=0,this.ge=Ea(),this.pe=Fr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ei(),t=Ei(),n=Ei();return this.ge.forEach(((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Qt()}})),new ba(this.pe,this.ye,e,t,n)}Ce(){this.we=!1,this.ge=Ea()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Xt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Sa{constructor(e){this.Le=e,this.Be=new Map,this.ke=vi(),this.qe=Ta(),this.Qe=new jr(dn)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,(t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:Qt()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach(((e,n)=>{this.ze(n)&&t(n)}))}He(e){const t=e.targetId,n=e.me.count,r=this.Je(t);if(r){const s=r.target;if(Xs(s))if(0===n){const e=new xn(s.path);this.Ue(t,e,xs.newNoDocument(e,gn.min()))}else Xt(1===n);else{const r=this.Ye(t);if(r!==n){const n=this.Ze(e),s=n?this.Xe(n,e,r):1;if(0!==s){this.je(t);const e=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,e)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:s=0}=t;let i,a;try{i=Gr(n).toUint8Array()}catch(o){if(o instanceof Ur)return Ht("Decoding the base64 bloom filter in existence filter failed ("+o.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw o}try{a=new ya(i,r,s)}catch(o){return Ht(o instanceof va?"BloomFilter error: ":"Applying bloom filter failed: ",o),null}return 0===a.Ie?null:a}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const s=this.Le.tt(),i=`projects/${s.projectId}/databases/${s.database}/documents/${n.path.canonicalString()}`;e.mightContain(i)||(this.Ue(t,n,null),r++)})),r}rt(e){const t=new Map;this.Be.forEach(((n,r)=>{const s=this.Je(r);if(s){if(n.current&&Xs(s.target)){const t=new xn(s.target.path);null!==this.ke.get(t)||this.it(r,t)||this.Ue(r,t,xs.newNoDocument(t,e))}n.be&&(t.set(r,n.ve()),n.Ce())}}));let n=Ei();this.qe.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Je(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.ke.forEach(((t,n)=>n.setReadTime(e)));const r=new wa(e,t,this.Qe,this.ke,n);return this.ke=vi(),this.qe=Ta(),this.Qe=new jr(dn),r}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new ka,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Pr(dn),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||zt("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new ka),this.Le.getRemoteKeysForTarget(e).forEach((t=>{this.Ue(e,t,null)}))}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Ta(){return new jr(xn.comparator)}function Ea(){return new jr(xn.comparator)}const Na={asc:"ASCENDING",desc:"DESCENDING"},Aa={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ca={and:"AND",or:"OR"};class ja{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ra(e,t){return e.useProto3Json||Wn(t)?t:{value:t}}function Da(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Pa(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Oa(e,t){return Da(e,t.toTimestamp())}function Ma(e){return Xt(!!e),gn.fromTimestamp(function(e){const t=Br(e);return new pn(t.seconds,t.nanos)}(e))}function La(e,t){return Ua(e,t).canonicalString()}function Ua(e,t){const n=(r=e,new vn(["projects",r.projectId,"databases",r.database])).child("documents");var r;return void 0===t?n:n.child(t)}function Fa(e){const t=vn.fromString(e);return Xt(ao(t)),t}function Va(e,t){return La(e.databaseId,t.path)}function Ba(e,t){const n=Fa(t);if(n.get(1)!==e.databaseId.projectId)throw new Zt(Yt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Zt(Yt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new xn(za(n))}function $a(e,t){return La(e.databaseId,t)}function Ga(e){const t=Fa(e);return 4===t.length?vn.emptyPath():za(t)}function qa(e){return new vn(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function za(e){return Xt(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Ka(e,t,n){return{name:Va(e,t),fields:n.value.mapValue.fields}}function Ha(e,t){let n;if(t instanceof ea)n={update:Ka(e,t.key,t.value)};else if(t instanceof ia)n={delete:Va(e,t.key)};else if(t instanceof ta)n={update:Ka(e,t.key,t.data),updateMask:io(t.fieldMask)};else{if(!(t instanceof aa))return Qt();n={verify:Va(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof Mi)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Li)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Fi)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Bi)return{fieldPath:t.field.canonicalString(),increment:n.Pe};throw Qt()}(0,e)))),t.precondition.isNone||(n.currentDocument=(r=e,void 0!==(s=t.precondition).updateTime?{updateTime:Oa(r,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:Qt())),n;var r,s}function Wa(e,t){const n=t.currentDocument?void 0!==(s=t.currentDocument).updateTime?Ki.updateTime(Ma(s.updateTime)):void 0!==s.exists?Ki.exists(s.exists):Ki.none():Ki.none(),r=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)Xt("REQUEST_TIME"===t.setToServerValue),n=new Mi;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new Li(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new Fi(e)}else"increment"in t?n=new Bi(e,t.increment):Qt();const r=bn.fromServerFormat(t.fieldPath);return new qi(r,n)}(e,t))):[];var s;if(t.update){t.update.name;const s=Ba(e,t.update.name),i=new ws({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new Lr(t.map((e=>bn.fromServerFormat(e))))}(t.updateMask);return new ta(s,i,e,n,r)}return new ea(s,i,n,r)}if(t.delete){const r=Ba(e,t.delete);return new ia(r,n)}if(t.verify){const r=Ba(e,t.verify);return new aa(r,n)}return Qt()}function Qa(e,t){return{documents:[$a(e,t.path)]}}function Xa(e,t){const n={structuredQuery:{}},r=t.path;let s;null!==t.collectionGroup?(s=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=$a(e,s);const i=function(e){if(0!==e.length)return so(As.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const a=function(e){if(0!==e.length)return e.map((e=>{return{field:no((t=e).field),direction:Za(t.dir)};var t}))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);const o=Ra(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt={before:(l=t.startAt).inclusive,values:l.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:n,parent:s};var l}function Ja(e){let t=Ga(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Xt(1===r);const e=n.from[0];e.allDescendants?s=e.collectionId:t=t.child(e.collectionId)}let i=[];n.where&&(i=function(e){const t=Ya(e);return t instanceof As&&Rs(t)?t.getFilters():[t]}(n.where));let a=[];n.orderBy&&(a=n.orderBy.map((e=>{return new Ss(ro((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t})));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,Wn(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new _s(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new _s(n,t)}(n.endAt)),ti(t,s,a,i,o,"F",l,c)}function Ya(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=ro(e.unaryFilter.field);return Ns.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=ro(e.unaryFilter.field);return Ns.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=ro(e.unaryFilter.field);return Ns.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=ro(e.unaryFilter.field);return Ns.create(s,"!=",{nullValue:"NULL_VALUE"});default:return Qt()}}(e):void 0!==e.fieldFilter?(t=e,Ns.create(ro(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Qt()}}(t.fieldFilter.op),t.fieldFilter.value)):void 0!==e.compositeFilter?function(e){return As.create(e.compositeFilter.filters.map((e=>Ya(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Qt()}}(e.compositeFilter.op))}(e):Qt();var t}function Za(e){return Na[e]}function eo(e){return Aa[e]}function to(e){return Ca[e]}function no(e){return{fieldPath:e.canonicalString()}}function ro(e){return bn.fromServerFormat(e.fieldPath)}function so(e){return e instanceof Ns?function(e){if("=="===e.op){if(cs(e.value))return{unaryFilter:{field:no(e.field),op:"IS_NAN"}};if(ls(e.value))return{unaryFilter:{field:no(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(cs(e.value))return{unaryFilter:{field:no(e.field),op:"IS_NOT_NAN"}};if(ls(e.value))return{unaryFilter:{field:no(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:no(e.field),op:eo(e.op),value:e.value}}}(e):e instanceof As?function(e){const t=e.getFilters().map((e=>so(e)));return 1===t.length?t[0]:{compositeFilter:{op:to(e.op),filters:t}}}(e):Qt()}function io(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function ao(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(e,t,n,r,s=gn.min(),i=gn.min(),a=Fr.EMPTY_BYTE_STRING,o=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(e){return new oo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new oo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new oo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new oo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lo{constructor(e){this.ct=e}}function co(e,t){let n;if(t.document)n=function(e,t,n){const r=Ba(e,t.name),s=Ma(t.updateTime),i=t.createTime?Ma(t.createTime):gn.min(),a=new ws({mapValue:{fields:t.fields}}),o=xs.newFoundDocument(r,s,i,a);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}(e.ct,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=xn.fromSegments(t.noDocument.path),r=fo(t.noDocument.readTime);n=xs.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return Qt();{const e=xn.fromSegments(t.unknownDocument.path),r=fo(t.unknownDocument.version);n=xs.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new pn(e[0],e[1]);return gn.fromTimestamp(t)}(t.readTime)),n}function uo(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:ho(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document={name:Va(s=e.ct,(i=t).key),fields:i.data.value.mapValue.fields,updateTime:Da(s,i.version.toTimestamp()),createTime:Da(s,i.createTime.toTimestamp())};else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:mo(t.version)};else{if(!t.isUnknownDocument())return Qt();r.unknownDocument={path:n.path.toArray(),version:mo(t.version)}}var s,i;return r}function ho(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function mo(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function fo(e){const t=new pn(e.seconds,e.nanoseconds);return gn.fromTimestamp(t)}function po(e,t){const n=(t.baseMutations||[]).map((t=>Wa(e.ct,t)));for(let i=0;i<t.mutations.length-1;++i){const e=t.mutations[i];if(i+1<t.mutations.length&&void 0!==t.mutations[i+1].transform){const n=t.mutations[i+1];e.updateTransforms=n.transform.fieldTransforms,t.mutations.splice(i+1,1),++i}}const r=t.mutations.map((t=>Wa(e.ct,t))),s=pn.fromMillis(t.localWriteTimeMs);return new oa(t.batchId,s,n,r)}function go(e){const t=fo(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?fo(e.lastLimboFreeSnapshotVersion):gn.min();let r;return r=void 0!==e.query.documents?function(e){return Xt(1===e.documents.length),ai(ni(Ga(e.documents[0])))}(e.query):function(e){return ai(Ja(e))}(e.query),new oo(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,Fr.fromBase64String(e.resumeToken))}function yo(e,t){const n=mo(t.snapshotVersion),r=mo(t.lastLimboFreeSnapshotVersion);let s;s=Xs(t.target)?Qa(e.ct,t.target):Xa(e.ct,t.target)._t;const i=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Ws(t.target),readTime:n,resumeToken:i,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function vo(e){const t=Ja({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?li(t,t.limit,"L"):t}function wo(e,t){return new ca(t.largestBatchId,Wa(e.ct,t.overlayMutation))}function bo(e,t){const n=t.path.lastSegment();return[e,Jn(t.path.popLast()),n]}function xo(e,t,n,r){return{indexId:e,uid:t,sequenceNumber:n,readTime:mo(r.readTime),documentKey:Jn(r.documentKey.path),largestBatchId:r.largestBatchId}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{getBundleMetadata(e,t){return Io(e).get(t).next((e=>{if(e)return{id:(t=e).bundleId,createTime:fo(t.createTime),version:t.version};var t}))}saveBundleMetadata(e,t){return Io(e).put({bundleId:(n=t).id,createTime:mo(Ma(n.createTime)),version:n.version});var n}getNamedQuery(e,t){return ko(e).get(t).next((e=>{if(e)return{name:(t=e).name,query:vo(t.bundledQuery),readTime:fo(t.readTime)};var t}))}saveNamedQuery(e,t){return ko(e).put({name:(n=t).name,readTime:mo(Ma(n.readTime)),bundledQuery:n.bundledQuery});var n}}function Io(e){return Er(e,"bundles")}function ko(e){return Er(e,"namedQueries")}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const n=t.uid||"";return new So(e,n)}getOverlay(e,t){return To(e).get(bo(this.userId,t)).next((e=>e?wo(this.serializer,e):null))}getOverlays(e,t){const n=_i();return Pn.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){const r=[];return n.forEach(((n,s)=>{const i=new ca(t,s);r.push(this.ht(e,i))})),Pn.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach((e=>r.add(Jn(e.getCollectionPath()))));const s=[];return r.forEach((t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);s.push(To(e).j("collectionPathOverlayIndex",r))})),Pn.waitFor(s)}getOverlaysForCollection(e,t,n){const r=_i(),s=Jn(t),i=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return To(e).U("collectionPathOverlayIndex",i).next((e=>{for(const t of e){const e=wo(this.serializer,t);r.set(e.getKey(),e)}return r}))}getOverlaysForCollectionGroup(e,t,n,r){const s=_i();let i;const a=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return To(e).J({index:"collectionGroupOverlayIndex",range:a},((e,t,n)=>{const a=wo(this.serializer,t);s.size()<r||a.largestBatchId===i?(s.set(a.getKey(),a),i=a.largestBatchId):n.done()})).next((()=>s))}ht(e,t){return To(e).put(function(e,t,n){const[r,s,i]=bo(t,n.mutation.key);return{userId:t,collectionPath:s,documentId:i,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:Ha(e.ct,n.mutation)}}(this.serializer,this.userId,t))}}function To(e){return Er(e,"documentOverlays")}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{Pt(e){return Er(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next((e=>{const t=null==e?void 0:e.value;return t?Fr.fromUint8Array(t):Fr.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At($r(e.integerValue));else if("doubleValue"in e){const n=$r(e.doubleValue);isNaN(n)?this.dt(t,13):(this.dt(t,15),Qn(n)?t.At(0):t.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(t,20),"string"==typeof n&&(n=Br(n)),t.Rt(`${n.seconds||""}`),t.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Gr(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(t,45),t.At(n.latitude||0),t.At(n.longitude||0)}else"mapValue"in e?ms(e)?this.dt(t,Number.MAX_SAFE_INTEGER):hs(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Qt()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const n=e.fields||{};this.dt(t,55);for(const r of Object.keys(n))this.Vt(r,t),this.Tt(n[r],t)}wt(e,t){var n,r;const s=e.fields||{};this.dt(t,53);const i="value",a=(null===(r=null===(n=s[i].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.dt(t,15),t.At($r(a)),this.Vt(i,t),this.Tt(s[i],t)}bt(e,t){const n=e.values||[];this.dt(t,50);for(const r of n)this.Tt(r,t)}yt(e,t){this.dt(t,37),xn.fromName(e).path.forEach((e=>{this.dt(t,60),this.Dt(e,t)}))}dt(e,t){e.At(t)}ft(e){e.At(2)}}function Ao(e){if(0===e)return 8;let t=0;return!(e>>4)&&(t+=4,e<<=4),!(e>>6)&&(t+=2,e<<=2),!(e>>7)&&(t+=1),t}function Co(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=Ao(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}No.vt=new No;class jo{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ft(n.value),n=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ot(n.value),n=t.next();this.Nt()}Lt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Ft(e);else if(e<2048)this.Ft(960|e>>>6),this.Ft(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Ft(480|e>>>12),this.Ft(128|63&e>>>6),this.Ft(128|63&e);else{const e=t.codePointAt(0);this.Ft(240|e>>>18),this.Ft(128|63&e>>>12),this.Ft(128|63&e>>>6),this.Ft(128|63&e)}}this.Mt()}Bt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Ot(e);else if(e<2048)this.Ot(960|e>>>6),this.Ot(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Ot(480|e>>>12),this.Ot(128|63&e>>>6),this.Ot(128|63&e);else{const e=t.codePointAt(0);this.Ot(240|e>>>18),this.Ot(128|63&e>>>12),this.Ot(128|63&e>>>6),this.Ot(128|63&e)}}this.Nt()}kt(e){const t=this.qt(e),n=Co(t);this.Qt(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}Kt(e){const t=this.qt(e),n=Co(t);this.Qt(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}Ft(e){const t=255&e;0===t?(this.Ut(0),this.Ut(255)):255===t?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;0===t?(this.Gt(0),this.Gt(255)):255===t?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class Ro{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class Do{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Po{constructor(){this.jt=new jo,this.Ht=new Ro(this.jt),this.Jt=new Do(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return 0===e?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}Zt(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new Oo(this.indexId,this.documentKey,this.arrayValue,n)}}function Mo(e,t){let n=e.indexId-t.indexId;return 0!==n?n:(n=Lo(e.arrayValue,t.arrayValue),0!==n?n:(n=Lo(e.directionalValue,t.directionalValue),0!==n?n:xn.comparator(e.documentKey,t.documentKey)))}function Lo(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(e){this.Xt=new Pr(((e,t)=>bn.comparator(e.field,t.field))),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const e=t;e.isInequality()?this.Xt=this.Xt.add(e):this.tn.push(e)}}get nn(){return this.Xt.size>1}rn(e){if(Xt(e.collectionGroup===this.collectionId),this.nn)return!1;const t=In(e);if(void 0!==t&&!this.sn(t))return!1;const n=kn(e);let r=new Set,s=0,i=0;for(;s<n.length&&this.sn(n[s]);++s)r=r.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.Xt.size>0){const e=this.Xt.getIterator().getNext();if(!r.has(e.field.canonicalString())){const t=n[s];if(!this.on(e,t)||!this._n(this.en[i++],t))return!1}++s}for(;s<n.length;++s){const e=n[s];if(i>=this.en.length||!this._n(this.en[i++],e))return!1}return!0}an(){if(this.nn)return null;let e=new Pr(bn.comparator);const t=[];for(const n of this.tn)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new Sn(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new Sn(n.field,0))}for(const n of this.en)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new Sn(n.field,"asc"===n.dir?0:1)));return new _n(_n.UNKNOWN_ID,this.collectionId,t,Tn.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fo(e){var t,n;if(Xt(e instanceof Ns||e instanceof As),e instanceof Ns){if(e instanceof Gs){const r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((t=>Ns.create(e.field,"==",t))))||[];return As.create(r,"or")}return e}const r=e.filters.map((e=>Fo(e)));return As.create(r,e.op)}function Vo(e){if(0===e.getFilters().length)return[];const t=qo(Fo(e));return Xt(Go(t)),Bo(t)||$o(t)?[t]:t.getFilters()}function Bo(e){return e instanceof Ns}function $o(e){return e instanceof As&&Rs(e)}function Go(e){return Bo(e)||$o(e)||function(e){if(e instanceof As&&js(e)){for(const t of e.getFilters())if(!Bo(t)&&!$o(t))return!1;return!0}return!1}(e)}function qo(e){if(Xt(e instanceof Ns||e instanceof As),e instanceof Ns)return e;if(1===e.filters.length)return qo(e.filters[0]);const t=e.filters.map((e=>qo(e)));let n=As.create(t,e.op);return n=Ho(n),Go(n)?n:(Xt(n instanceof As),Xt(Cs(n)),Xt(n.filters.length>1),n.filters.reduce(((e,t)=>zo(e,t))))}function zo(e,t){let n;return Xt(e instanceof Ns||e instanceof As),Xt(t instanceof Ns||t instanceof As),n=e instanceof Ns?t instanceof Ns?(r=e,s=t,As.create([r,s],"and")):Ko(e,t):t instanceof Ns?Ko(t,e):function(e,t){if(Xt(e.filters.length>0&&t.filters.length>0),Cs(e)&&Cs(t))return Ms(e,t.getFilters());const n=js(e)?e:t,r=js(e)?t:e,s=n.filters.map((e=>zo(e,r)));return As.create(s,"or")}(e,t),Ho(n);var r,s}function Ko(e,t){if(Cs(t))return Ms(t,e.getFilters());{const n=t.filters.map((t=>zo(e,t)));return As.create(n,"or")}}function Ho(e){if(Xt(e instanceof Ns||e instanceof As),e instanceof Ns)return e;const t=e.getFilters();if(1===t.length)return Ho(t[0]);if(Ds(e))return e;const n=t.map((e=>Ho(e))),r=[];return n.forEach((t=>{t instanceof Ns?r.push(t):t instanceof As&&(t.op===e.op?r.push(...t.filters):r.push(t))})),1===r.length?r[0]:As.create(r,e.op)
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class Wo{constructor(){this.un=new Qo}addToCollectionParentIndex(e,t){return this.un.add(t),Pn.resolve()}getCollectionParents(e,t){return Pn.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return Pn.resolve()}deleteFieldIndex(e,t){return Pn.resolve()}deleteAllFieldIndexes(e){return Pn.resolve()}createTargetIndexes(e,t){return Pn.resolve()}getDocumentsMatchingTarget(e,t){return Pn.resolve(null)}getIndexType(e,t){return Pn.resolve(0)}getFieldIndexes(e,t){return Pn.resolve([])}getNextCollectionGroupToUpdate(e){return Pn.resolve(null)}getMinOffset(e,t){return Pn.resolve(An.min())}getMinOffsetFromCollectionGroup(e,t){return Pn.resolve(An.min())}updateCollectionGroup(e,t,n){return Pn.resolve()}updateIndexEntries(e,t){return Pn.resolve()}}class Qo{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Pr(vn.comparator),s=!r.has(n);return this.index[t]=r.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Pr(vn.comparator)).toArray()}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xo=new Uint8Array(0);class Jo{constructor(e,t){this.databaseId=t,this.cn=new Qo,this.ln=new gi((e=>Ws(e)),((e,t)=>Qs(e,t))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.cn.add(t)}));const s={collectionId:n,parent:Jn(r)};return Yo(e).put(s)}return Pn.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[fn(t),""],!1,!0);return Yo(e).U(r).next((e=>{for(const r of e){if(r.collectionId!==t)break;n.push(er(r.parent))}return n}))}addFieldIndex(e,t){const n=el(e),r={indexId:(s=t).indexId,collectionGroup:s.collectionGroup,fields:s.fields.map((e=>[e.fieldPath.canonicalString(),e.kind]))};var s;delete r.indexId;const i=n.add(r);if(t.indexState){const n=tl(e);return i.next((e=>{n.put(xo(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return i.next()}deleteFieldIndex(e,t){const n=el(e),r=tl(e),s=Zo(e);return n.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=el(e),n=Zo(e),r=tl(e);return t.j().next((()=>n.j())).next((()=>r.j()))}createTargetIndexes(e,t){return Pn.forEach(this.hn(t),(t=>this.getIndexType(e,t).next((n=>{if(0===n||1===n){const n=new Uo(t).an();if(null!=n)return this.addFieldIndex(e,n)}}))))}getDocumentsMatchingTarget(e,t){const n=Zo(e);let r=!0;const s=new Map;return Pn.forEach(this.hn(t),(t=>this.Pn(e,t).next((e=>{r&&(r=!!e),s.set(t,e)})))).next((()=>{if(r){let e=Ei();const r=[];return Pn.forEach(s,((s,i)=>{var a;zt("IndexedDbIndexManager",`Using index ${a=s,`id=${a.indexId}|cg=${a.collectionGroup}|f=${a.fields.map((e=>`${e.fieldPath}:${e.kind}`)).join(",")}`} to execute ${Ws(t)}`);const o=function(e,t){const n=In(t);if(void 0===n)return null;for(const r of Js(e,n.fieldPath))switch(r.op){case"array-contains-any":return r.value.arrayValue.values||[];case"array-contains":return[r.value]}return null}(i,s),l=function(e,t){const n=new Map;for(const r of kn(t))for(const t of Js(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(i,s),c=function(e,t){const n=[];let r=!0;for(const s of kn(t)){const t=0===s.kind?Ys(e,s.fieldPath,e.startAt):Zs(e,s.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new _s(n,r)}(i,s),u=function(e,t){const n=[];let r=!0;for(const s of kn(t)){const t=0===s.kind?Zs(e,s.fieldPath,e.endAt):Ys(e,s.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new _s(n,r)}(i,s),h=this.In(s,i,c),d=this.In(s,i,u),m=this.Tn(s,i,l),f=this.En(s.indexId,o,h,c.inclusive,d,u.inclusive,m);return Pn.forEach(f,(s=>n.G(s,t.limit).next((t=>{t.forEach((t=>{const n=xn.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))}))}))))})).next((()=>r))}return Pn.resolve(null)}))}hn(e){let t=this.ln.get(e);return t||(t=0===e.filters.length?[e]:Vo(As.create(e.filters,"and")).map((t=>Hs(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt))),this.ln.set(e,t),t)}En(e,t,n,r,s,i,a){const o=(null!=t?t.length:1)*Math.max(n.length,s.length),l=o/(null!=t?t.length:1),c=[];for(let u=0;u<o;++u){const o=t?this.dn(t[u/l]):Xo,h=this.An(e,o,n[u%l],r),d=this.Rn(e,o,s[u%l],i),m=a.map((t=>this.An(e,o,t,!0)));c.push(...this.createRange(h,d,m))}return c}An(e,t,n,r){const s=new Oo(e,xn.empty(),t,n);return r?s:s.Zt()}Rn(e,t,n,r){const s=new Oo(e,xn.empty(),t,n);return r?s.Zt():s}Pn(e,t){const n=new Uo(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((e=>{let t=null;for(const r of e)n.rn(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t}))}getIndexType(e,t){let n=2;const r=this.hn(t);return Pn.forEach(r,(t=>this.Pn(e,t).next((e=>{e?0!==n&&e.fields.length<function(e){let t=new Pr(bn.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const r of e.orderBy)r.field.isKeyField()||(t=t.add(r.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})))).next((()=>null!==t.limit&&r.length>1&&2===n?1:n))}Vn(e,t){const n=new Po;for(const r of kn(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const s=n.Yt(r.kind);No.vt.It(e,s)}return n.zt()}dn(e){const t=new Po;return No.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const n=new Po;return No.vt.It(is(this.databaseId,t),n.Yt(function(e){const t=kn(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.zt()}Tn(e,t,n){if(null===n)return[];let r=[];r.push(new Po);let s=0;for(const i of kn(e)){const e=n[s++];for(const n of r)if(this.fn(t,i.fieldPath)&&os(e))r=this.gn(r,i,e);else{const t=n.Yt(i.kind);No.vt.It(e,t)}}return this.pn(r)}In(e,t,n){return this.Tn(e,t,n.position)}pn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].zt();return t}gn(e,t,n){const r=[...e],s=[];for(const i of n.arrayValue.values||[])for(const e of r){const n=new Po;n.seed(e.zt()),No.vt.It(i,n.Yt(t.kind)),s.push(n)}return s}fn(e,t){return!!e.filters.find((e=>e instanceof Ns&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)))}getFieldIndexes(e,t){const n=el(e),r=tl(e);return(t?n.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.U()).next((e=>{const t=[];return Pn.forEach(e,(e=>r.get([e.indexId,this.uid]).next((n=>{t.push(function(e,t){const n=t?new Tn(t.sequenceNumber,new An(fo(t.readTime),new xn(er(t.documentKey)),t.largestBatchId)):Tn.empty(),r=e.fields.map((([e,t])=>new Sn(bn.fromServerFormat(e),t)));return new _n(e.indexId,e.collectionGroup,r,n)}(e,n))})))).next((()=>t))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((e=>0===e.length?null:(e.sort(((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:dn(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)))}updateCollectionGroup(e,t,n){const r=el(e),s=tl(e);return this.yn(e).next((e=>r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((t=>Pn.forEach(t,(t=>s.put(xo(t.indexId,this.uid,e,n))))))))}updateIndexEntries(e,t){const n=new Map;return Pn.forEach(t,((t,r)=>{const s=n.get(t.collectionGroup);return(s?Pn.resolve(s):this.getFieldIndexes(e,t.collectionGroup)).next((s=>(n.set(t.collectionGroup,s),Pn.forEach(s,(n=>this.wn(e,t,n).next((t=>{const s=this.Sn(r,n);return t.isEqual(s)?Pn.resolve():this.bn(e,r,n,t,s)})))))))}))}Dn(e,t,n,r){return Zo(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.mn(n,t.key),documentKey:t.key.path.toArray()})}vn(e,t,n,r){return Zo(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.mn(n,t.key),t.key.path.toArray()])}wn(e,t,n){const r=Zo(e);let s=new Pr(Mo);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,t)])},((e,r)=>{s=s.add(new Oo(n.indexId,t,r.arrayValue,r.directionalValue))})).next((()=>s))}Sn(e,t){let n=new Pr(Mo);const r=this.Vn(t,e);if(null==r)return n;const s=In(t);if(null!=s){const i=e.data.field(s.fieldPath);if(os(i))for(const s of i.arrayValue.values||[])n=n.add(new Oo(t.indexId,e.key,this.dn(s),r))}else n=n.add(new Oo(t.indexId,e.key,Xo,r));return n}bn(e,t,n,r,s){zt("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const i=[];return function(e,t,n,r,s){const i=e.getIterator(),a=t.getIterator();let o=Mr(i),l=Mr(a);for(;o||l;){let e=!1,t=!1;if(o&&l){const r=n(o,l);r<0?t=!0:r>0&&(e=!0)}else null!=o?t=!0:e=!0;e?(r(l),l=Mr(a)):t?(s(o),o=Mr(i)):(o=Mr(i),l=Mr(a))}}(r,s,Mo,(r=>{i.push(this.Dn(e,t,n,r))}),(r=>{i.push(this.vn(e,t,n,r))})),Pn.waitFor(i)}yn(e){let t=1;return tl(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((e,n,r)=>{r.done(),t=n.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((e,t)=>Mo(e,t))).filter(((e,t,n)=>!t||0!==Mo(e,n[t-1])));const r=[];r.push(e);for(const i of n){const n=Mo(i,e),s=Mo(i,t);if(0===n)r[0]=e.Zt();else if(n>0&&s<0)r.push(i),r.push(i.Zt());else if(s>0)break}r.push(t);const s=[];for(let i=0;i<r.length;i+=2){if(this.Cn(r[i],r[i+1]))return[];const e=[r[i].indexId,this.uid,r[i].arrayValue,r[i].directionalValue,Xo,[]],t=[r[i+1].indexId,this.uid,r[i+1].arrayValue,r[i+1].directionalValue,Xo,[]];s.push(IDBKeyRange.bound(e,t))}return s}Cn(e,t){return Mo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(nl)}getMinOffset(e,t){return Pn.mapArray(this.hn(t),(t=>this.Pn(e,t).next((e=>e||Qt())))).next(nl)}}function Yo(e){return Er(e,"collectionParents")}function Zo(e){return Er(e,"indexEntries")}function el(e){return Er(e,"indexConfiguration")}function tl(e){return Er(e,"indexState")}function nl(e){Xt(0!==e.length);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const s=e[r].indexState.offset;Cn(s,t)<0&&(t=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new An(t.readTime,t.documentKey,n)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rl={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class sl{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new sl(e,sl.DEFAULT_COLLECTION_PERCENTILE,sl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function il(e,t,n){const r=e.store("mutations"),s=e.store("documentMutations"),i=[],a=IDBKeyRange.only(n.batchId);let o=0;const l=r.J({range:a},((e,t,n)=>(o++,n.delete())));i.push(l.next((()=>{Xt(1===o)})));const c=[];for(const u of n.mutations){const e=rr(t,u.key.path,n.batchId);i.push(s.delete(e)),c.push(u.key)}return Pn.waitFor(i).next((()=>c))}function al(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw Qt();t=e.noDocument}return JSON.stringify(t).length}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */sl.DEFAULT_COLLECTION_PERCENTILE=10,sl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,sl.DEFAULT=new sl(41943040,sl.DEFAULT_COLLECTION_PERCENTILE,sl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),sl.DISABLED=new sl(-1,0,0);class ol{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Fn={}}static lt(e,t,n,r){Xt(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new ol(s,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return cl(e).J({index:"userMutationsIndex",range:n},((e,n,r)=>{t=!1,r.done()})).next((()=>t))}addMutationBatch(e,t,n,r){const s=ul(e),i=cl(e);return i.add({}).next((a=>{Xt("number"==typeof a);const o=new oa(a,t,n,r),l=function(e,t,n){const r=n.baseMutations.map((t=>Ha(e.ct,t))),s=n.mutations.map((t=>Ha(e.ct,t)));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:s}}(this.serializer,this.userId,o),c=[];let u=new Pr(((e,t)=>dn(e.canonicalString(),t.canonicalString())));for(const e of r){const t=rr(this.userId,e.key.path,a);u=u.add(e.key.path.popLast()),c.push(i.put(l)),c.push(s.put(t,sr))}return u.forEach((t=>{c.push(this.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.Fn[a]=o.keys()})),Pn.waitFor(c).next((()=>o))}))}lookupMutationBatch(e,t){return cl(e).get(t).next((e=>e?(Xt(e.userId===this.userId),po(this.serializer,e)):null))}Mn(e,t){return this.Fn[t]?Pn.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.Fn[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return cl(e).J({index:"userMutationsIndex",range:r},((e,t,r)=>{t.userId===this.userId&&(Xt(t.batchId>=n),s=po(this.serializer,t)),r.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return cl(e).J({index:"userMutationsIndex",range:t,reverse:!0},((e,t,r)=>{n=t.batchId,r.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return cl(e).U("userMutationsIndex",t).next((e=>e.map((e=>po(this.serializer,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=nr(this.userId,t.path),r=IDBKeyRange.lowerBound(n),s=[];return ul(e).J({range:r},((n,r,i)=>{const[a,o,l]=n,c=er(o);if(a===this.userId&&t.path.isEqual(c))return cl(e).get(l).next((e=>{if(!e)throw Qt();Xt(e.userId===this.userId),s.push(po(this.serializer,e))}));i.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Pr(dn);const r=[];return t.forEach((t=>{const s=nr(this.userId,t.path),i=IDBKeyRange.lowerBound(s),a=ul(e).J({range:i},((e,r,s)=>{const[i,a,o]=e,l=er(a);i===this.userId&&t.path.isEqual(l)?n=n.add(o):s.done()}));r.push(a)})),Pn.waitFor(r).next((()=>this.xn(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,s=nr(this.userId,n),i=IDBKeyRange.lowerBound(s);let a=new Pr(dn);return ul(e).J({range:i},((e,t,s)=>{const[i,o,l]=e,c=er(o);i===this.userId&&n.isPrefixOf(c)?c.length===r&&(a=a.add(l)):s.done()})).next((()=>this.xn(e,a)))}xn(e,t){const n=[],r=[];return t.forEach((t=>{r.push(cl(e).get(t).next((e=>{if(null===e)throw Qt();Xt(e.userId===this.userId),n.push(po(this.serializer,e))})))})),Pn.waitFor(r).next((()=>n))}removeMutationBatch(e,t){return il(e._e,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.On(t.batchId)})),Pn.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Pn.resolve();const n=IDBKeyRange.lowerBound([this.userId]),r=[];return ul(e).J({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=er(e[1]);r.push(t)}else n.done()})).next((()=>{Xt(0===r.length)}))}))}containsKey(e,t){return ll(e,this.userId,t)}Nn(e){return hl(e).get(this.userId).next((e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}))}}function ll(e,t,n){const r=nr(t,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let a=!1;return ul(e).J({range:i,H:!0},((e,n,r)=>{const[i,o,l]=e;i===t&&o===s&&(a=!0),r.done()})).next((()=>a))}function cl(e){return Er(e,"mutations")}function ul(e){return Er(e,"documentMutations")}function hl(e){return Er(e,"mutationQueues")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new dl(0)}static kn(){return new dl(-1)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next((t=>{const n=new dl(t.highestTargetId);return t.highestTargetId=n.next(),this.Qn(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.qn(e).next((e=>gn.fromTimestamp(new pn(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.qn(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.qn(e).next((r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Qn(e,r))))}addTargetData(e,t){return this.Kn(e,t).next((()=>this.qn(e).next((n=>(n.targetCount+=1,this.$n(t,n),this.Qn(e,n))))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>fl(e).delete(t.targetId))).next((()=>this.qn(e))).next((t=>(Xt(t.targetCount>0),t.targetCount-=1,this.Qn(e,t))))}removeTargets(e,t,n){let r=0;const s=[];return fl(e).J(((i,a)=>{const o=go(a);o.sequenceNumber<=t&&null===n.get(o.targetId)&&(r++,s.push(this.removeTargetData(e,o)))})).next((()=>Pn.waitFor(s))).next((()=>r))}forEachTarget(e,t){return fl(e).J(((e,n)=>{const r=go(n);t(r)}))}qn(e){return pl(e).get("targetGlobalKey").next((e=>(Xt(null!==e),e)))}Qn(e,t){return pl(e).put("targetGlobalKey",t)}Kn(e,t){return fl(e).put(yo(this.serializer,t))}$n(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.qn(e).next((e=>e.targetCount))}getTargetData(e,t){const n=Ws(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return fl(e).J({range:r,index:"queryTargetsIndex"},((e,n,r)=>{const i=go(n);Qs(t,i.target)&&(s=i,r.done())})).next((()=>s))}addMatchingKeys(e,t,n){const r=[],s=gl(e);return t.forEach((t=>{const i=Jn(t.path);r.push(s.put({targetId:n,path:i})),r.push(this.referenceDelegate.addReference(e,n,t))})),Pn.waitFor(r)}removeMatchingKeys(e,t,n){const r=gl(e);return Pn.forEach(t,(t=>{const s=Jn(t.path);return Pn.waitFor([r.delete([n,s]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=gl(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=gl(e);let s=Ei();return r.J({range:n,H:!0},((e,t,n)=>{const r=er(e[1]),i=new xn(r);s=s.add(i)})).next((()=>s))}containsKey(e,t){const n=Jn(t.path),r=IDBKeyRange.bound([n],[fn(n)],!1,!0);let s=0;return gl(e).J({index:"documentTargetsIndex",H:!0,range:r},(([e,t],n,r)=>{0!==e&&(s++,r.done())})).next((()=>s>0))}ot(e,t){return fl(e).get(t).next((e=>e?go(e):null))}}function fl(e){return Er(e,"targets")}function pl(e){return Er(e,"targetGlobal")}function gl(e){return Er(e,"targetDocuments")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yl([e,t],[n,r]){const s=dn(e,n);return 0===s?dn(t,r):s}class vl{constructor(e){this.Un=e,this.buffer=new Pr(yl),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();yl(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class wl{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.jn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return null!==this.jn}Hn(e){zt("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Vn(e)?zt("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await Dn(e)}await this.Hn(3e5)}))}}class bl{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return Pn.resolve(Hn.oe);const n=new vl(t);return this.Jn.forEachTarget(e,(e=>n.zn(e.sequenceNumber))).next((()=>this.Jn.Zn(e,(e=>n.zn(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.Jn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(zt("LruGarbageCollector","Garbage collection skipped; disabled"),Pn.resolve(rl)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(zt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),rl):this.Xn(e,t)))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let n,r,s,i,a,o,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(zt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,i=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,a=Date.now(),this.removeTargets(e,n,t)))).next((t=>(s=t,o=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(l=Date.now(),qt()<=se.DEBUG&&zt("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${i-c}ms\n\tDetermined least recently used ${r} in `+(a-i)+`ms\n\tRemoved ${s} targets in `+(o-a)+`ms\n\tRemoved ${e} documents in `+(l-o)+`ms\nTotal Duration: ${l-c}ms`),Pn.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:e}))))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class xl{constructor(e,t){this.db=e,this.garbageCollector=function(e,t){return new bl(e,t)}(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}er(e){let t=0;return this.Zn(e,(e=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,((e,n)=>t(n)))}addReference(e,t,n){return _l(e,n)}removeReference(e,t,n){return _l(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return _l(e,t)}nr(e,t){return function(e,t){let n=!1;return hl(e).Y((r=>ll(e,r,t).next((e=>(e&&(n=!0),Pn.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.tr(e,((i,a)=>{if(a<=t){const t=this.nr(e,i).next((t=>{if(!t)return s++,n.getEntry(e,i).next((()=>(n.removeEntry(i,gn.min()),gl(e).delete([0,Jn(i.path)]))))}));r.push(t)}})).next((()=>Pn.waitFor(r))).next((()=>n.apply(e))).next((()=>s))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return _l(e,t)}tr(e,t){const n=gl(e);let r,s=Hn.oe;return n.J({index:"documentTargetsIndex"},(([e,n],{path:i,sequenceNumber:a})=>{0===e?(s!==Hn.oe&&t(new xn(er(r)),s),s=a,r=i):s=Hn.oe})).next((()=>{s!==Hn.oe&&t(new xn(er(r)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function _l(e,t){return gl(e).put((n=t,r=e.currentSequenceNumber,{targetId:0,path:Jn(n.path),sequenceNumber:r}));var n,r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il{constructor(){this.changes=new gi((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,xs.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Pn.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Nl(e).put(n)}removeEntry(e,t,n){return Nl(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],ho(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.rr(e,n))))}getEntry(e,t){let n=xs.newInvalidDocument(t);return Nl(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Al(t))},((e,r)=>{n=this.ir(t,r)})).next((()=>n))}sr(e,t){let n={size:0,document:xs.newInvalidDocument(t)};return Nl(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Al(t))},((e,r)=>{n={document:this.ir(t,r),size:al(r)}})).next((()=>n))}getEntries(e,t){let n=vi();return this._r(e,t,((e,t)=>{const r=this.ir(e,t);n=n.insert(e,r)})).next((()=>n))}ar(e,t){let n=vi(),r=new jr(xn.comparator);return this._r(e,t,((e,t)=>{const s=this.ir(e,t);n=n.insert(e,s),r=r.insert(e,al(t))})).next((()=>({documents:n,ur:r})))}_r(e,t,n){if(t.isEmpty())return Pn.resolve();let r=new Pr(jl);t.forEach((e=>r=r.add(e)));const s=IDBKeyRange.bound(Al(r.first()),Al(r.last())),i=r.getIterator();let a=i.getNext();return Nl(e).J({index:"documentKeyIndex",range:s},((e,t,r)=>{const s=xn.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;a&&jl(a,s)<0;)n(a,null),a=i.getNext();a&&a.isEqual(s)&&(n(a,t),a=i.hasNext()?i.getNext():null),a?r.$(Al(a)):r.done()})).next((()=>{for(;a;)n(a,null),a=i.hasNext()?i.getNext():null}))}getDocumentsMatchingQuery(e,t,n,r,s){const i=t.path,a=[i.popLast().toArray(),i.lastSegment(),ho(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],o=[i.popLast().toArray(),i.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Nl(e).U(IDBKeyRange.bound(a,o,!0)).next((e=>{null==s||s.incrementDocumentReadCount(e.length);let n=vi();for(const s of e){const e=this.ir(xn.fromSegments(s.prefixPath.concat(s.collectionGroup,s.documentId)),s);e.isFoundDocument()&&(di(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n}))}getAllFromCollectionGroup(e,t,n,r){let s=vi();const i=Cl(t,n),a=Cl(t,An.max());return Nl(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(i,a,!0)},((e,t,n)=>{const i=this.ir(xn.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);s=s.insert(i.key,i),s.size===r&&n.done()})).next((()=>s))}newChangeBuffer(e){return new Tl(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return El(e).get("remoteDocumentGlobalKey").next((e=>(Xt(!!e),e)))}rr(e,t){return El(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const e=co(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(gn.min()))return e}return xs.newInvalidDocument(e)}}function Sl(e){return new kl(e)}class Tl extends Il{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new gi((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,r=new Pr(((e,t)=>dn(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((s,i)=>{const a=this.lr.get(s);if(t.push(this.cr.removeEntry(e,s,a.readTime)),i.isValidDocument()){const o=uo(this.cr.serializer,i);r=r.add(s.path.popLast());const l=al(o);n+=l-a.size,t.push(this.cr.addEntry(e,s,o))}else if(n-=a.size,this.trackRemovals){const n=uo(this.cr.serializer,i.convertToNoDocument(gn.min()));t.push(this.cr.addEntry(e,s,n))}})),r.forEach((n=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,n))})),t.push(this.cr.updateMetadata(e,n)),Pn.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next((e=>(this.lr.set(t,{size:e.size,readTime:e.document.readTime}),e.document)))}getAllFromCache(e,t){return this.cr.ar(e,t).next((({documents:e,ur:t})=>(t.forEach(((t,n)=>{this.lr.set(t,{size:n,readTime:e.get(t).readTime})})),e)))}}function El(e){return Er(e,"remoteDocumentGlobal")}function Nl(e){return Er(e,"remoteDocumentsV14")}function Al(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Cl(e,t){const n=t.documentKey.path.toArray();return[e,ho(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function jl(e,t){const n=e.path.toArray(),r=t.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=dn(n[i],r[i]),s)return s;return s=dn(n.length,r.length),s||(s=dn(n[n.length-2],r[r.length-2]),s||dn(n[n.length-1],r[r.length-1])
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */)}class Rl{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&Ji(n.mutation,e,Lr.empty(),pn.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,Ei()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=Ei()){const r=_i();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=bi();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=_i();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Ei())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let s=vi();const i=ki(),a=ki();return t.forEach(((e,t)=>{const a=n.get(t.key);r.has(t.key)&&(void 0===a||a.mutation instanceof ta)?s=s.insert(t.key,t):void 0!==a?(i.set(t.key,a.mutation.getFieldMask()),Ji(a.mutation,t,a.mutation.getFieldMask(),pn.now())):i.set(t.key,Lr.empty())})),this.recalculateAndSaveOverlays(e,s).next((e=>(e.forEach(((e,t)=>i.set(e,t))),t.forEach(((e,t)=>{var n;return a.set(e,new Rl(t,null!==(n=i.get(e))&&void 0!==n?n:null))})),a)))}recalculateAndSaveOverlays(e,t){const n=ki();let r=new jr(((e,t)=>e-t)),s=Ei();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const s of e)s.keys().forEach((e=>{const i=t.get(e);if(null===i)return;let a=n.get(e)||Lr.empty();a=s.applyToLocalView(i,a),n.set(e,a);const o=(r.get(s.batchId)||Ei()).add(e);r=r.insert(s.batchId,o)}))})).next((()=>{const i=[],a=r.getReverseIterator();for(;a.hasNext();){const r=a.getNext(),o=r.key,l=r.value,c=Ii();l.forEach((e=>{if(!s.has(e)){const r=Qi(t.get(e),n.get(e));null!==r&&c.set(e,r),s=s.add(e)}})),i.push(this.documentOverlayCache.saveOverlays(e,o,c))}return Pn.waitFor(i)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return s=t,xn.isDocumentKey(s.path)&&null===s.collectionGroup&&0===s.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):si(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r);var s}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((s=>{const i=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-s.size):Pn.resolve(_i());let a=-1,o=s;return i.next((t=>Pn.forEach(t,((t,n)=>(a<n.largestBatchId&&(a=n.largestBatchId),s.get(t)?Pn.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{o=o.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,s))).next((()=>this.computeViews(e,o,t,Ei()))).next((e=>({batchId:a,changes:xi(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new xn(t)).next((e=>{let t=bi();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const s=t.collectionGroup;let i=bi();return this.indexManager.getCollectionParents(e,s).next((a=>Pn.forEach(a,(a=>{const o=(l=t,c=a.child(s),new ei(c,null,l.explicitOrderBy.slice(),l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt));var l,c;return this.getDocumentsMatchingCollectionQuery(e,o,n,r).next((e=>{e.forEach(((e,t)=>{i=i.insert(e,t)}))}))})).next((()=>i))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,r)))).next((e=>{s.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,xs.newInvalidDocument(r)))}));let n=bi();return e.forEach(((e,r)=>{const i=s.get(e);void 0!==i&&Ji(i.mutation,r,Lr.empty(),pn.now()),di(t,r)&&(n=n.insert(e,r))})),n}))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return Pn.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,{id:(n=t).id,version:n.version,createTime:Ma(n.createTime)}),Pn.resolve();var n}getNamedQuery(e,t){return Pn.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,{name:(n=t).name,query:vo(n.bundledQuery),readTime:Ma(n.readTime)}),Pn.resolve();var n}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(){this.overlays=new jr(xn.comparator),this.Ir=new Map}getOverlay(e,t){return Pn.resolve(this.overlays.get(t))}getOverlays(e,t){const n=_i();return Pn.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.ht(e,t,r)})),Pn.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Ir.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.Ir.delete(n)),Pn.resolve()}getOverlaysForCollection(e,t,n){const r=_i(),s=t.length+1,i=new xn(t.child("")),a=this.overlays.getIteratorFrom(i);for(;a.hasNext();){const e=a.getNext().value,i=e.getKey();if(!t.isPrefixOf(i.path))break;i.path.length===s&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Pn.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let s=new jr(((e,t)=>e-t));const i=this.overlays.getIterator();for(;i.hasNext();){const e=i.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=s.get(e.largestBatchId);null===t&&(t=_i(),s=s.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const a=_i(),o=s.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach(((e,t)=>a.set(e,t))),!(a.size()>=r)););return Pn.resolve(a)}ht(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Ir.get(r.largestBatchId).delete(n.key);this.Ir.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new ca(t,n));let s=this.Ir.get(t);void 0===s&&(s=Ei(),this.Ir.set(t,s)),this.Ir.set(t,s.add(n.key))}}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(){this.sessionToken=Fr.EMPTY_BYTE_STRING}getSessionToken(e){return Pn.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Pn.resolve()}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(){this.Tr=new Pr(Ul.Er),this.dr=new Pr(Ul.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const n=new Ul(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Vr(new Ul(e,t))}mr(e,t){e.forEach((e=>this.removeReference(e,t)))}gr(e){const t=new xn(new vn([])),n=new Ul(t,e),r=new Ul(t,e+1),s=[];return this.dr.forEachInRange([n,r],(e=>{this.Vr(e),s.push(e.key)})),s}pr(){this.Tr.forEach((e=>this.Vr(e)))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new xn(new vn([])),n=new Ul(t,e),r=new Ul(t,e+1);let s=Ei();return this.dr.forEachInRange([n,r],(e=>{s=s.add(e.key)})),s}containsKey(e){const t=new Ul(e,0),n=this.Tr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Ul{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return xn.comparator(e.key,t.key)||dn(e.wr,t.wr)}static Ar(e,t){return dn(e.wr,t.wr)||xn.comparator(e.key,t.key)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Pr(Ul.Er)}checkEmpty(e){return Pn.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new oa(s,t,n,r);this.mutationQueue.push(i);for(const a of r)this.br=this.br.add(new Ul(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return Pn.resolve(i)}lookupMutationBatch(e,t){return Pn.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.vr(n),s=r<0?0:r;return Pn.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Pn.resolve(0===this.mutationQueue.length?-1:this.Sr-1)}getAllMutationBatches(e){return Pn.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Ul(t,0),r=new Ul(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,r],(e=>{const t=this.Dr(e.wr);s.push(t)})),Pn.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Pr(dn);return t.forEach((e=>{const t=new Ul(e,0),r=new Ul(e,Number.POSITIVE_INFINITY);this.br.forEachInRange([t,r],(e=>{n=n.add(e.wr)}))})),Pn.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let s=n;xn.isDocumentKey(s)||(s=s.child(""));const i=new Ul(new xn(s),0);let a=new Pr(dn);return this.br.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.wr)),!0)}),i),Pn.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach((e=>{const n=this.Dr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){Xt(0===this.Fr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.br;return Pn.forEach(t.mutations,(r=>{const s=new Ul(r.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.br=n}))}On(e){}containsKey(e,t){const n=new Ul(t,0),r=this.br.firstAfterOrEqual(n);return Pn.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Pn.resolve()}Fr(e,t){return this.vr(e)}vr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e){this.Mr=e,this.docs=new jr(xn.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),s=r?r.size:0,i=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:i}),this.size+=i-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Pn.resolve(n?n.document.mutableCopy():xs.newInvalidDocument(t))}getEntries(e,t){let n=vi();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():xs.newInvalidDocument(e))})),Pn.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let s=vi();const i=t.path,a=new xn(i.child("")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){const{key:e,value:{document:a}}=o.getNext();if(!i.isPrefixOf(e.path))break;e.path.length>i.length+1||Cn(Nn(a),n)<=0||(r.has(a.key)||di(t,a))&&(s=s.insert(a.key,a.mutableCopy()))}return Pn.resolve(s)}getAllFromCollectionGroup(e,t,n,r){Qt()}Or(e,t){return Pn.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new Bl(this)}getSize(e){return Pn.resolve(this.size)}}class Bl extends Il{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.cr.addEntry(e,r)):this.cr.removeEntry(n)})),Pn.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(e){this.persistence=e,this.Nr=new gi((e=>Ws(e)),Qs),this.lastRemoteSnapshotVersion=gn.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Ll,this.targetCount=0,this.kr=dl.Bn()}forEachTarget(e,t){return this.Nr.forEach(((e,n)=>t(n))),Pn.resolve()}getLastRemoteSnapshotVersion(e){return Pn.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Pn.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Pn.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),Pn.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new dl(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,Pn.resolve()}updateTargetData(e,t){return this.Kn(t),Pn.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,Pn.resolve()}removeTargets(e,t,n){let r=0;const s=[];return this.Nr.forEach(((i,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.Nr.delete(i),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)})),Pn.waitFor(s).next((()=>r))}getTargetCount(e){return Pn.resolve(this.targetCount)}getTargetData(e,t){const n=this.Nr.get(t)||null;return Pn.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),Pn.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((t=>{s.push(r.markPotentiallyOrphaned(e,t))})),Pn.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),Pn.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.yr(t);return Pn.resolve(n)}containsKey(e,t){return Pn.resolve(this.Br.containsKey(t))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Hn(0),this.Kr=!1,this.Kr=!0,this.$r=new Ml,this.referenceDelegate=e(this),this.Ur=new $l(this),this.indexManager=new Wo,this.remoteDocumentCache=new Vl((e=>this.referenceDelegate.Wr(e))),this.serializer=new lo(t),this.Gr=new Pl(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ol,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new Fl(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){zt("MemoryPersistence","Starting transaction:",e);const r=new ql(this.Qr.next());return this.referenceDelegate.zr(),n(r).next((e=>this.referenceDelegate.jr(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Hr(e,t){return Pn.or(Object.values(this.qr).map((n=>()=>n.containsKey(e,t))))}}class ql extends Rn{constructor(e){super(),this.currentSequenceNumber=e}}class zl{constructor(e){this.persistence=e,this.Jr=new Ll,this.Yr=null}static Zr(e){return new zl(e)}get Xr(){if(this.Yr)return this.Yr;throw Qt()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),Pn.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),Pn.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),Pn.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach((e=>this.Xr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Xr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Pn.forEach(this.Xr,(n=>{const r=xn.fromPath(n);return this.ei(e,r).next((e=>{e||t.removeEntry(r,gn.min())}))})).next((()=>(this.Yr=null,t.apply(e))))}updateLimboDocument(e,t){return this.ei(e,t).next((e=>{e?this.Xr.delete(t.toString()):this.Xr.add(t.toString())}))}Wr(e){return 0}ei(e,t){return Pn.or([()=>Pn.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(e){this.serializer=e}O(e,t,n,r){const s=new On("createOrUpgrade",t);n<1&&r>=1&&(e.createObjectStore("owner"),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",tr,{unique:!0}),e.createObjectStore("documentMutations")}(e),Hl(e),function(e){e.createObjectStore("remoteDocuments")}(e));let i=Pn.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),Hl(e)),i=i.next((()=>function(e){const t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:gn.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(s)))),n<4&&r>=4&&(0!==n&&(i=i.next((()=>function(e,t){return t.store("mutations").U().next((n=>{e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",tr,{unique:!0});const r=t.store("mutations"),s=n.map((e=>r.put(e)));return Pn.waitFor(s)}))}(e,s)))),i=i.next((()=>{!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(i=i.next((()=>this.ni(s)))),n<6&&r>=6&&(i=i.next((()=>(function(e){e.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s))))),n<7&&r>=7&&(i=i.next((()=>this.ii(s)))),n<8&&r>=8&&(i=i.next((()=>this.si(e,s)))),n<9&&r>=9&&(i=i.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(i=i.next((()=>this.oi(s)))),n<11&&r>=11&&(i=i.next((()=>{!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&r>=12&&(i=i.next((()=>{!function(e){const t=e.createObjectStore("documentOverlays",{keyPath:gr});t.createIndex("collectionPathOverlayIndex",yr,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",vr,{unique:!1})}(e)}))),n<13&&r>=13&&(i=i.next((()=>function(e){const t=e.createObjectStore("remoteDocumentsV14",{keyPath:ir});t.createIndex("documentKeyIndex",ar),t.createIndex("collectionGroupIndex",or)}(e))).next((()=>this._i(e,s))).next((()=>e.deleteObjectStore("remoteDocuments")))),n<14&&r>=14&&(i=i.next((()=>this.ai(e,s)))),n<15&&r>=15&&(i=i.next((()=>function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:dr}).createIndex("sequenceNumberIndex",mr,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:fr}).createIndex("documentKeyIndex",pr,{unique:!1})}(e)))),n<16&&r>=16&&(i=i.next((()=>{t.objectStore("indexState").clear()})).next((()=>{t.objectStore("indexEntries").clear()}))),n<17&&r>=17&&(i=i.next((()=>{!function(e){e.createObjectStore("globals",{keyPath:"name"})}(e)}))),i}ri(e){let t=0;return e.store("remoteDocuments").J(((e,n)=>{t+=al(n)})).next((()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}ni(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.U().next((t=>Pn.forEach(t,(t=>{const r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",r).next((n=>Pn.forEach(n,(n=>{Xt(n.userId===t.userId);const r=po(this.serializer,n);return il(e,t.userId,r).next((()=>{}))}))))}))))}ii(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((e=>{const r=[];return n.J(((n,s)=>{const i=new vn(n),a=[0,Jn(i)];r.push(t.get(a).next((n=>{return n?Pn.resolve():(r=i,t.put({targetId:0,path:Jn(r),sequenceNumber:e.highestListenSequenceNumber}));var r})))})).next((()=>Pn.waitFor(r)))}))}si(e,t){e.createObjectStore("collectionParents",{keyPath:hr});const n=t.store("collectionParents"),r=new Qo,s=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:Jn(r)})}};return t.store("remoteDocuments").J({H:!0},((e,t)=>{const n=new vn(e);return s(n.popLast())})).next((()=>t.store("documentMutations").J({H:!0},(([e,t,n],r)=>{const i=er(t);return s(i.popLast())}))))}oi(e){const t=e.store("targets");return t.J(((e,n)=>{const r=go(n),s=yo(this.serializer,r);return t.put(s)}))}_i(e,t){const n=t.store("remoteDocuments"),r=[];return n.J(((e,n)=>{const s=t.store("remoteDocumentsV14"),i=(o=n,o.document?new xn(vn.fromString(o.document.name).popFirst(5)):o.noDocument?xn.fromSegments(o.noDocument.path):o.unknownDocument?xn.fromSegments(o.unknownDocument.path):Qt()).path.toArray(),a={prefixPath:i.slice(0,i.length-2),collectionGroup:i[i.length-2],documentId:i[i.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};var o;r.push(s.put(a))})).next((()=>Pn.waitFor(r)))}ai(e,t){const n=t.store("mutations"),r=Sl(this.serializer),s=new Gl(zl.Zr,this.serializer.ct);return n.U().next((e=>{const n=new Map;return e.forEach((e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:Ei();po(this.serializer,e).keys().forEach((e=>r=r.add(e))),n.set(e.userId,r)})),Pn.forEach(n,((e,n)=>{const i=new Bt(n),a=So.lt(this.serializer,i),o=s.getIndexManager(i),l=ol.lt(i,this.serializer,o,s.referenceDelegate);return new Dl(r,l,a,o).recalculateAndSaveOverlaysForDocumentKeys(new Tr(t,Hn.oe),e).next()}))}))}}function Hl(e){e.createObjectStore("targetDocuments",{keyPath:cr}).createIndex("documentTargetsIndex",ur,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",lr,{unique:!0}),e.createObjectStore("targetGlobal")}const Wl="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Ql{constructor(e,t,n,r,s,i,a,o,l,c,u=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.ui=s,this.window=i,this.document=a,this.ci=l,this.li=c,this.hi=u,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=e=>Promise.resolve(),!Ql.D())throw new Zt(Yt.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new xl(this,r),this.Ai=t+"main",this.serializer=new lo(o),this.Ri=new Mn(this.Ai,this.hi,new Kl(this.serializer)),this.$r=new Eo,this.Ur=new ml(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Sl(this.serializer),this.Gr=new _o,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,!1===c&&Kt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Zt(Yt.FAILED_PRECONDITION,Wl);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Ur.getHighestSequenceNumber(e)))})).then((e=>{this.Qr=new Hn(e,this.ci)})).then((()=>{this.Kr=!0})).catch((e=>(this.Ri&&this.Ri.close(),Promise.reject(e))))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L((async t=>{null===t.newVersion&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget((async()=>{this.started&&await this.mi()})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Jl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.wi(e).next((e=>{e||(this.isPrimary=!1,this.ui.enqueueRetryable((()=>this.di(!1))))}))})).next((()=>this.Si(e))).next((t=>this.isPrimary&&!t?this.bi(e).next((()=>!1)):!!t&&this.Di(e).next((()=>!0)))))).catch((e=>{if(Vn(e))return zt("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return zt("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.ui.enqueueRetryable((()=>this.di(e))),this.isPrimary=e}))}wi(e){return Xl(e).get("owner").next((e=>Pn.resolve(this.vi(e))))}Ci(e){return Jl(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=Er(e,"clientMetadata");return t.U().next((e=>{const n=this.xi(e,18e5),r=e.filter((e=>-1===n.indexOf(e)));return Pn.forEach(r,(e=>t.delete(e.clientId))).next((()=>r))}))})).catch((()=>[]));if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.mi().then((()=>this.Fi())).then((()=>this.pi()))))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?Pn.resolve(!0):Xl(e).get("owner").next((t=>{if(null!==t&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new Zt(Yt.FAILED_PRECONDITION,Wl);return!1}}return!(!this.networkEnabled||!this.inForeground)||Jl(e).U().next((e=>void 0===this.xi(e,5e3).find((e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&zt("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(e=>{const t=new Tr(e,Hn.oe);return this.bi(t).next((()=>this.Ci(t)))})),this.Ri.close(),this.qi()}xi(e,t){return e.filter((e=>this.Mi(e.updateTimeMs,t)&&!this.Ni(e.clientId)))}Qi(){return this.runTransaction("getActiveClients","readonly",(e=>Jl(e).U().next((e=>this.xi(e,18e5).map((e=>e.clientId))))))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return ol.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Jo(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return So.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,n){zt("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",s=17===(i=this.hi)?Sr:16===i?kr:15===i?Ir:14===i?_r:13===i?xr:12===i?br:11===i?wr:void Qt();var i;let a;return this.Ri.runTransaction(e,r,s,(r=>(a=new Tr(r,this.Qr?this.Qr.next():Hn.oe),"readwrite-primary"===t?this.wi(a).next((e=>!!e||this.Si(a))).next((t=>{if(!t)throw Kt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable((()=>this.di(!1))),new Zt(Yt.FAILED_PRECONDITION,jn);return n(a)})).next((e=>this.Di(a).next((()=>e)))):this.Ki(a).next((()=>n(a)))))).then((e=>(a.raiseOnCommittedEvent(),e)))}Ki(e){return Xl(e).get("owner").next((e=>{if(null!==e&&this.Mi(e.leaseTimestampMs,5e3)&&!this.Ni(e.ownerId)&&!this.vi(e)&&!(this.li||this.allowTabSynchronization&&e.allowTabSynchronization))throw new Zt(Yt.FAILED_PRECONDITION,Wl)}))}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Xl(e).put("owner",t)}static D(){return Mn.D()}bi(e){const t=Xl(e);return t.get("owner").next((e=>this.vi(e)?(zt("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):Pn.resolve()))}Mi(e,t){const n=Date.now();return!(e<n-t||e>n&&(Kt(`Detected an update time that is in the future: ${e} > ${n}`),1))}fi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ii=()=>{this.ui.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.mi())))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground="visible"===this.document.visibilityState)}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Pi=()=>{this.Li();const e=/(?:Version|Mobile)\/1[456]/;G()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const n=null!==(null===(t=this.Vi)||void 0===t?void 0:t.getItem(this.Oi(e)));return zt("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Kt("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Kt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch(e){}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Xl(e){return Er(e,"owner")}function Jl(e){return Er(e,"clientMetadata")}function Yl(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class Zl{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=r}static Wi(e,t){let n=Ei(),r=Ei();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Zl(e,t.fromCache,n,r)}}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=G()?8:Ln($())>0?6:4}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,r){const s={result:null};return this.Yi(e,t).next((e=>{s.result=e})).next((()=>{if(!s.result)return this.Zi(e,t,r,n).next((e=>{s.result=e}))})).next((()=>{if(s.result)return;const n=new ec;return this.Xi(e,t,n).next((r=>{if(s.result=r,this.zi)return this.es(e,t,n,r.size)}))})).next((()=>s.result))}es(e,t,n,r){return n.documentReadCount<this.ji?(qt()<=se.DEBUG&&zt("QueryEngine","SDK will not create cache indexes for query:",hi(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Pn.resolve()):(qt()<=se.DEBUG&&zt("QueryEngine","Query:",hi(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Hi*r?(qt()<=se.DEBUG&&zt("QueryEngine","The SDK decides to create cache indexes for query:",hi(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ai(t))):Pn.resolve())}Yi(e,t){if(ri(t))return Pn.resolve(null);let n=ai(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=li(t,null,"F"),n=ai(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const s=Ei(...r);return this.Ji.getDocuments(e,s).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const i=this.ts(t,r);return this.ns(t,i,s,n.readTime)?this.Yi(e,li(t,null,"F")):this.rs(e,i,t,n)}))))})))))}Zi(e,t,n,r){return ri(t)||r.isEqual(gn.min())?Pn.resolve(null):this.Ji.getDocuments(e,n).next((s=>{const i=this.ts(t,s);return this.ns(t,i,n,r)?Pn.resolve(null):(qt()<=se.DEBUG&&zt("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),hi(t)),this.rs(e,i,t,En(r,-1)).next((e=>e)))}))}ts(e,t){let n=new Pr(fi(e));return t.forEach(((t,r)=>{di(e,r)&&(n=n.add(r))})),n}ns(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Xi(e,t,n){return qt()<=se.DEBUG&&zt("QueryEngine","Using full collection scan to execute query:",hi(t)),this.Ji.getDocumentsMatchingQuery(e,t,An.min(),n)}rs(e,t,n,r){return this.Ji.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(e,t,n,r){this.persistence=e,this.ss=t,this.serializer=r,this.os=new jr(dn),this._s=new gi((e=>Ws(e)),Qs),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Dl(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.os)))}}function rc(e,t,n,r){return new nc(e,t,n,r)}async function sc(e,t){const n=Jt(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((s=>(r=s,n.ls(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const s=[],i=[];let a=Ei();for(const e of r){s.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}for(const e of t){i.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}return n.localDocuments.getDocuments(e,a).next((e=>({hs:e,removedBatchIds:s,addedBatchIds:i})))}))}))}function ic(e){const t=Jt(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Ur.getLastRemoteSnapshotVersion(e)))}function ac(e,t){const n=Jt(e),r=t.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const i=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const a=[];t.targetChanges.forEach(((i,o)=>{const l=s.get(o);if(!l)return;a.push(n.Ur.removeMatchingKeys(e,i.removedDocuments,o).next((()=>n.Ur.addMatchingKeys(e,i.addedDocuments,o))));let c=l.withSequenceNumber(e.currentSequenceNumber);var u,h,d;null!==t.targetMismatches.get(o)?c=c.withResumeToken(Fr.EMPTY_BYTE_STRING,gn.min()).withLastLimboFreeSnapshotVersion(gn.min()):i.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(i.resumeToken,r)),s=s.insert(o,c),h=c,d=i,(0===(u=l).resumeToken.approximateByteSize()||h.snapshotVersion.toMicroseconds()-u.snapshotVersion.toMicroseconds()>=3e8||d.addedDocuments.size+d.modifiedDocuments.size+d.removedDocuments.size>0)&&a.push(n.Ur.updateTargetData(e,c))}));let o=vi(),l=Ei();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),a.push(function(e,t,n){let r=Ei(),s=Ei();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=vi();return n.forEach(((n,i)=>{const a=e.get(n);i.isFoundDocument()!==a.isFoundDocument()&&(s=s.add(n)),i.isNoDocument()&&i.version.isEqual(gn.min())?(t.removeEntry(n,i.readTime),r=r.insert(n,i)):!a.isValidDocument()||i.version.compareTo(a.version)>0||0===i.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(i),r=r.insert(n,i)):zt("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",i.version)})),{Ps:r,Is:s}}))}(e,i,t.documentUpdates).next((e=>{o=e.Ps,l=e.Is}))),!r.isEqual(gn.min())){const t=n.Ur.getLastRemoteSnapshotVersion(e).next((t=>n.Ur.setTargetsMetadata(e,e.currentSequenceNumber,r)));a.push(t)}return Pn.waitFor(a).next((()=>i.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,o,l))).next((()=>o))})).then((e=>(n.os=s,e)))}function oc(e,t){const n=Jt(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function lc(e,t){const n=Jt(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Ur.getTargetData(e,t).next((s=>s?(r=s,Pn.resolve(r)):n.Ur.allocateTargetId(e).next((s=>(r=new oo(t,s,"TargetPurposeListen",e.currentSequenceNumber),n.Ur.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.os.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.os=n.os.insert(e.targetId,e),n._s.set(t,e.targetId)),e}))}async function cc(e,t,n){const r=Jt(e),s=r.os.get(t),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,(e=>r.persistence.referenceDelegate.removeTarget(e,s)))}catch(a){if(!Vn(a))throw a;zt("LocalStore",`Failed to update sequence numbers for target ${t}: ${a}`)}r.os=r.os.remove(t),r._s.delete(s.target)}function uc(e,t,n){const r=Jt(e);let s=gn.min(),i=Ei();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=Jt(e),s=r._s.get(n);return void 0!==s?Pn.resolve(r.os.get(s)):r.Ur.getTargetData(t,n)}(r,e,ai(t)).next((t=>{if(t)return s=t.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(e,t.targetId).next((e=>{i=e}))})).next((()=>r.ss.getDocumentsMatchingQuery(e,t,n?s:gn.min(),n?i:Ei()))).next((e=>(mc(r,mi(t),e),{documents:e,Ts:i})))))}function hc(e,t){const n=Jt(e),r=Jt(n.Ur),s=n.os.get(t);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",(e=>r.ot(e,t).next((e=>e?e.target:null))))}function dc(e,t){const n=Jt(e),r=n.us.get(t)||gn.min();return n.persistence.runTransaction("Get new document changes","readonly",(e=>n.cs.getAllFromCollectionGroup(e,t,En(r,-1),Number.MAX_SAFE_INTEGER))).then((e=>(mc(n,t,e),e)))}function mc(e,t,n){let r=e.us.get(t)||gn.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.us.set(t,r)}function fc(e,t){return`firestore_clients_${e}_${t}`}function pc(e,t,n){let r=`firestore_mutations_${e}_${n}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}function gc(e,t){return`firestore_targets_${e}_${t}`}class yc{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static Rs(e,t,n){const r=JSON.parse(n);let s,i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code,i&&(s=new Zt(r.error.code,r.error.message))),i?new yc(e,t,r.state,s):(Kt("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class vc{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Rs(e,t){const n=JSON.parse(t);let r,s="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return s&&n.error&&(s="string"==typeof n.error.message&&"string"==typeof n.error.code,s&&(r=new Zt(n.error.code,n.error.message))),s?new vc(e,n.state,r):(Kt("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class wc{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,s=Ai();for(let i=0;r&&i<n.activeTargetIds.length;++i)r=Xn(n.activeTargetIds[i]),s=s.add(n.activeTargetIds[i]);return r?new wc(e,s):(Kt("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class bc{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new bc(t.clientId,t.onlineState):(Kt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class xc{constructor(){this.activeTargetIds=Ai()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class _c{constructor(e,t,n,r,s){this.window=e,this.ui=t,this.persistenceKey=n,this.ps=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new jr(dn),this.started=!1,this.bs=[];const i=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=fc(this.persistenceKey,this.ps),this.vs=`firestore_sequence_number_${this.persistenceKey}`,this.Ss=this.Ss.insert(this.ps,new xc),this.Cs=new RegExp(`^firestore_clients_${i}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${i}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${i}_(\\d+)$`),this.xs=function(e){return`firestore_online_state_${e}`}(this.persistenceKey),this.Os=function(e){return`firestore_bundle_loaded_v2_${e}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const n of e){if(n===this.ps)continue;const e=this.getItem(fc(this.persistenceKey,n));if(e){const t=wc.Rs(n,e);t&&(this.Ss=this.Ss.insert(t.clientId,t))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const e=this.Ls(t);e&&this.Bs(e)}for(const n of this.bs)this.ws(n);this.bs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach(((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,n){this.qs(e,t,n),this.Qs(e)}addLocalQueryTarget(e,t=!0){let n="not-current";if(this.isActiveQueryTarget(e)){const t=this.storage.getItem(gc(this.persistenceKey,e));if(t){const r=vc.Rs(e,t);r&&(n=r.state)}}return t&&this.Ks.fs(e),this.Ns(),n}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(gc(this.persistenceKey,e))}updateQueryState(e,t,n){this.$s(e,t,n)}handleUserChange(e,t,n){t.forEach((e=>{this.Qs(e)})),this.currentUser=e,n.forEach((e=>{this.addPendingMutation(e)}))}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return zt("SharedClientState","READ",e,t),t}setItem(e,t){zt("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){zt("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(zt("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void Kt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable((async()=>{if(this.started){if(null!==t.key)if(this.Cs.test(t.key)){if(null==t.newValue){const e=this.Gs(t.key);return this.zs(e,null)}{const e=this.js(t.key,t.newValue);if(e)return this.zs(e.clientId,e)}}else if(this.Fs.test(t.key)){if(null!==t.newValue){const e=this.Hs(t.key,t.newValue);if(e)return this.Js(e)}}else if(this.Ms.test(t.key)){if(null!==t.newValue){const e=this.Ys(t.key,t.newValue);if(e)return this.Zs(e)}}else if(t.key===this.xs){if(null!==t.newValue){const e=this.Ls(t.newValue);if(e)return this.Bs(e)}}else if(t.key===this.vs){const e=function(e){let t=Hn.oe;if(null!=e)try{const n=JSON.parse(e);Xt("number"==typeof n),t=n}catch(n){Kt("SharedClientState","Failed to read sequence number from WebStorage",n)}return t}(t.newValue);e!==Hn.oe&&this.sequenceNumberHandler(e)}else if(t.key===this.Os){const e=this.Xs(t.newValue);await Promise.all(e.map((e=>this.syncEngine.eo(e))))}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,n){const r=new yc(this.currentUser,e,t,n),s=pc(this.persistenceKey,this.currentUser,e);this.setItem(s,r.Vs())}Qs(e){const t=pc(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,n){const r=gc(this.persistenceKey,e),s=new vc(e,t,n);this.setItem(r,s.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const n=this.Gs(e);return wc.Rs(n,t)}Hs(e,t){const n=this.Fs.exec(e),r=Number(n[1]),s=void 0!==n[2]?n[2]:null;return yc.Rs(new Bt(s),r,t)}Ys(e,t){const n=this.Ms.exec(e),r=Number(n[1]);return vc.Rs(r,t)}Ls(e){return bc.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);zt("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const n=t?this.Ss.insert(e,t):this.Ss.remove(e),r=this.ks(this.Ss),s=this.ks(n),i=[],a=[];return s.forEach((e=>{r.has(e)||i.push(e)})),r.forEach((e=>{s.has(e)||a.push(e)})),this.syncEngine.io(i,a).then((()=>{this.Ss=n}))}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=Ai();return e.forEach(((e,n)=>{t=t.unionWith(n.activeTargetIds)})),t}}class Ic{constructor(){this.so=new xc,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new xc,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc{_o(e){}shutdown(){}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sc{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){zt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){zt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tc=null;function Ec(){return null===Tc?Tc=268435456+Math.round(2147483648*Math.random()):Tc++,"0x"+Tc.toString(16)
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}const Nc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cc="WebChannelConnection";class jc extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Do=t+"://"+e.host,this.vo=`projects/${n}/databases/${r}`,this.Co="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${r}`}get Fo(){return!1}Mo(e,t,n,r,s){const i=Ec(),a=this.xo(e,t.toUriEncodedString());zt("RestConnection",`Sending RPC '${e}' ${i}:`,a,n);const o={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(o,r,s),this.No(e,a,o,n).then((t=>(zt("RestConnection",`Received RPC '${e}' ${i}: `,t),t)),(t=>{throw Ht("RestConnection",`RPC '${e}' ${i} failed with error: `,t,"url: ",a,"request:",n),t}))}Lo(e,t,n,r,s,i){return this.Mo(e,t,n,r,s)}Oo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+$t,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}xo(e,t){const n=Nc[e];return`${this.Do}/v1/${t}:${n}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,r){const s=Ec();return new Promise(((i,a)=>{const o=new jt;o.setWithCredentials(!0),o.listenOnce(Dt.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case Pt.NO_ERROR:const t=o.getResponseJson();zt(Cc,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(t)),i(t);break;case Pt.TIMEOUT:zt(Cc,`RPC '${e}' ${s} timed out`),a(new Zt(Yt.DEADLINE_EXCEEDED,"Request time out"));break;case Pt.HTTP_ERROR:const n=o.getStatus();if(zt(Cc,`RPC '${e}' ${s} failed with status:`,n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Yt).indexOf(t)>=0?t:Yt.UNKNOWN}(t.status);a(new Zt(e,t.message))}else a(new Zt(Yt.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new Zt(Yt.UNAVAILABLE,"Connection failed."));break;default:Qt()}}finally{zt(Cc,`RPC '${e}' ${s} completed.`)}}));const l=JSON.stringify(r);zt(Cc,`RPC '${e}' ${s} sending request:`,r),o.send(t,"POST",l,n,15)}))}Bo(e,t,n){const r=Ec(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=Ut(),a=Lt(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.Oo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const c=s.join("");zt(Cc,`Creating RPC '${e}' stream ${r}: ${c}`,o);const u=i.createWebChannel(c,o);let h=!1,d=!1;const m=new Ac({Io:t=>{d?zt(Cc,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(h||(zt(Cc,`Opening RPC '${e}' stream ${r} transport.`),u.open(),h=!0),zt(Cc,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},To:()=>u.close()}),f=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(t){setTimeout((()=>{throw t}),0)}}))};return f(u,Rt.EventType.OPEN,(()=>{d||(zt(Cc,`RPC '${e}' stream ${r} transport opened.`),m.yo())})),f(u,Rt.EventType.CLOSE,(()=>{d||(d=!0,zt(Cc,`RPC '${e}' stream ${r} transport closed`),m.So())})),f(u,Rt.EventType.ERROR,(t=>{d||(d=!0,Ht(Cc,`RPC '${e}' stream ${r} transport errored:`,t),m.So(new Zt(Yt.UNAVAILABLE,"The operation could not be completed")))})),f(u,Rt.EventType.MESSAGE,(t=>{var n;if(!d){const s=t.data[0];Xt(!!s);const i=s,a=i.error||(null===(n=i[0])||void 0===n?void 0:n.error);if(a){zt(Cc,`RPC '${e}' stream ${r} received error:`,a);const t=a.status;let n=function(e){const t=ha[e];if(void 0!==t)return ma(t)}(t),s=a.message;void 0===n&&(n=Yt.INTERNAL,s="Unknown error status: "+t+" with message "+a.message),d=!0,m.So(new Zt(n,s)),u.close()}else zt(Cc,`RPC '${e}' stream ${r} received:`,s),m.bo(s)}})),f(a,Mt.STAT_EVENT,(t=>{t.stat===Ot.PROXY?zt(Cc,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===Ot.NOPROXY&&zt(Cc,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{m.wo()}),0),m}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rc(){return"undefined"!=typeof window?window:null}function Dc(){return"undefined"!=typeof document?document:null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pc(e){return new ja(e,!0)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oc{constructor(e,t,n=1e3,r=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=n,this.qo=r,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),r=Math.max(0,t-n);r>0&&zt("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,(()=>(this.Uo=Date.now(),e()))),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){null!==this.$o&&(this.$o.skipDelay(),this.$o=null)}cancel(){null!==this.$o&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mc{constructor(e,t,n,r,s,i,a,o){this.ui=e,this.Ho=n,this.Jo=r,this.connection=s,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Oc(e,t)}n_(){return 1===this.state||5===this.state||this.r_()}r_(){return 2===this.state||3===this.state}start(){this.e_=0,4!==this.state?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&null===this.Zo&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,(()=>this.__())))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,4!==e?this.t_.reset():t&&t.code===Yt.RESOURCE_EXHAUSTED?(Kt(t.toString()),Kt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===Yt.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.Yo===t&&this.P_(e,n)}),(t=>{e((()=>{const e=new Zt(Yt.UNKNOWN,"Fetching auth token failed: "+t.message);return this.I_(e)}))}))}P_(e,t){const n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo((()=>{n((()=>this.listener.Eo()))})),this.stream.Ro((()=>{n((()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,(()=>(this.r_()&&(this.state=3),Promise.resolve()))),this.listener.Ro())))})),this.stream.mo((e=>{n((()=>this.I_(e)))})),this.stream.onMessage((e=>{n((()=>1==++this.e_?this.E_(e):this.onNext(e)))}))}i_(){this.state=5,this.t_.Go((async()=>{this.state=0,this.start()}))}I_(e){return zt("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget((()=>this.Yo===e?t():(zt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Lc extends Mc{constructor(e,t,n,r,s,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,i),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const s="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:Qt(),i=t.targetChange.targetIds||[],a=function(e,t){return e.useProto3Json?(Xt(void 0===t||"string"==typeof t),Fr.fromBase64String(t||"")):(Xt(void 0===t||t instanceof Buffer||t instanceof Uint8Array),Fr.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,l=o&&function(e){const t=void 0===e.code?Yt.UNKNOWN:ma(e.code);return new Zt(t,e.message||"")}(o);n=new Ia(s,i,a,l||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ba(e,r.document.name),i=Ma(r.document.updateTime),a=r.document.createTime?Ma(r.document.createTime):gn.min(),o=new ws({mapValue:{fields:r.document.fields}}),l=xs.newFoundDocument(s,i,a,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new xa(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const s=Ba(e,r.document),i=r.readTime?Ma(r.readTime):gn.min(),a=xs.newNoDocument(s,i),o=r.removedTargetIds||[];n=new xa([],o,a.key,a)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const s=Ba(e,r.document),i=r.removedTargetIds||[];n=new xa([],i,s,null)}else{if(!("filter"in t))return Qt();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:s}=e,i=new ua(r,s),a=e.targetId;n=new _a(a,i)}}var r;return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return gn.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?gn.min():t.readTime?Ma(t.readTime):gn.min()}(e);return this.listener.d_(t,n)}A_(e){const t={};t.database=qa(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Xs(r)?{documents:Qa(e,r)}:{query:Xa(e,r)._t},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Pa(e,t.resumeToken);const r=Ra(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(gn.min())>0){n.readTime=Da(e,t.snapshotVersion.toTimestamp());const r=Ra(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Qt()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.a_(t)}R_(e){const t={};t.database=qa(this.serializer),t.removeTarget=e,this.a_(t)}}class Uc extends Mc{constructor(e,t,n,r,s,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,i),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Xt(!!e.streamToken),this.lastStreamToken=e.streamToken,Xt(!e.writeResults||0===e.writeResults.length),this.listener.f_()}onNext(e){Xt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=function(e,t){return e&&e.length>0?(Xt(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?Ma(e.updateTime):Ma(t);return n.isEqual(gn.min())&&(n=Ma(t)),new zi(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=Ma(e.commitTime);return this.listener.g_(n,t)}p_(){const e={};e.database=qa(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Ha(this.serializer,e)))};this.a_(t)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new Zt(Yt.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,i])=>this.connection.Mo(e,Ua(t,n),r,s,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Yt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Zt(Yt.UNKNOWN,e.toString())}))}Lo(e,t,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Lo(e,Ua(t,n),r,i,a,s))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Yt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Zt(Yt.UNKNOWN,e.toString())}))}terminate(){this.y_=!0,this.connection.terminate()}}class Vc{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){0===this.S_&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve()))))}M_(e){"Online"===this.state?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,"Online"===e&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Kt(t),this.D_=!1):zt("OnlineStateTracker",t)}x_(){null!==this.b_&&(this.b_.cancel(),this.b_=null)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bc{constructor(e,t,n,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o((e=>{n.enqueueAndForget((async()=>{Xc(this)&&(zt("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Jt(e);t.L_.add(4),await Gc(t),t.q_.set("Unknown"),t.L_.delete(4),await $c(t)}(this))}))})),this.q_=new Vc(n,r)}}async function $c(e){if(Xc(e))for(const t of e.B_)await t(!0)}async function Gc(e){for(const t of e.B_)await t(!1)}function qc(e,t){const n=Jt(e);n.N_.has(t.targetId)||(n.N_.set(t.targetId,t),Qc(n)?Wc(n):pu(n).r_()&&Kc(n,t))}function zc(e,t){const n=Jt(e),r=pu(n);n.N_.delete(t),r.r_()&&Hc(n,t),0===n.N_.size&&(r.r_()?r.o_():Xc(n)&&n.q_.set("Unknown"))}function Kc(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(gn.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}pu(e).A_(t)}function Hc(e,t){e.Q_.xe(t),pu(e).R_(t)}function Wc(e){e.Q_=new Sa({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),pu(e).start(),e.q_.v_()}function Qc(e){return Xc(e)&&!pu(e).n_()&&e.N_.size>0}function Xc(e){return 0===Jt(e).L_.size}function Jc(e){e.Q_=void 0}async function Yc(e){e.q_.set("Online")}async function Zc(e){e.N_.forEach(((t,n)=>{Kc(e,t)}))}async function eu(e,t){Jc(e),Qc(e)?(e.q_.M_(t),Wc(e)):e.q_.set("Unknown")}async function tu(e,t,n){if(e.q_.set("Online"),t instanceof Ia&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.N_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.N_.delete(r),e.Q_.removeTarget(r))}(e,t)}catch(r){zt("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),await nu(e,r)}else if(t instanceof xa?e.Q_.Ke(t):t instanceof _a?e.Q_.He(t):e.Q_.We(t),!n.isEqual(gn.min()))try{const t=await ic(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Q_.rt(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const s=e.N_.get(r);s&&e.N_.set(r,s.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.N_.get(t);if(!r)return;e.N_.set(t,r.withResumeToken(Fr.EMPTY_BYTE_STRING,r.snapshotVersion)),Hc(e,t);const s=new oo(r.target,t,n,r.sequenceNumber);Kc(e,s)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(s){zt("RemoteStore","Failed to raise snapshot:",s),await nu(e,s)}}async function nu(e,t,n){if(!Vn(t))throw t;e.L_.add(1),await Gc(e),e.q_.set("Offline"),n||(n=()=>ic(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{zt("RemoteStore","Retrying IndexedDB access"),await n(),e.L_.delete(1),await $c(e)}))}function ru(e,t){return t().catch((n=>nu(e,n,t)))}async function su(e){const t=Jt(e),n=gu(t);let r=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;iu(t);)try{const e=await oc(t.localStore,r);if(null===e){0===t.O_.length&&n.o_();break}r=e.batchId,au(t,e)}catch(s){await nu(t,s)}ou(t)&&lu(t)}function iu(e){return Xc(e)&&e.O_.length<10}function au(e,t){e.O_.push(t);const n=gu(e);n.r_()&&n.V_&&n.m_(t.mutations)}function ou(e){return Xc(e)&&!gu(e).n_()&&e.O_.length>0}function lu(e){gu(e).start()}async function cu(e){gu(e).p_()}async function uu(e){const t=gu(e);for(const n of e.O_)t.m_(n.mutations)}async function hu(e,t,n){const r=e.O_.shift(),s=la.from(r,t,n);await ru(e,(()=>e.remoteSyncer.applySuccessfulWrite(s))),await su(e)}async function du(e,t){t&&gu(e).V_&&await async function(e,t){if(function(e){switch(e){default:return Qt();case Yt.CANCELLED:case Yt.UNKNOWN:case Yt.DEADLINE_EXCEEDED:case Yt.RESOURCE_EXHAUSTED:case Yt.INTERNAL:case Yt.UNAVAILABLE:case Yt.UNAUTHENTICATED:return!1;case Yt.INVALID_ARGUMENT:case Yt.NOT_FOUND:case Yt.ALREADY_EXISTS:case Yt.PERMISSION_DENIED:case Yt.FAILED_PRECONDITION:case Yt.ABORTED:case Yt.OUT_OF_RANGE:case Yt.UNIMPLEMENTED:case Yt.DATA_LOSS:return!0}}(n=t.code)&&n!==Yt.ABORTED){const n=e.O_.shift();gu(e).s_(),await ru(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await su(e)}var n}(e,t),ou(e)&&lu(e)}async function mu(e,t){const n=Jt(e);n.asyncQueue.verifyOperationInProgress(),zt("RemoteStore","RemoteStore received new credentials");const r=Xc(n);n.L_.add(3),await Gc(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.L_.delete(3),await $c(n)}async function fu(e,t){const n=Jt(e);t?(n.L_.delete(2),await $c(n)):t||(n.L_.add(2),await Gc(n),n.q_.set("Unknown"))}function pu(e){return e.K_||(e.K_=function(e,t,n){const r=Jt(e);return r.w_(),new Lc(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:Yc.bind(null,e),Ro:Zc.bind(null,e),mo:eu.bind(null,e),d_:tu.bind(null,e)}),e.B_.push((async t=>{t?(e.K_.s_(),Qc(e)?Wc(e):e.q_.set("Unknown")):(await e.K_.stop(),Jc(e))}))),e.K_}function gu(e){return e.U_||(e.U_=function(e,t,n){const r=Jt(e);return r.w_(),new Uc(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:cu.bind(null,e),mo:du.bind(null,e),f_:uu.bind(null,e),g_:hu.bind(null,e)}),e.B_.push((async t=>{t?(e.U_.s_(),await su(e)):(await e.U_.stop(),e.O_.length>0&&(zt("RemoteStore",`Stopping write stream with ${e.O_.length} pending writes`),e.O_=[]))}))),e.U_
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class yu{constructor(e,t,n,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new en,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,s){const i=Date.now()+n,a=new yu(e,t,i,r,s);return a.start(n),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Zt(Yt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function vu(e,t){if(Kt("AsyncQueue",`${t}: ${e}`),Vn(e))return new Zt(Yt.UNAVAILABLE,`${t}: ${e}`);throw e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu{constructor(e){this.comparator=e?(t,n)=>e(t,n)||xn.comparator(t.key,n.key):(e,t)=>xn.comparator(e.key,t.key),this.keyedMap=bi(),this.sortedSet=new jr(this.comparator)}static emptySet(e){return new wu(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof wu))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new wu;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(){this.W_=new jr(xn.comparator)}track(e){const t=e.doc.key,n=this.W_.get(t);n?0!==e.type&&3===n.type?this.W_=this.W_.insert(t,e):3===e.type&&1!==n.type?this.W_=this.W_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.W_=this.W_.remove(t):1===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Qt():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class xu{constructor(e,t,n,r,s,i,a,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=i,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,s){const i=[];return t.forEach((e=>{i.push({type:0,doc:e})})),new xu(e,t,wu.emptySet(t),i,n,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ci(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _u{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some((e=>e.J_()))}}class Iu{constructor(){this.queries=ku(),this.onlineState="Unknown",this.Y_=new Set}terminate(){!function(e,t){const n=Jt(e),r=n.queries;n.queries=ku(),r.forEach(((e,n)=>{for(const r of n.j_)r.onError(t)}))}(this,new Zt(Yt.ABORTED,"Firestore shutting down"))}}function ku(){return new gi((e=>ui(e)),ci)}async function Su(e,t){const n=Jt(e);let r=3;const s=t.query;let i=n.queries.get(s);i?!i.H_()&&t.J_()&&(r=2):(i=new _u,r=t.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(a){const e=vu(a,`Initialization of query '${hi(t.query)}' failed`);return void t.onError(e)}n.queries.set(s,i),i.j_.push(t),t.Z_(n.onlineState),i.z_&&t.X_(i.z_)&&Au(n)}async function Tu(e,t){const n=Jt(e),r=t.query;let s=3;const i=n.queries.get(r);if(i){const e=i.j_.indexOf(t);e>=0&&(i.j_.splice(e,1),0===i.j_.length?s=t.J_()?0:1:!i.H_()&&t.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Eu(e,t){const n=Jt(e);let r=!1;for(const s of t){const e=s.query,t=n.queries.get(e);if(t){for(const e of t.j_)e.X_(s)&&(r=!0);t.z_=s}}r&&Au(n)}function Nu(e,t,n){const r=Jt(e),s=r.queries.get(t);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(t)}function Au(e){e.Y_.forEach((e=>{e.next()}))}var Cu,ju;(ju=Cu||(Cu={})).ea="default",ju.Cache="cache";class Ru{constructor(e,t,n){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new xu(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache)return!0;if(!this.J_())return!0;const n="Offline"!==t;return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}oa(e){e=xu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Cu.Cache}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e){this.key=e}}class Pu{constructor(e){this.key=e}}class Ou{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ei(),this.mutatedKeys=Ei(),this.Aa=fi(e),this.Ra=new wu(this.Aa)}get Va(){return this.Ta}ma(e,t){const n=t?t.fa:new bu,r=t?t.Ra:this.Ra;let s=t?t.mutatedKeys:this.mutatedKeys,i=r,a=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const c=r.get(e),u=di(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let m=!1;c&&u?c.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),m=!0):this.ga(c,u)||(n.track({type:2,doc:u}),m=!0,(o&&this.Aa(u,o)>0||l&&this.Aa(u,l)<0)&&(a=!0)):!c&&u?(n.track({type:0,doc:u}),m=!0):c&&!u&&(n.track({type:1,doc:c}),m=!0,(o||l)&&(a=!0)),m&&(u?(i=i.add(u),s=d?s.add(e):s.delete(e)):(i=i.delete(e),s=s.delete(e)))})),null!==this.query.limit)for(;i.size>this.query.limit;){const e="F"===this.query.limitType?i.last():i.first();i=i.delete(e.key),s=s.delete(e.key),n.track({type:1,doc:e})}return{Ra:i,fa:n,ns:a,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const i=e.fa.G_();i.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Qt()}};return n(e)-n(t)}(e.type,t.type)||this.Aa(e.doc,t.doc))),this.pa(n),r=null!=r&&r;const a=t&&!r?this.ya():[],o=0===this.da.size&&this.current&&!r?1:0,l=o!==this.Ea;return this.Ea=o,0!==i.length||l?{snapshot:new xu(this.query,e.Ra,s,i,e.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new bu,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach((e=>this.Ta=this.Ta.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Ta=this.Ta.delete(e))),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ei(),this.Ra.forEach((e=>{this.Sa(e.key)&&(this.da=this.da.add(e.key))}));const t=[];return e.forEach((e=>{this.da.has(e)||t.push(new Pu(e))})),this.da.forEach((n=>{e.has(n)||t.push(new Du(n))})),t}ba(e){this.Ta=e.Ts,this.da=Ei();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return xu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,0===this.Ea,this.hasCachedResults)}}class Mu{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Lu{constructor(e){this.key=e,this.va=!1}}class Uu{constructor(e,t,n,r,s,i){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=i,this.Ca={},this.Fa=new gi((e=>ui(e)),ci),this.Ma=new Map,this.xa=new Set,this.Oa=new jr(xn.comparator),this.Na=new Map,this.La=new Ll,this.Ba={},this.ka=new Map,this.qa=dl.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return!0===this.Qa}}async function Fu(e,t,n=!0){const r=fh(e);let s;const i=r.Fa.get(t);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await Bu(r,t,n,!0),s}async function Vu(e,t){const n=fh(e);await Bu(n,t,!0,!1)}async function Bu(e,t,n,r){const s=await lc(e.localStore,ai(t)),i=s.targetId,a=e.sharedClientState.addLocalQueryTarget(i,n);let o;return r&&(o=await $u(e,t,i,"current"===a,s.resumeToken)),e.isPrimaryClient&&n&&qc(e.remoteStore,s),o}async function $u(e,t,n,r,s){e.Ka=(t,n,r)=>async function(e,t,n,r){let s=t.view.ma(n);s.ns&&(s=await uc(e.localStore,t.query,!1).then((({documents:e})=>t.view.ma(e,s))));const i=r&&r.targetChanges.get(t.targetId),a=r&&null!=r.targetMismatches.get(t.targetId),o=t.view.applyChanges(s,e.isPrimaryClient,i,a);return eh(e,t.targetId,o.wa),o.snapshot}(e,t,n,r);const i=await uc(e.localStore,t,!0),a=new Ou(t,i.Ts),o=a.ma(i.documents),l=ba.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,s),c=a.applyChanges(o,e.isPrimaryClient,l);eh(e,n,c.wa);const u=new Mu(t,n,a);return e.Fa.set(t,u),e.Ma.has(n)?e.Ma.get(n).push(t):e.Ma.set(n,[t]),c.snapshot}async function Gu(e,t,n){const r=Jt(e),s=r.Fa.get(t),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter((e=>!ci(e,t)))),void r.Fa.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await cc(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),n&&zc(r.remoteStore,s.targetId),Yu(r,s.targetId)})).catch(Dn)):(Yu(r,s.targetId),await cc(r.localStore,s.targetId,!0))}async function qu(e,t){const n=Jt(e),r=n.Fa.get(t),s=n.Ma.get(r.targetId);n.isPrimaryClient&&1===s.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),zc(n.remoteStore,r.targetId))}async function zu(e,t){const n=Jt(e);try{const e=await ac(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Na.get(t);r&&(Xt(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.va=!0:e.modifiedDocuments.size>0?Xt(r.va):e.removedDocuments.size>0&&(Xt(r.va),r.va=!1))})),await rh(n,e,t)}catch(r){await Dn(r)}}function Ku(e,t,n){const r=Jt(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Fa.forEach(((n,r)=>{const s=r.view.Z_(t);s.snapshot&&e.push(s.snapshot)})),function(e,t){const n=Jt(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const s of n.j_)s.Z_(t)&&(r=!0)})),r&&Au(n)}(r.eventManager,t),e.length&&r.Ca.d_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Hu(e,t,n){const r=Jt(e);r.sharedClientState.updateQueryState(t,"rejected",n);const s=r.Na.get(t),i=s&&s.key;if(i){let e=new jr(xn.comparator);e=e.insert(i,xs.newNoDocument(i,gn.min()));const n=Ei().add(i),s=new wa(gn.min(),new Map,new jr(dn),e,n);await zu(r,s),r.Oa=r.Oa.remove(i),r.Na.delete(t),nh(r)}else await cc(r.localStore,t,!1).then((()=>Yu(r,t,n))).catch(Dn)}async function Wu(e,t){const n=Jt(e),r=t.batch.batchId;try{const e=await function(e,t){const n=Jt(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const s=n.batch,i=s.keys();let a=Pn.resolve();return i.forEach((e=>{a=a.next((()=>r.getEntry(t,e))).next((t=>{const i=n.docVersions.get(e);Xt(null!==i),t.version.compareTo(i)<0&&(s.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),a.next((()=>e.mutationQueue.removeMutationBatch(t,s)))}(n,e,t,s).next((()=>s.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Ei();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);Ju(n,r,null),Xu(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await rh(n,e)}catch(s){await Dn(s)}}async function Qu(e,t,n){const r=Jt(e);try{const e=await function(e,t){const n=Jt(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(Xt(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);Ju(r,t,n),Xu(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await rh(r,e)}catch(s){await Dn(s)}}function Xu(e,t){(e.ka.get(t)||[]).forEach((e=>{e.resolve()})),e.ka.delete(t)}function Ju(e,t,n){const r=Jt(e);let s=r.Ba[r.currentUser.toKey()];if(s){const e=s.get(t);e&&(n?e.reject(n):e.resolve(),s=s.remove(t)),r.Ba[r.currentUser.toKey()]=s}}function Yu(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Ma.get(t))e.Fa.delete(r),n&&e.Ca.$a(r,n);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach((t=>{e.La.containsKey(t)||Zu(e,t)}))}function Zu(e,t){e.xa.delete(t.path.canonicalString());const n=e.Oa.get(t);null!==n&&(zc(e.remoteStore,n),e.Oa=e.Oa.remove(t),e.Na.delete(n),nh(e))}function eh(e,t,n){for(const r of n)r instanceof Du?(e.La.addReference(r.key,t),th(e,r)):r instanceof Pu?(zt("SyncEngine","Document no longer in limbo: "+r.key),e.La.removeReference(r.key,t),e.La.containsKey(r.key)||Zu(e,r.key)):Qt()}function th(e,t){const n=t.key,r=n.path.canonicalString();e.Oa.get(n)||e.xa.has(r)||(zt("SyncEngine","New document in limbo: "+n),e.xa.add(r),nh(e))}function nh(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const n=new xn(vn.fromString(t)),r=e.qa.next();e.Na.set(r,new Lu(n)),e.Oa=e.Oa.insert(n,r),qc(e.remoteStore,new oo(ai(ni(n.path)),r,"TargetPurposeLimboResolution",Hn.oe))}}async function rh(e,t,n){const r=Jt(e),s=[],i=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach(((e,o)=>{a.push(r.Ka(o,t,n).then((e=>{var t;if((e||n)&&r.isPrimaryClient){const s=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(o.targetId,s?"current":"not-current")}if(e){s.push(e);const t=Zl.Wi(o.targetId,e);i.push(t)}})))})),await Promise.all(a),r.Ca.d_(s),await async function(e,t){const n=Jt(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>Pn.forEach(t,(t=>Pn.forEach(t.$i,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>Pn.forEach(t.Ui,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(r){if(!Vn(r))throw r;zt("LocalStore","Failed to update sequence numbers: "+r)}for(const s of t){const e=s.targetId;if(!s.fromCache){const t=n.os.get(e),r=t.snapshotVersion,s=t.withLastLimboFreeSnapshotVersion(r);n.os=n.os.insert(e,s)}}}(r.localStore,i))}async function sh(e,t){const n=Jt(e);if(!n.currentUser.isEqual(t)){zt("SyncEngine","User change. New user:",t.toKey());const e=await sc(n.localStore,t);n.currentUser=t,s="'waitForPendingWrites' promise is rejected due to a user change.",(r=n).ka.forEach((e=>{e.forEach((e=>{e.reject(new Zt(Yt.CANCELLED,s))}))})),r.ka.clear(),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await rh(n,e.hs)}var r,s}function ih(e,t){const n=Jt(e),r=n.Na.get(t);if(r&&r.va)return Ei().add(r.key);{let e=Ei();const r=n.Ma.get(t);if(!r)return e;for(const t of r){const r=n.Fa.get(t);e=e.unionWith(r.view.Va)}return e}}async function ah(e,t){const n=Jt(e),r=await uc(n.localStore,t.query,!0),s=t.view.ba(r);return n.isPrimaryClient&&eh(n,t.targetId,s.wa),s}async function oh(e,t){const n=Jt(e);return dc(n.localStore,t).then((e=>rh(n,e)))}async function lh(e,t,n,r){const s=Jt(e),i=await function(e,t){const n=Jt(e),r=Jt(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",(e=>r.Mn(e,t).next((t=>t?n.localDocuments.getDocuments(e,t):Pn.resolve(null)))))}(s.localStore,t);var a,o;null!==i?("pending"===n?await su(s.remoteStore):"acknowledged"===n||"rejected"===n?(Ju(s,t,r||null),Xu(s,t),a=s.localStore,o=t,Jt(Jt(a).mutationQueue).On(o)):Qt(),await rh(s,i)):zt("SyncEngine","Cannot apply mutation batch with id: "+t)}async function ch(e,t,n){const r=Jt(e),s=[],i=[];for(const a of t){let e;const t=r.Ma.get(a);if(t&&0!==t.length){e=await lc(r.localStore,ai(t[0]));for(const e of t){const t=r.Fa.get(e),n=await ah(r,t);n.snapshot&&i.push(n.snapshot)}}else{const t=await hc(r.localStore,a);e=await lc(r.localStore,t),await $u(r,uh(t),a,!1,e.resumeToken)}s.push(e)}return r.Ca.d_(i),s}function uh(e){return ti(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function hh(e){return t=Jt(e).localStore,Jt(Jt(t).persistence).Qi();var t}async function dh(e,t,n,r){const s=Jt(e);if(s.Qa)return void zt("SyncEngine","Ignoring unexpected query state notification.");const i=s.Ma.get(t);if(i&&i.length>0)switch(n){case"current":case"not-current":{const e=await dc(s.localStore,mi(i[0])),r=wa.createSynthesizedRemoteEventForCurrentChange(t,"current"===n,Fr.EMPTY_BYTE_STRING);await rh(s,e,r);break}case"rejected":await cc(s.localStore,t,!0),Yu(s,t,r);break;default:Qt()}}async function mh(e,t,n){const r=fh(e);if(r.Qa){for(const e of t){if(r.Ma.has(e)&&r.sharedClientState.isActiveQueryTarget(e)){zt("SyncEngine","Adding an already active target "+e);continue}const t=await hc(r.localStore,e),n=await lc(r.localStore,t);await $u(r,uh(t),n.targetId,!1,n.resumeToken),qc(r.remoteStore,n)}for(const e of n)r.Ma.has(e)&&await cc(r.localStore,e,!1).then((()=>{zc(r.remoteStore,e),Yu(r,e)})).catch(Dn)}}function fh(e){const t=Jt(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=zu.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=ih.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Hu.bind(null,t),t.Ca.d_=Eu.bind(null,t.eventManager),t.Ca.$a=Nu.bind(null,t.eventManager),t}function ph(e){const t=Jt(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Wu.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Qu.bind(null,t),t}class gh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Pc(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return rc(this.persistence,new tc,e.initialUser,this.serializer)}Ga(e){return new Gl(zl.Zr,this.serializer)}Wa(e){return new Ic}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}gh.provider={build:()=>new gh};class yh extends gh{constructor(e,t,n){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await ph(this.Ja.syncEngine),await su(this.Ja.remoteStore),await this.persistence.yi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}za(e){return rc(this.persistence,new tc,e.initialUser,this.serializer)}ja(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new wl(n,e.asyncQueue,t)}Ha(e,t){const n=new Kn(t,this.persistence);return new zn(e.asyncQueue,n)}Ga(e){const t=Yl(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?sl.withCacheSize(this.cacheSizeBytes):sl.DEFAULT;return new Ql(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,Rc(),Dc(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new Ic}}class vh extends yh{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Ja.syncEngine;this.sharedClientState instanceof _c&&(this.sharedClientState.syncEngine={no:lh.bind(null,t),ro:dh.bind(null,t),io:mh.bind(null,t),Qi:hh.bind(null,t),eo:oh.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi((async e=>{await async function(e,t){const n=Jt(e);if(fh(n),ph(n),!0===t&&!0!==n.Qa){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await ch(n,e.toArray());n.Qa=!0,await fu(n.remoteStore,!0);for(const r of t)qc(n.remoteStore,r)}else if(!1===t&&!1!==n.Qa){const e=[];let t=Promise.resolve();n.Ma.forEach(((r,s)=>{n.sharedClientState.isLocalQueryTarget(s)?e.push(s):t=t.then((()=>(Yu(n,s),cc(n.localStore,s,!0)))),zc(n.remoteStore,s)})),await t,await ch(n,e),function(e){const t=Jt(e);t.Na.forEach(((e,n)=>{zc(t.remoteStore,n)})),t.La.pr(),t.Na=new Map,t.Oa=new jr(xn.comparator)}(n),n.Qa=!1,await fu(n.remoteStore,!1)}}(this.Ja.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())}))}Wa(e){const t=Rc();if(!_c.D(t))throw new Zt(Yt.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=Yl(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new _c(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class wh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Ku(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=sh.bind(null,this.syncEngine),await fu(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Iu}createDatastore(e){const t=Pc(e.databaseInfo.databaseId),n=(r=e.databaseInfo,new jc(r));var r;return function(e,t,n,r){return new Fc(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,s=e=>Ku(this.syncEngine,e,0),i=Sc.D()?new Sc:new kc,new Bc(t,n,r,s,i);var t,n,r,s,i}createSyncEngine(e,t){return function(e,t,n,r,s,i,a){const o=new Uu(e,t,n,r,s,i);return a&&(o.Qa=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=Jt(e);zt("RemoteStore","RemoteStore shutting down."),t.L_.add(5),await Gc(t),t.k_.shutdown(),t.q_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}wh.provider={build:()=>new wh};
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class bh{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Kt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh{constructor(e,t,n,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Bt.UNAUTHENTICATED,this.clientId=hn.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,(async e=>{zt("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(zt("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new en;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=vu(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function _h(e,t){e.asyncQueue.verifyOperationInProgress(),zt("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await sc(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function Ih(e,t){e.asyncQueue.verifyOperationInProgress();const n=await async function(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){zt("FirestoreClient","Using user provided OfflineComponentProvider");try{await _h(e,e._uninitializedComponentsProvider._offline)}catch(t){const s=t;if(!("FirebaseError"===(n=s).name?n.code===Yt.FAILED_PRECONDITION||n.code===Yt.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code))throw s;Ht("Error using user provided cache. Falling back to memory cache: "+s),await _h(e,new gh)}}else zt("FirestoreClient","Using default OfflineComponentProvider"),await _h(e,new gh);var n;return e._offlineComponents}(e);zt("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>mu(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>mu(t.remoteStore,n))),e._onlineComponents=t}async function kh(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(zt("FirestoreClient","Using user provided OnlineComponentProvider"),await Ih(e,e._uninitializedComponentsProvider._online)):(zt("FirestoreClient","Using default OnlineComponentProvider"),await Ih(e,new wh))),e._onlineComponents}async function Sh(e){const t=await kh(e),n=t.eventManager;return n.onListen=Fu.bind(null,t.syncEngine),n.onUnlisten=Gu.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Vu.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=qu.bind(null,t.syncEngine),n}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Th(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}const Eh=new Map;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nh(e,t,n){if(!n)throw new Zt(Yt.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Ah(e){if(!xn.isDocumentKey(e))throw new Zt(Yt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Ch(e){if(xn.isDocumentKey(e))throw new Zt(Yt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function jh(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const n=(t=e).constructor?t.constructor.name:null;return n?`a custom ${n} object`:"an object"}}var t;return"function"==typeof e?"a function":Qt()}function Rh(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Zt(Yt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=jh(e);throw new Zt(Yt.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Dh{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Zt(Yt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Zt(Yt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new Zt(Yt.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Th(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Zt(Yt.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Zt(Yt.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Zt(Yt.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,t.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,n}}class Ph{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Dh({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Zt(Yt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Zt(Yt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Dh(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new nn;switch(e.type){case"firstParty":return new on(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Zt(Yt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Eh.get(e);t&&(zt("ComponentProvider","Removing Datastore"),Eh.delete(e),t.terminate())}(this),Promise.resolve()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Oh{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Oh(this.firestore,e,this._query)}}class Mh{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Lh(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Mh(this.firestore,e,this._key)}}class Lh extends Oh{constructor(e,t,n){super(e,t,ni(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Mh(this.firestore,null,new xn(e))}withConverter(e){return new Lh(this.firestore,e,this._path)}}function Uh(e,t,...n){if(e=Z(e),Nh("collection","path",t),e instanceof Ph){const r=vn.fromString(t,...n);return Ch(r),new Lh(e,null,r)}{if(!(e instanceof Mh||e instanceof Lh))throw new Zt(Yt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(vn.fromString(t,...n));return Ch(r),new Lh(e.firestore,null,r)}}function Fh(e,t,...n){if(e=Z(e),1===arguments.length&&(t=hn.newId()),Nh("doc","path",t),e instanceof Ph){const r=vn.fromString(t,...n);return Ah(r),new Mh(e,null,new xn(r))}{if(!(e instanceof Mh||e instanceof Lh))throw new Zt(Yt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(vn.fromString(t,...n));return Ah(r),new Mh(e.firestore,e instanceof Lh?e.converter:null,new xn(r))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Oc(this,"async_queue_retry"),this.Vu=()=>{const e=Dc();e&&zt("AsyncQueue","Visibility state changed to "+e.visibilityState),this.t_.jo()},this.mu=e;const t=Dc();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Dc();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise((()=>{}));const t=new en;return this.gu((()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Pu.push(e),this.pu())))}async pu(){if(0!==this.Pu.length){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Vn(e))throw e;zt("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go((()=>this.pu()))}}gu(e){const t=this.mu.then((()=>(this.du=!0,e().catch((e=>{this.Eu=e,this.du=!1;throw Kt("INTERNAL UNHANDLED ERROR: ",function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e)),e})).then((e=>(this.du=!1,e))))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const r=yu.createAndSchedule(this,e,t,n,(e=>this.yu(e)));return this.Tu.push(r),r}fu(){this.Eu&&Qt()}verifyOperationInProgress(){}async wu(){let e;do{e=this.mu,await e}while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then((()=>{this.Tu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.Tu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.wu()}))}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function Bh(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class $h extends Ph{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Vh,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Vh(e),this._firestoreClient=void 0,await e}}}function Gh(e){if(e._terminated)throw new Zt(Yt.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||qh(e),e._firestoreClient}function qh(e){var t,n,r;const s=e._freezeSettings(),i=(a=e._databaseId,o=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",l=e._persistenceKey,new Hr(a,o,l,(c=s).host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,Th(c.experimentalLongPollingOptions),c.useFetchStreams));var a,o,l,c;e._componentsProvider||(null===(n=s.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=s.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),e._firestoreClient=new xh(e._authCredentials,e._appCheckCredentials,e._queue,i,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class zh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new zh(Fr.fromBase64String(e))}catch(t){throw new Zt(Yt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new zh(Fr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Zt(Yt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(e){this._methodName=e}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Zt(Yt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Zt(Yt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return dn(this._lat,e._lat)||dn(this._long,e._long)}}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xh=/^__.*__$/;class Jh{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new ta(e,this.data,this.fieldMask,t,this.fieldTransforms):new ea(e,this.data,t,this.fieldTransforms)}}class Yh{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new ta(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Zh(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Qt()}}class ed{constructor(e,t,n,r,s,i){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===s&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new ed(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.Ou(e),r}Nu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return md(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(0===e.length)throw this.Bu("Document fields must not be empty");if(Zh(this.Cu)&&Xh.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class td{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Pc(e)}Qu(e,t,n,r=!1){return new ed({Cu:e,methodName:t,qu:n,path:bn.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function nd(e){const t=e._freezeSettings(),n=Pc(e._databaseId);return new td(e._databaseId,!!t.ignoreUndefinedProperties,n)}function rd(e,t,n,r,s,i={}){const a=e.Qu(i.merge||i.mergeFields?2:0,t,n,s);cd("Data must be an object, but it was:",a,r);const o=od(r,a);let l,c;if(i.merge)l=new Lr(a.fieldMask),c=a.fieldTransforms;else if(i.mergeFields){const e=[];for(const r of i.mergeFields){const s=ud(t,r,n);if(!a.contains(s))throw new Zt(Yt.INVALID_ARGUMENT,`Field '${s}' is specified in your field mask but missing from your input data.`);fd(e,s)||e.push(s)}l=new Lr(e),c=a.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,c=a.fieldTransforms;return new Jh(new ws(o),l,c)}class sd extends Hh{_toFieldTransform(e){if(2!==e.Cu)throw 1===e.Cu?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof sd}}class id extends Hh{_toFieldTransform(e){return new qi(e.path,new Mi)}isEqual(e){return e instanceof id}}function ad(e,t){if(ld(e=Z(e)))return cd("Unsupported field value:",t,e),od(e,t);if(e instanceof Hh)return function(e,t){if(!Zh(t.Cu))throw t.Bu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Bu(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&4!==t.Cu)throw t.Bu("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const s of e){let e=ad(s,t.Lu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Z(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return function(e,t){return Xn(t)?ji(t):Ci(e,t)}(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=pn.fromDate(e);return{timestampValue:Da(t.serializer,n)}}if(e instanceof pn){const n=new pn(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Da(t.serializer,n)}}if(e instanceof Wh)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof zh)return{bytesValue:Pa(t.serializer,e._byteString)};if(e instanceof Mh){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Bu(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:La(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Qh)return n=t,{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:e.toArray().map((e=>{if("number"!=typeof e)throw n.Bu("VectorValues must only contain numeric values.");return Ci(n.serializer,e)}))}}}}};var n;throw t.Bu(`Unsupported field value: ${jh(e)}`)}(e,t)}function od(e,t){const n={};return Cr(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Ar(e,((e,r)=>{const s=ad(r,t.Mu(e));null!=s&&(n[e]=s)})),{mapValue:{fields:n}}}function ld(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof pn||e instanceof Wh||e instanceof zh||e instanceof Mh||e instanceof Hh||e instanceof Qh)}function cd(e,t,n){if(!ld(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){const r=jh(n);throw"an object"===r?t.Bu(e+" a custom object"):t.Bu(e+" "+r)}var r}function ud(e,t,n){if((t=Z(t))instanceof Kh)return t._internalPath;if("string"==typeof t)return dd(e,t);throw md("Field path arguments must be of type string or ",e,!1,void 0,n)}const hd=new RegExp("[~\\*/\\[\\]]");function dd(e,t,n){if(t.search(hd)>=0)throw md(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Kh(...t.split("."))._internalPath}catch(r){throw md(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function md(e,t,n,r,s){const i=r&&!r.isEmpty(),a=void 0!==s;let o=`Function ${t}() called with invalid data`;n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${r}`),a&&(l+=` in document ${s}`),l+=")"),new Zt(Yt.INVALID_ARGUMENT,o+e+l)}function fd(e,t){return e.some((e=>e.isEqual(t)))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(e,t,n,r,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Mh(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new gd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(yd("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class gd extends pd{data(){return super.data()}}function yd(e,t){return"string"==typeof t?dd(e,t):t instanceof Kh?t._internalPath:t._delegate._internalPath}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vd(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Zt(Yt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class wd{}class bd extends wd{}function xd(e,t,...n){let r=[];t instanceof wd&&r.push(t),r=r.concat(n),function(e){const t=e.filter((e=>e instanceof kd)).length,n=e.filter((e=>e instanceof _d)).length;if(t>1||t>0&&n>0)throw new Zt(Yt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)e=s._apply(e);return e}class _d extends bd{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new _d(e,t,n)}_apply(e){const t=this._parse(e);return jd(e._query,t),new Oh(e.firestore,e.converter,oi(e._query,t))}_parse(e){const t=nd(e.firestore),n=function(e,t,n,r,s,i,a){let o;if(s.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new Zt(Yt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${i}' queries on documentId().`);if("in"===i||"not-in"===i){Cd(a,i);const t=[];for(const n of a)t.push(Ad(r,e,n));o={arrayValue:{values:t}}}else o=Ad(r,e,a)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Cd(a,i),o=function(e,t,n,r=!1){return ad(n,e.Qu(r?4:3,t))}(n,t,a,"in"===i||"not-in"===i);return Ns.create(s,i,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function Id(e,t,n){const r=t,s=yd("where",e);return _d._create(s,r,n)}class kd extends wd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new kd(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:As.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const s of r)jd(n,s),n=oi(n,s)}(e._query,t),new Oh(e.firestore,e.converter,oi(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Sd extends bd{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Sd(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Zt(Yt.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Zt(Yt.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ss(t,n)}(e._query,this._field,this._direction);return new Oh(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new ei(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function Td(e,t="asc"){const n=t,r=yd("orderBy",e);return Sd._create(r,n)}class Ed extends bd{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Ed(e,t,n)}_apply(e){return new Oh(e.firestore,e.converter,li(e._query,this._limit,this._limitType))}}function Nd(e){return function(e,t){if(t<=0)throw new Zt(Yt.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}("limit",e),Ed._create("limit",e,"F")}function Ad(e,t,n){if("string"==typeof(n=Z(n))){if(""===n)throw new Zt(Yt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!si(t)&&-1!==n.indexOf("/"))throw new Zt(Yt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(vn.fromString(n));if(!xn.isDocumentKey(r))throw new Zt(Yt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return is(e,new xn(r))}if(n instanceof Mh)return is(e,n._key);throw new Zt(Yt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${jh(n)}.`)}function Cd(e,t){if(!Array.isArray(e)||0===e.length)throw new Zt(Yt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function jd(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Zt(Yt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Zt(Yt.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class Rd{convertValue(e,t="none"){switch(Jr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $r(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Gr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Qt()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Ar(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertVectorValue(e){var t,n,r;const s=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t.value.arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map((e=>$r(e.doubleValue)));return new Qh(s)}convertGeoPoint(e){return new Wh($r(e.latitude),$r(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=zr(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Kr(e));default:return null}}convertTimestamp(e){const t=Br(e);return new pn(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=vn.fromString(e);Xt(ao(n));const r=new Wr(n.get(1),n.get(3)),s=new xn(n.popFirst(5));return r.isEqual(t)||Kt(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dd(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class Pd{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Od extends pd{constructor(e,t,n,r,s,i){super(e,t,n,r,i),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Md(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(yd("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Md extends Od{data(e={}){return super.data(e)}}class Ld{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Pd(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Md(this._firestore,this._userDataWriter,n.key,n,new Pd(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Zt(Yt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new Md(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Pd(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new Md(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Pd(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let s=-1,i=-1;return 0!==t.type&&(s=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),i=n.indexOf(t.doc.key)),{type:Ud(t.type),doc:r,oldIndex:s,newIndex:i}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Ud(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Qt()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fd(e){e=Rh(e,Mh);const t=Rh(e.firestore,$h);return function(e,t,n={}){const r=new en;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,s){const i=new bh({next:o=>{i.Za(),t.enqueueAndForget((()=>Tu(e,a)));const l=o.docs.has(n);!l&&o.fromCache?s.reject(new Zt(Yt.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&r&&"server"===r.source?s.reject(new Zt(Yt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(o)},error:e=>s.reject(e)}),a=new Ru(ni(n.path),i,{includeMetadataChanges:!0,_a:!0});return Su(e,a)}(await Sh(e),e.asyncQueue,t,n,r))),r.promise}(Gh(t),e._key).then((n=>Kd(t,e,n)))}class Vd extends Rd{constructor(e){super(),this.firestore=e}convertBytes(e){return new zh(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Mh(this.firestore,null,t)}}function Bd(e){e=Rh(e,Oh);const t=Rh(e.firestore,$h),n=Gh(t),r=new Vd(t);return vd(e._query),function(e,t,n={}){const r=new en;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,s){const i=new bh({next:n=>{i.Za(),t.enqueueAndForget((()=>Tu(e,a))),n.fromCache&&"server"===r.source?s.reject(new Zt(Yt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):s.resolve(n)},error:e=>s.reject(e)}),a=new Ru(n,i,{includeMetadataChanges:!0,_a:!0});return Su(e,a)}(await Sh(e),e.asyncQueue,t,n,r))),r.promise}(n,e._query).then((n=>new Ld(t,r,e,n)))}function $d(e,t,n){e=Rh(e,Mh);const r=Rh(e.firestore,$h),s=Dd(e.converter,t,n);return zd(r,[rd(nd(r),"setDoc",e._key,s,null!==e.converter,n).toMutation(e._key,Ki.none())])}function Gd(e,t,n,...r){e=Rh(e,Mh);const s=Rh(e.firestore,$h),i=nd(s);let a;return a="string"==typeof(t=Z(t))||t instanceof Kh?function(e,t,n,r,s,i){const a=e.Qu(1,t,n),o=[ud(t,r,n)],l=[s];if(i.length%2!=0)throw new Zt(Yt.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<i.length;d+=2)o.push(ud(t,i[d])),l.push(i[d+1]);const c=[],u=ws.empty();for(let d=o.length-1;d>=0;--d)if(!fd(c,o[d])){const e=o[d];let t=l[d];t=Z(t);const n=a.Nu(e);if(t instanceof sd)c.push(e);else{const r=ad(t,n);null!=r&&(c.push(e),u.set(e,r))}}const h=new Lr(c);return new Yh(u,h,a.fieldTransforms)}(i,"updateDoc",e._key,t,n,r):function(e,t,n,r){const s=e.Qu(1,t,n);cd("Data must be an object, but it was:",s,r);const i=[],a=ws.empty();Ar(r,((e,r)=>{const o=dd(t,e,n);r=Z(r);const l=s.Nu(o);if(r instanceof sd)i.push(o);else{const e=ad(r,l);null!=e&&(i.push(o),a.set(o,e))}}));const o=new Lr(i);return new Yh(a,o,s.fieldTransforms)}(i,"updateDoc",e._key,t),zd(s,[a.toMutation(e._key,Ki.exists(!0))])}function qd(e,...t){var n,r,s;e=Z(e);let i={includeMetadataChanges:!1,source:"default"},a=0;"object"!=typeof t[a]||Bh(t[a])||(i=t[a],a++);const o={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Bh(t[a])){const e=t[a];t[a]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[a+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[a+2]=null===(s=e.complete)||void 0===s?void 0:s.bind(e)}let l,c,u;if(e instanceof Mh)c=Rh(e.firestore,$h),u=ni(e._key.path),l={next:n=>{t[a]&&t[a](Kd(c,e,n))},error:t[a+1],complete:t[a+2]};else{const n=Rh(e,Oh);c=Rh(n.firestore,$h),u=n._query;const r=new Vd(c);l={next:e=>{t[a]&&t[a](new Ld(c,r,n,e))},error:t[a+1],complete:t[a+2]},vd(e._query)}return function(e,t,n,r){const s=new bh(r),i=new Ru(t,s,n);return e.asyncQueue.enqueueAndForget((async()=>Su(await Sh(e),i))),()=>{s.Za(),e.asyncQueue.enqueueAndForget((async()=>Tu(await Sh(e),i)))}}(Gh(c),u,o,l)}function zd(e,t){return function(e,t){const n=new en;return e.asyncQueue.enqueueAndForget((async()=>async function(t,n,r){const s=ph(t);try{const e=await function(e,t){const n=Jt(e),r=pn.now(),s=t.reduce(((e,t)=>e.add(t.key)),Ei());let i,a;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let o=vi(),l=Ei();return n.cs.getEntries(e,s).next((e=>{o=e,o.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,o))).next((s=>{i=s;const a=[];for(const e of t){const t=Yi(e,i.get(e.key).overlayedDocument);null!=t&&a.push(new ta(e.key,t,bs(t.value.mapValue),Ki.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,a,t)})).next((t=>{a=t;const r=t.applyToLocalDocumentSet(i,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:a.batchId,changes:xi(i)})))}(s.localStore,n);s.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Ba[e.currentUser.toKey()];r||(r=new jr(dn)),r=r.insert(t,n),e.Ba[e.currentUser.toKey()]=r}(s,e.batchId,r),await rh(s,e.changes),await su(s.remoteStore)}catch(e){const n=vu(e,"Failed to persist write");r.reject(n)}}(await function(e){return kh(e).then((e=>e.syncEngine))}(e),t,n))),n.promise}(Gh(e),t)}function Kd(e,t,n){const r=n.docs.get(t._key),s=new Vd(e);return new Od(e,s,t._key,r,new Pd(n.hasPendingWrites,n.fromCache),t.converter)}function Hd(){return new id("serverTimestamp")}!function(e,t=!0){$t=ft,ct(new ee("firestore",((e,{instanceIdentifier:n,options:r})=>{const s=e.getProvider("app").getImmediate(),i=new $h(new sn(e.getProvider("auth-internal")),new cn(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Zt(Yt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Wr(e.options.projectId,t)}(s,n),s);return r=Object.assign({useFetchStreams:t},r),i._setSettings(r),i}),"PUBLIC").setMultipleInstances(!0)),yt(Vt,"4.7.3",e),yt(Vt,"4.7.3","esm2017")}();function Wd(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]])}return n}function Qd(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
yt("firebase","10.14.1","app"),"function"==typeof SuppressedError&&SuppressedError;const Xd=Qd,Jd=new K("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Yd=new ue("@firebase/auth");function Zd(e,...t){Yd.logLevel<=se.ERROR&&Yd.error(`Auth (${ft}): ${e}`,...t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function em(e,...t){throw sm(e,...t)}function tm(e,...t){return sm(e,...t)}function nm(e,t,n){const r=Object.assign(Object.assign({},Xd()),{[t]:n});return new K("auth","Firebase",r).create(t,{appName:e.name})}function rm(e){return nm(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function sm(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return Jd.create(e,...t)}function im(e,t,...n){if(!e)throw sm(t,...n)}function am(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Zd(t),new Error(t)}function om(e,t){e||am(t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lm(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function cm(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function um(){return"undefined"==typeof navigator||!navigator||!("onLine"in navigator)||"boolean"!=typeof navigator.onLine||"http:"!==cm()&&"https:"!==cm()&&!function(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}()&&!("connection"in navigator)||navigator.onLine}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class hm{constructor(e,t){this.shortDelay=e,this.longDelay=t,om(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return um()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dm(e,t){om(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mm{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void am("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void am("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void am("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fm={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},pm=new hm(3e4,6e4);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gm(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function ym(e,t,n,r,s={}){return vm(e,s,(async()=>{let s={},i={};r&&("GET"===t?i=r:s={body:JSON.stringify(r)});const a=X(Object.assign({key:e.config.apiKey},i)).slice(1),o=await e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:o},s);return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),mm.fetch()(wm(e,e.config.apiHost,n,a),l)}))}async function vm(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},fm),t);try{const t=new bm(e),s=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const i=await s.json();if("needConfirmation"in i)throw xm(e,"account-exists-with-different-credential",i);if(s.ok&&!("errorMessage"in i))return i;{const t=s.ok?i.errorMessage:i.error.message,[n,a]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw xm(e,"credential-already-in-use",i);if("EMAIL_EXISTS"===n)throw xm(e,"email-already-in-use",i);if("USER_DISABLED"===n)throw xm(e,"user-disabled",i);const o=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(a)throw nm(e,o,a);em(e,o)}}catch(s){if(s instanceof z)throw s;em(e,"network-request-failed",{message:String(s)})}}function wm(e,t,n,r){const s=`${t}${n}?${r}`;return e.config.emulator?dm(e.config,s):`${e.config.apiScheme}://${s}`}class bm{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(tm(this.auth,"network-request-failed"))),pm.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function xm(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=tm(e,t,r);return s.customData._tokenResponse=n,s}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _m(e,t){return ym(e,"POST","/v1/accounts:lookup",t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Im(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function km(e){return 1e3*Number(e)}function Sm(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Zd("JWT malformed, contained fewer than 3 sections"),null;try{const e=D(n);return e?JSON.parse(e):(Zd("Failed to decode base64 JWT payload"),null)}catch(s){return Zd("Caught error parsing JWT payload as JSON",null==s?void 0:s.toString()),null}}function Tm(e){const t=Sm(e);return im(t,"internal-error"),im(void 0!==t.exp,"internal-error"),im(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Em(e,t,n=!1){if(n)return t;try{return await t}catch(r){throw r instanceof z&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(r)&&e.auth.currentUser===e&&await e.auth.signOut(),r}}class Nm{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Im(this.lastLoginAt),this.creationTime=Im(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cm(e){var t;const n=e.auth,r=await e.getIdToken(),s=await Em(e,_m(n,{idToken:r}));im(null==s?void 0:s.users.length,n,"internal-error");const i=s.users[0];e._notifyReloadListener(i);const a=(null===(t=i.providerUserInfo)||void 0===t?void 0:t.length)?jm(i.providerUserInfo):[],o=(l=e.providerData,c=a,[...l.filter((e=>!c.some((t=>t.providerId===e.providerId)))),...c]);var l,c;const u=e.isAnonymous,h=!(e.email&&i.passwordHash||(null==o?void 0:o.length)),d=!!u&&h,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Am(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(e,m)}function jm(e){return e.map((e=>{var{providerId:t}=e,n=Wd(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Rm{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){im(e.idToken,"internal-error"),im(void 0!==e.idToken,"internal-error"),im(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):Tm(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){im(0!==e.length,"internal-error");const t=Tm(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(im(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:s}=await async function(e,t){const n=await vm(e,{},(async()=>{const n=X({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:s}=e.config,i=wm(e,r,"/v1/token",`key=${s}`),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",mm.fetch()(i,{method:"POST",headers:a,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:s}=t,i=new Rm;return n&&(im("string"==typeof n,"internal-error",{appName:e}),i.refreshToken=n),r&&(im("string"==typeof r,"internal-error",{appName:e}),i.accessToken=r),s&&(im("number"==typeof s,"internal-error",{appName:e}),i.expirationTime=s),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Rm,this.toJSON())}_performRefresh(){return am("not implemented")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dm(e,t){im("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Pm{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,s=Wd(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Nm(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Am(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Em(this,this.stsTokenManager.getToken(this.auth,e));return im(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=Z(e),r=await n.getIdToken(t),s=Sm(r);im(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i="object"==typeof s.firebase?s.firebase:void 0,a=null==i?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Im(km(s.auth_time)),issuedAtTime:Im(km(s.iat)),expirationTime:Im(km(s.exp)),signInProvider:a||null,signInSecondFactor:(null==i?void 0:i.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Z(e);await Cm(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(im(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Pm(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){im(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Cm(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ht(this.auth.app))return Promise.reject(rm(this.auth));const e=await this.getIdToken();return await Em(this,async function(e,t){return ym(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,s,i,a,o,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(s=t.phoneNumber)&&void 0!==s?s:void 0,m=null!==(i=t.photoURL)&&void 0!==i?i:void 0,f=null!==(a=t.tenantId)&&void 0!==a?a:void 0,p=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,y=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:v,emailVerified:w,isAnonymous:b,providerData:x,stsTokenManager:_}=t;im(v&&_,e,"internal-error");const I=Rm.fromJSON(this.name,_);im("string"==typeof v,e,"internal-error"),Dm(u,e.name),Dm(h,e.name),im("boolean"==typeof w,e,"internal-error"),im("boolean"==typeof b,e,"internal-error"),Dm(d,e.name),Dm(m,e.name),Dm(f,e.name),Dm(p,e.name),Dm(g,e.name),Dm(y,e.name);const k=new Pm({uid:v,auth:e,email:h,emailVerified:w,displayName:u,isAnonymous:b,photoURL:m,phoneNumber:d,tenantId:f,stsTokenManager:I,createdAt:g,lastLoginAt:y});return x&&Array.isArray(x)&&(k.providerData=x.map((e=>Object.assign({},e)))),p&&(k._redirectEventId=p),k}static async _fromIdTokenResponse(e,t,n=!1){const r=new Rm;r.updateFromServerResponse(t);const s=new Pm({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Cm(s),s}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];im(void 0!==r.localId,"internal-error");const s=void 0!==r.providerUserInfo?jm(r.providerUserInfo):[],i=!(r.email&&r.passwordHash||(null==s?void 0:s.length)),a=new Rm;a.updateFromIdToken(n);const o=new Pm({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:i}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Am(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash||(null==s?void 0:s.length))};return Object.assign(o,l),o}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Om=new Map;function Mm(e){om(e instanceof Function,"Expected a class definition");let t=Om.get(e);return t?(om(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Om.set(e,t),t)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lm{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Lm.type="NONE";const Um=Lm;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fm(e,t,n){return`firebase:${e}:${t}:${n}`}class Vm{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:s}=this.auth;this.fullUserKey=Fm(this.userKey,r.apiKey,s),this.fullPersistenceKey=Fm("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Pm._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Vm(Mm(Um),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let s=r[0]||Mm(Um);const i=Fm(n,e.config.apiKey,e.name);let a=null;for(const c of t)try{const t=await c._get(i);if(t){const n=Pm._fromJSON(e,t);c!==s&&(a=n),s=c;break}}catch(l){}const o=r.filter((e=>e._shouldAllowMigration));return s._shouldAllowMigration&&o.length?(s=o[0],a&&await s._set(i,a.toJSON()),await Promise.all(t.map((async e=>{if(e!==s)try{await e._remove(i)}catch(l){}}))),new Vm(s,e,n)):new Vm(s,e,n)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bm(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(zm(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if($m(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Hm(t))return"Blackberry";if(Wm(t))return"Webos";if(Gm(t))return"Safari";if((t.includes("chrome/")||qm(t))&&!t.includes("edge/"))return"Chrome";if(Km(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function $m(e=$()){return/firefox\//i.test(e)}function Gm(e=$()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function qm(e=$()){return/crios\//i.test(e)}function zm(e=$()){return/iemobile/i.test(e)}function Km(e=$()){return/android/i.test(e)}function Hm(e=$()){return/blackberry/i.test(e)}function Wm(e=$()){return/webos/i.test(e)}function Qm(e=$()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Xm(){return function(){const e=$();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function Jm(e=$()){return Qm(e)||Km(e)||Wm(e)||Hm(e)||/windows phone/i.test(e)||zm(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ym(e,t=[]){let n;switch(e){case"Browser":n=Bm($());break;case"Worker":n=`${Bm($())}-${e}`;break;default:n=e}const r=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${ft}/${r}`}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zm{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(s){r(s)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==n?void 0:n.message})}}}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(e){var t,n,r,s;const i=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=i.minPasswordLength)&&void 0!==t?t:6,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),void 0!==i.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),void 0!==i.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),void 0!==i.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),void 0!==i.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(s=e.forceUpgradeOnSignin)&&void 0!==s&&s,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,s,i,a;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(r=o.containsLowercaseLetter)||void 0===r||r),o.isValid&&(o.isValid=null===(s=o.containsUppercaseLetter)||void 0===s||s),o.isValid&&(o.isValid=null===(i=o.containsNumericCharacter)||void 0===i||i),o.isValid&&(o.isValid=null===(a=o.containsNonAlphanumericCharacter)||void 0===a||a),o}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new rf(this),this.idTokenSubscription=new rf(this),this.beforeStateQueue=new Zm(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Jd,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Mm(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await Vm.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(s){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void(await this.currentUser.getIdToken())):void(await this._updateCurrentUser(e,!0)):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await _m(this,{idToken:e}),n=await Pm._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(ht(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,i=null==r?void 0:r._redirectEventId,a=await this.tryRedirectSignIn(e);n&&n!==i||!(null==a?void 0:a.user)||(r=a.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(i)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return im(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Cm(e)}catch(t){if("auth/network-request-failed"!==(null==t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ht(this.app))return Promise.reject(rm(this));const t=e?Z(e):null;return t&&im(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&im(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return ht(this.app)?Promise.reject(rm(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ht(this.app)?Promise.reject(rm(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(Mm(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e,t={}){return ym(e,"GET","/v2/passwordPolicy",gm(e,t))}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(this),t=new ef(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new K("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return ym(e,"POST","/v2/accounts:revokeToken",gm(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Mm(e)||this._popupRedirectResolver;im(t,this,"argument-error"),this.redirectPersistenceManager=await Vm.create(this,[Mm(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const s="function"==typeof t?t:t.next.bind(t);let i=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(im(a,this,"internal-error"),a.then((()=>{i||s(this.currentUser)})),"function"==typeof t){const s=e.addObserver(t,n,r);return()=>{i=!0,s()}}{const n=e.addObserver(t);return()=>{i=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return im(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ym(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){Yd.logLevel<=se.WARN&&Yd.warn(`Auth (${ft}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function nf(e){return Z(e)}class rf{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new J(e,t);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return im(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function af(e,t,n){const r=nf(e);im(r._canInitEmulator,r,"emulator-config-failed"),im(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const s=!!(null==n?void 0:n.disableWarnings),i=of(t),{host:a,port:o}=function(e){const t=of(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const e=s[1];return{host:e,port:lf(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:lf(t)}}}(t),l=null===o?"":`:${o}`;r.config.emulator={url:`${i}//${a}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */()}function of(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function lf(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class cf{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return am("not implemented")}_getIdTokenResponse(e){return am("not implemented")}_linkToIdToken(e,t){return am("not implemented")}_getReauthenticationResolver(e){return am("not implemented")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uf(e,t){return async function(e,t,n,r,s={}){const i=await ym(e,t,n,r,s);return"mfaPendingCredential"in i&&em(e,"multi-factor-auth-required",{_serverResponse:i}),i}(e,"POST","/v1/accounts:signInWithIdp",gm(e,t))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf extends cf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new hf(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):em("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,s=Wd(t,["providerId","signInMethod"]);if(!n||!r)return null;const i=new hf(n,r);return i.idToken=s.idToken||void 0,i.accessToken=s.accessToken||void 0,i.secret=s.secret,i.nonce=s.nonce,i.pendingToken=s.pendingToken||null,i}_getIdTokenResponse(e){return uf(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,uf(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,uf(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=X(t)}return e}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf extends df{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff extends mf{constructor(){super("facebook.com")}static credential(e){return hf._fromParams({providerId:ff.PROVIDER_ID,signInMethod:ff.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ff.credentialFromTaggedObject(e)}static credentialFromError(e){return ff.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return ff.credential(e.oauthAccessToken)}catch(t){return null}}}ff.FACEBOOK_SIGN_IN_METHOD="facebook.com",ff.PROVIDER_ID="facebook.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class pf extends mf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return hf._fromParams({providerId:pf.PROVIDER_ID,signInMethod:pf.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return pf.credentialFromTaggedObject(e)}static credentialFromError(e){return pf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return pf.credential(t,n)}catch(r){return null}}}pf.GOOGLE_SIGN_IN_METHOD="google.com",pf.PROVIDER_ID="google.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class gf extends mf{constructor(){super("github.com")}static credential(e){return hf._fromParams({providerId:gf.PROVIDER_ID,signInMethod:gf.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return gf.credentialFromTaggedObject(e)}static credentialFromError(e){return gf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return gf.credential(e.oauthAccessToken)}catch(t){return null}}}gf.GITHUB_SIGN_IN_METHOD="github.com",gf.PROVIDER_ID="github.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class yf extends mf{constructor(){super("twitter.com")}static credential(e,t){return hf._fromParams({providerId:yf.PROVIDER_ID,signInMethod:yf.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return yf.credentialFromTaggedObject(e)}static credentialFromError(e){return yf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return yf.credential(t,n)}catch(r){return null}}}yf.TWITTER_SIGN_IN_METHOD="twitter.com",yf.PROVIDER_ID="twitter.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class vf{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const s=await Pm._fromIdTokenResponse(e,n,r),i=wf(n);return new vf({user:s,providerId:i,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=wf(n);return new vf({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function wf(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf extends z{constructor(e,t,n,r){var s;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,bf.prototype),this.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new bf(e,t,n,r)}}function xf(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw bf._fromErrorAndOperation(e,n,t,r);throw n}))}const _f="__sak";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(_f,"1"),this.storage.removeItem(_f),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf extends If{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Jm(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},s=this.storage.getItem(n);Xm()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}kf.type="LOCAL";const Sf=kf;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf extends If{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Tf.type="SESSION";const Ef=Tf;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Nf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Nf(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:s}=t.data,i=this.handlersMap[r];if(!(null==i?void 0:i.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const a=Array.from(i).map((async e=>e(t.origin,s))),o=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(a);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Af(e="",t=10){let n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Nf.receivers=[];class Cf{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,i;return new Promise(((a,o)=>{const l=Af("",20);r.port1.start();const c=setTimeout((()=>{o(new Error("unsupported_event"))}),n);i={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),s=setTimeout((()=>{o(new Error("timeout"))}),3e3);break;case"done":clearTimeout(s),a(t.data.response);break;default:clearTimeout(c),clearTimeout(s),o(new Error("invalid_response"))}}},this.handlers.add(i),r.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])})).finally((()=>{i&&this.removeMessageHandler(i)}))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jf(){return window}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Rf(){return void 0!==jf().WorkerGlobalScope&&"function"==typeof jf().importScripts}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Df="firebaseLocalStorageDb",Pf="firebaseLocalStorage",Of="fbase_key";class Mf{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Lf(e,t){return e.transaction([Pf],t?"readwrite":"readonly").objectStore(Pf)}function Uf(){const e=indexedDB.open(Df,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Pf,{keyPath:Of})}catch(r){n(r)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Pf)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Df);return new Mf(e).toPromise()}(),t(await Uf()))}))}))}async function Ff(e,t,n){const r=Lf(e,!0).put({[Of]:t,value:n});return new Mf(r).toPromise()}function Vf(e,t){const n=Lf(e,!0).delete(t);return new Mf(n).toPromise()}class Bf{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Uf()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Rf()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Nf._getInstance(Rf()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Cf(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Uf();return await Ff(e,_f,"1"),await Vf(e,_f),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Ff(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=Lf(e,!1).get(t),r=await new Mf(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Vf(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=Lf(e,!1).getAll();return new Mf(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:s}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Bf.type="LOCAL";const $f=Bf;new hm(3e4,6e4);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Gf extends cf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return uf(e,this._buildIdpRequest())}_linkToIdToken(e,t){return uf(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return uf(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function qf(e){
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
return async function(e,t,n=!1){if(ht(e.app))return Promise.reject(rm(e));const r="signIn",s=await xf(e,r,t),i=await vf._fromIdTokenResponse(e,r,s);return n||await e._updateCurrentUser(i.user),i}(e.auth,new Gf(e),e.bypassAuthState)}function zf(e){const{auth:t,user:n}=e;return im(n,t,"internal-error"),
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function(e,t,n=!1){const{auth:r}=e;if(ht(r.app))return Promise.reject(rm(r));const s="reauthenticate";try{const i=await Em(e,xf(r,s,t,e),n);im(i.idToken,r,"internal-error");const a=Sm(i.idToken);im(a,r,"internal-error");const{sub:o}=a;return im(e.uid===o,r,"user-mismatch"),vf._forOperation(e,s,i)}catch(i){throw"auth/user-not-found"===(null==i?void 0:i.code)&&em(r,"user-mismatch"),i}}(n,new Gf(e),e.bypassAuthState)}async function Kf(e){const{auth:t,user:n}=e;return im(n,t,"internal-error"),async function(e,t,n=!1){const r=await Em(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return vf._forOperation(e,"link",r)}(n,new Gf(e),e.bypassAuthState)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hf{constructor(e,t,n,r,s=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:s,error:i,type:a}=e;if(i)return void this.reject(i);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(o))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return qf;case"linkViaPopup":case"linkViaRedirect":return Kf;case"reauthViaPopup":case"reauthViaRedirect":return zf;default:em(this.auth,"internal-error")}}resolve(e){om(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){om(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wf=new hm(2e3,1e4);class Qf extends Hf{constructor(e,t,n,r,s){super(e,t,r,s),this.provider=n,this.authWindow=null,this.pollId=null,Qf.currentPopupAction&&Qf.currentPopupAction.cancel(),Qf.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return im(e,this.auth,"internal-error"),e}async onExecution(){om(1===this.filter.length,"Popup operations only handle one event");const e=Af();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(tm(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(tm(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Qf.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(tm(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,Wf.get())};e()}}Qf.currentPopupAction=null;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Xf="pendingRedirect",Jf=new Map;class Yf extends Hf{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Jf.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return Fm(Xf,e.config.apiKey,e.name)}(t),r=function(e){return Mm(e._redirectPersistence)}(e);if(!(await r._isAvailable()))return!1;const s="true"===await r._get(n);return await r._remove(n),s}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}Jf.set(this.auth._key(),e)}return this.bypassAuthState||Jf.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Zf(e,t){Jf.set(e._key(),t)}async function ep(e,t,n=!1){if(ht(e.app))return Promise.reject(rm(e));const r=nf(e),s=
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e,t){return t?Mm(t):(im(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(r,t),i=new Yf(r,s,n),a=await i.execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,t)),a}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return rp(e);default:return!1}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!rp(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(tm(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(np(e))}saveEventToCache(e){this.cachedEventUids.add(np(e)),this.lastProcessedEventTime=Date.now()}}function np(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function rp({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const sp=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ip=/^https?/;async function ap(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return ym(e,"GET","/v1/projects",t)}(e);for(const r of t)try{if(op(r))return}catch(n){}em(e,"unauthorized-domain")}function op(e){const t=lm(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const s=new URL(e);return""===s.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&s.hostname===r}if(!ip.test(n))return!1;if(sp.test(e))return r===e;const s=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lp=new hm(3e4,6e4);function cp(){const e=jf().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function up(e){return new Promise(((t,n)=>{var r,s,i,a;function o(){cp(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{cp(),n(tm(e,"network-request-failed"))},timeout:lp.get()})}if(null===(s=null===(r=jf().gapi)||void 0===r?void 0:r.iframes)||void 0===s?void 0:s.Iframe)t(gapi.iframes.getContext());else{if(!(null===(i=jf().gapi)||void 0===i?void 0:i.load)){const t=`__${"iframefcb"}${Math.floor(1e6*Math.random())}`;return jf()[t]=()=>{gapi.load?o():n(tm(e,"network-request-failed"))},(a=`${sf.gapiScript}?onload=${t}`,sf.loadJS(a)).catch((e=>n(e)))}o()}})).catch((e=>{throw hp=null,e}))}let hp=null;
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const dp=new hm(5e3,15e3),mp={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},fp=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function pp(e){const t=e.config;im(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?dm(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:ft},s=fp.get(e.config.apiHost);s&&(r.eid=s);const i=e._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${X(r).slice(1)}`}async function gp(e){const t=await function(e){return hp=hp||up(e),hp}(e),n=jf().gapi;return im(n,e,"internal-error"),t.open({where:document.body,url:pp(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:mp,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const s=tm(e,"network-request-failed"),i=jf().setTimeout((()=>{r(s)}),dp.get());function a(){jf().clearTimeout(i),n(t)}t.ping(a).then(a,(()=>{r(s)}))}))))}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yp={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class vp{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function wp(e,t,n,r=500,s=600){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l=Object.assign(Object.assign({},yp),{width:r.toString(),height:s.toString(),top:i,left:a}),c=$().toLowerCase();n&&(o=qm(c)?"_blank":n),$m(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=$()){var t;return Qm(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(c)&&"_self"!==o)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t||"",o),new vp(null);const h=window.open(t||"",o,u);im(h,e,"popup-blocked");try{h.focus()}catch(d){}return new vp(h)}const bp="__/auth/handler",xp="emulator/auth/handler",_p=encodeURIComponent("fac");async function Ip(e,t,n,r,s,i){im(e.config.authDomain,e,"auth-domain-config-required"),im(e.config.apiKey,e,"invalid-api-key");const a={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:ft,eventId:s};if(t instanceof df){t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(a.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(i||{}))a[e]=t}if(t instanceof mf){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(a.scopes=e.join(","))}e.tenantId&&(a.tid=e.tenantId);const o=a;for(const u of Object.keys(o))void 0===o[u]&&delete o[u];const l=await e._getAppCheckToken(),c=l?`#${_p}=${encodeURIComponent(l)}`:"";return`${function({config:e}){if(!e.emulator)return`https://${e.authDomain}/${bp}`;return dm(e,xp)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e)}?${X(o).slice(1)}${c}`}const kp="webStorageSupport";const Sp=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ef,this._completeRedirectFn=ep,this._overrideRedirectResult=Zf}async _openPopup(e,t,n,r){var s;om(null===(s=this.eventManagers[e._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()");return wp(e,await Ip(e,t,n,lm(),r),Af())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){jf().location.href=e}(await Ip(e,t,n,lm(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(om(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await gp(e),n=new tp(e);return t.register("authEvent",(t=>{im(null==t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(kp,{type:kp},(n=>{var r;const s=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[kp];void 0!==s&&t(!!s),em(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ap(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Jm()||Gm()||Qm()}};var Tp="@firebase/auth",Ep="1.7.9";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Np{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){im(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Ap=F("authIdTokenMaxAge")||300;let Cp=null;var jp;sf={loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");var s,i;r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=tm("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",(null!==(i=null===(s=document.getElementsByTagName("head"))||void 0===s?void 0:s[0])&&void 0!==i?i:document).appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},jp="Browser",ct(new ee("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:i,authDomain:a}=n.options;im(i&&!i.includes(":"),"invalid-api-key",{appName:n.name});const o={apiKey:i,authDomain:a,clientPlatform:jp,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ym(jp)},l=new tf(n,r,s,o);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Mm);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(l,t),l}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),ct(new ee("auth-internal",(e=>{const t=nf(e.getProvider("auth").getImmediate());return new Np(t)}),"PRIVATE").setInstantiationMode("EXPLICIT")),yt(Tp,Ep,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(jp)),yt(Tp,Ep,"esm2017");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Rp="firebasestorage.googleapis.com";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
let Dp=class e extends z{constructor(t,n,r=0){super(Up(t),`Firebase Storage: ${n} (${Up(t)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,e.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Up(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}};var Pp,Op,Mp,Lp;function Up(e){return"storage/"+e}function Fp(e){return new Dp(Pp.INVALID_ARGUMENT,e)}function Vp(){return new Dp(Pp.APP_DELETED,"The Firebase app was deleted.")}(Op=Pp||(Pp={})).UNKNOWN="unknown",Op.OBJECT_NOT_FOUND="object-not-found",Op.BUCKET_NOT_FOUND="bucket-not-found",Op.PROJECT_NOT_FOUND="project-not-found",Op.QUOTA_EXCEEDED="quota-exceeded",Op.UNAUTHENTICATED="unauthenticated",Op.UNAUTHORIZED="unauthorized",Op.UNAUTHORIZED_APP="unauthorized-app",Op.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",Op.INVALID_CHECKSUM="invalid-checksum",Op.CANCELED="canceled",Op.INVALID_EVENT_NAME="invalid-event-name",Op.INVALID_URL="invalid-url",Op.INVALID_DEFAULT_BUCKET="invalid-default-bucket",Op.NO_DEFAULT_BUCKET="no-default-bucket",Op.CANNOT_SLICE_BLOB="cannot-slice-blob",Op.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",Op.NO_DOWNLOAD_URL="no-download-url",Op.INVALID_ARGUMENT="invalid-argument",Op.INVALID_ARGUMENT_COUNT="invalid-argument-count",Op.APP_DELETED="app-deleted",Op.INVALID_ROOT_OPERATION="invalid-root-operation",Op.INVALID_FORMAT="invalid-format",Op.INTERNAL_ERROR="internal-error",Op.UNSUPPORTED_ENVIRONMENT="unsupported-environment";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Bp{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=Bp.makeFromUrl(e,t)}catch(s){return new Bp(e,"")}if(""===n.path)return n;throw r=e,new Dp(Pp.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.");var r}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const s=new RegExp("^gs://"+r+"(/(.*))?$","i");function i(e){e.path_=decodeURIComponent(e.path)}const a=t.replace(/[.]/g,"\\."),o=[{regex:s,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${a}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:i},{regex:new RegExp(`^https?://${t===Rp?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:i}];for(let l=0;l<o.length;l++){const t=o[l],r=t.regex.exec(e);if(r){const e=r[t.indices.bucket];let s=r[t.indices.path];s||(s=""),n=new Bp(e,s),t.postModify(n);break}}if(null==n)throw function(e){return new Dp(Pp.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class $p{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gp(e,t,n,r){if(r<t)throw Fp(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw Fp(`Invalid value for '${e}'. Expected ${n} or less.`)}(Lp=Mp||(Mp={}))[Lp.NO_ERROR=0]="NO_ERROR",Lp[Lp.NETWORK_ERROR=1]="NETWORK_ERROR",Lp[Lp.ABORT=2]="ABORT";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class qp{constructor(e,t,n,r,s,i,a,o,l,c,u,h=!0){this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=i,this.callback_=a,this.errorCallback_=o,this.timeout_=l,this.progressCallback_=c,this.connectionFactory_=u,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()}))}start_(){const e=(e,t)=>{if(t)return void e(!1,new zp(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.body_,this.headers_).then((()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===Mp.NO_ERROR,s=n.getStatus();if(!t||
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e,t){const n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),s=-1!==t.indexOf(e);return n||r||s}(s,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===Mp.ABORT;return void e(!1,new zp(!1,null,t))}const i=-1!==this.successCodes_.indexOf(s);e(!0,new zp(i,n))}))},t=(e,t)=>{const n=this.resolve_,r=this.reject_,s=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(s,s.getResponse());!
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){return void 0!==e}(e)?n():n(e)}catch(i){r(i)}else if(null!==s){const e=new Dp(Pp.UNKNOWN,"An unknown error occurred, please check the error payload for server response.");e.serverResponse=s.getErrorText(),this.errorCallback_?r(this.errorCallback_(s,e)):r(e)}else if(t.canceled){r(this.appDelete_?Vp():new Dp(Pp.CANCELED,"User canceled the upload/download."))}else{r(new Dp(Pp.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))}};this.canceled_?t(0,new zp(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,s=null,i=null,a=!1,o=0;function l(){return 2===o}let c=!1;function u(...e){c||(c=!0,t.apply(null,e))}function h(t){s=setTimeout((()=>{s=null,e(m,l())}),t)}function d(){i&&clearTimeout(i)}function m(e,...t){if(c)return void d();if(e)return d(),void u.call(null,e,...t);if(l()||a)return d(),void u.call(null,e,...t);let n;r<64&&(r*=2),1===o?(o=2,n=0):n=1e3*(r+Math.random()),h(n)}let f=!1;function p(e){f||(f=!0,d(),c||(null!==s?(e||(o=2),clearTimeout(s),h(0)):e||(o=1)))}return h(0),i=setTimeout((()=>{a=!0,p(!0)}),n),p}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class zp{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function Kp(e,t,n,r,s,i,a=!0){const o=function(e){const t=encodeURIComponent;let n="?";for(const r in e)e.hasOwnProperty(r)&&(n=n+(t(r)+"=")+t(e[r])+"&");return n=n.slice(0,-1),n}(e.urlParams),l=e.url+o,c=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(c,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(c,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}(c,i),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(c,r),new qp(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,s,a)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Hp{constructor(e,t){this._service=e,this._location=t instanceof Bp?t:Bp.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Hp(e,t)}get root(){const e=new Bp(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return function(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new Bp(this._location.bucket,e);return new Hp(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new Dp(Pp.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function Wp(e,t){const n=null==t?void 0:t.storageBucket;return null==n?null:Bp.makeFromBucketSpec(n,e)}class Qp{constructor(e,t,n,r,s){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=s,this._bucket=null,this._host=Rp,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?Bp.makeFromBucketSpec(r,this._host):Wp(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=Bp.makeFromBucketSpec(this._url,e):this._bucket=Wp(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Gp("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Gp("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((e=>e.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Hp(this,e)}_makeRequest(e,t,n,r,s=!0){if(this._deleted)return new $p(Vp());{const i=Kp(e,this._appId,n,r,t,this._firebaseVersion,s);return this._requests.add(i),i.getPromise().then((()=>this._requests.delete(i)),(()=>this._requests.delete(i))),i}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const Xp="@firebase/storage",Jp="0.13.2",Yp="storage";function Zp(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new Qp(n,r,s,t,ft)}ct(new ee(Yp,Zp,"PUBLIC").setMultipleInstances(!0)),yt(Xp,Jp,""),yt(Xp,Jp,"esm2017");const eg={users:[],feedbacks:[],onlineStatus:[],activities:[],services:[{name:"Gaming",order:1,items:[{id:"geforce-now",name:"GeForce NOW",type:"cloud",status:"active",rarity:"legendary"},{id:"steam",name:"Steam",type:"gaming",status:"active",rarity:"mythic"}]}],members:[],system:{stats:{totalUsers:0,activeUsers:0,lastUpdate:(new Date).toISOString()}}},tg=pt({apiKey:"AIzaSyBqX8OtLXB6QNTl9h5nxVBHjnIwqh_YFWQ",authDomain:"prime-nexo.firebaseapp.com",projectId:"prime-nexo",storageBucket:"prime-nexo.appspot.com",messagingSenderId:"458796412365",appId:"1:458796412365:web:3f8d9b2e8f9b4f5a6c7d8e"}),ng=function(e,t){const n="string"==typeof e?e:t||"(default)",r=ut("object"==typeof e?e:gt(),"firestore").getImmediate({identifier:n});if(!r._initialized){const e=L("firestore");e&&function(e,t,n,r={}){var s;const i=(e=Rh(e,Ph))._getSettings(),a=`${t}:${n}`;if("firestore.googleapis.com"!==i.host&&i.host!==a&&Ht("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},i),{host:a,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=Bt.MOCK_USER;else{t=B(r.mockUserToken,null===(s=e._app)||void 0===s?void 0:s.options.projectId);const i=r.mockUserToken.sub||r.mockUserToken.user_id;if(!i)throw new Zt(Yt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Bt(i)}e._authCredentials=new rn(new tn(t,n))}}(r,...e)}return r}(tg);!function(e=gt()){const t=ut(e,"auth");if(t.isInitialized())return t.getImmediate();const n=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e,t){const n=ut(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(W(n.getOptions(),null!=t?t:{}))return e;em(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Sp,persistence:[$f,Sf,Ef]}),r=F("authTokenSyncURL");if(r&&"boolean"==typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(s=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Ap)return;const r=null==t?void 0:t.token;Cp!==r&&(Cp=r,await fetch(s,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){Z(e).beforeAuthStateChanged(t,n)}(n,t,(()=>t(n.currentUser))),function(e,t,n,r){Z(e).onIdTokenChanged(t,n,r)}(n,(e=>t(e)))}}var s;const i=M("auth");i&&af(n,`http://${i}`)}(tg),function(e=gt(),t){const n=ut(e=Z(e),Yp).getImmediate({identifier:t}),r=L("storage");r&&function(e,t,n,r={}){!function(e,t,n,r={}){e.host=`${t}:${n}`,e._protocol="http";const{mockUserToken:s}=r;s&&(e._overrideAuthToken="string"==typeof s?s:B(s,e.app.options.projectId))}(e,t,n,r)}(n,...r)}(tg);try{(async function(e){Ht("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=e._freezeSettings();!function(e,t,n){if((e=Rh(e,$h))._firestoreClient||e._terminated)throw new Zt(Yt.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(e._componentsProvider||e._getSettings().localCache)throw new Zt(Yt.FAILED_PRECONDITION,"SDK cache is already specified.");e._componentsProvider={_online:t,_offline:n},qh(e)}(e,wh.provider,{build:e=>new vh(e,t.cacheSizeBytes)})})(ng).catch((e=>{"failed-precondition"===e.code?console.warn("Multiple tabs open, persistence can only be enabled in one tab at a time."):"unimplemented"===e.code&&console.warn("The current browser does not support persistence.")}))}catch(tk){console.warn("Offline persistence not available:",tk)}const rg="feedbacks",sg="onlineStatus",ig="members";(async()=>{for(const[e,t]of Object.entries(eg))try{const t=Uh(ng,e);(await Bd(t)).empty&&console.log(`Initializing ${e} collection...`)}catch(tk){console.error(`Error initializing ${e}:`,tk)}})().catch((e=>{console.warn("Error during collections initialization:",e)}));const ag=e.createContext(null),og=({children:t})=>{const[n,r]=e.useState(null),[s,i]=e.useState(!1),[a,o]=e.useState(!0);e.useEffect((()=>{const e=localStorage.getItem("prime_nexo_auth");if(e)try{const{user:t,isAuthenticated:n}=JSON.parse(e);t&&n&&(r(t),i(!0))}catch(tk){console.error("Error parsing auth data:",tk),localStorage.removeItem("prime_nexo_auth")}o(!1)}),[]);return S.jsx(ag.Provider,{value:{user:n,isAuthenticated:s,isLoading:a,login:async e=>{try{const t=await(async e=>{const t=new URLSearchParams({client_id:"1315323672927666206",client_secret:"_ccRluxpeAyPVI6o_LEFBw8eONtKRCZg",grant_type:"authorization_code",code:e,redirect_uri:"https://prime-nexo-xyz.netlify.app/auth/callback",scope:"identify email"}),n=await fetch(`${N}/oauth2/token`,{method:"POST",body:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}});if(!n.ok)throw new Error("Failed to get Discord token");return n.json()})(e),n=await(async e=>{const t=await fetch(`${N}/users/@me`,{headers:{Authorization:`Bearer ${e}`}});if(!t.ok)throw new Error("Failed to get Discord user");return t.json()})(t.access_token),s=Fh(ng,"users",n.id),a=await Fd(s),o={username:n.username,email:n.email,discordId:n.id,avatar:n.avatar?`https://cdn.discordapp.com/avatars/${n.id}/${n.avatar}.png`:null,lastLogin:Hd(),updatedAt:Hd()};return a.exists()||(o.createdAt=Hd(),o.role="Member"),await $d(s,o,{merge:!0}),r(o),i(!0),localStorage.setItem("prime_nexo_auth",JSON.stringify({user:o,isAuthenticated:!0})),{success:!0}}catch(tk){return console.error("Login error:",tk),{success:!1,error:tk.message}}},logout:()=>{r(null),i(!1),localStorage.removeItem("prime_nexo_auth")}},children:t})},lg=()=>{const t=e.useContext(ag);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t};function cg(){var e;const t=n(),i=r(),{isAuthenticated:a,logout:o,user:l}=lg(),c=e=>t.pathname===e?"bg-red-900/20 text-red-400":"";return S.jsx(f.nav,{initial:{y:-100},animate:{y:0},className:"glass-effect fixed w-full top-0 z-50 px-6 py-4",children:S.jsxs("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[S.jsx(s,{to:"/",className:"text-2xl font-bold text-red-500",children:"Prime Nexo"}),S.jsxs("div",{className:"flex items-center gap-6",children:[S.jsx(s,{to:"/",className:`nav-link ${c("/")}`,children:"Home"}),a?S.jsxs(S.Fragment,{children:[S.jsx(s,{to:"/steam",className:`nav-link ${c("/steam")}`,children:"Steam"}),S.jsx(s,{to:"/accounts",className:`nav-link ${c("/accounts")}`,children:"Accounts"}),S.jsx(s,{to:"/methods",className:`nav-link ${c("/methods")}`,children:"Methods"}),S.jsx(s,{to:"/other-services",className:`nav-link ${c("/other-services")}`,children:"Other Services"}),S.jsx(s,{to:"/dashboard",className:`nav-link ${c("/dashboard")}`,children:"Dashboard"}),S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsxs(s,{to:"/profile",className:"flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/5 transition-colors",children:[(null==l?void 0:l.avatar)?S.jsx("img",{src:l.avatar,alt:l.username,className:"w-8 h-8 rounded-full"}):S.jsx("div",{className:"w-8 h-8 rounded-full bg-red-500/10 flex items-center justify-center",children:S.jsx("span",{className:"text-red-500",children:null==(e=null==l?void 0:l.username)?void 0:e[0]})}),S.jsx("span",{className:"text-gray-300 hover:text-white",children:null==l?void 0:l.username})]}),S.jsx("button",{onClick:()=>{o(),i("/")},className:"nav-link",children:"Logout"})]})]}):S.jsx(s,{to:"/auth",className:`nav-link ${c("/auth")}`,children:"Login"})]})]})})}function ug(){return S.jsxs("div",{className:"relative inline-block",children:[S.jsx(f.h1,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-8xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-red-500 via-red-600 to-red-500 animate-gradient",children:"Prime Nexo"}),S.jsx(f.div,{className:"absolute -inset-x-20 -inset-y-10 blur-3xl",initial:{opacity:0},animate:{opacity:[.15,.25,.15],scale:[1,1.05,1]},transition:{duration:4,repeat:1/0,repeatType:"reverse"},style:{background:"radial-gradient(circle, rgba(220, 38, 38, 0.3) 0%, transparent 70%)"}})]})}function hg(){return S.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[...Array(20)].map(((e,t)=>S.jsx(f.div,{className:"absolute w-1 h-1 bg-red-400/30 rounded-full",initial:{x:100*Math.random()+"%",y:-10,scale:.5*Math.random()+.5,opacity:0},animate:{y:"100vh",opacity:[0,1,0]},transition:{duration:3*Math.random()+2,repeat:1/0,delay:2*Math.random()}},t)))})}function dg(){return S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black via-black/90 to-black/40"}),S.jsx(f.div,{className:"absolute inset-0 opacity-30",initial:{backgroundPosition:"0% 0%"},animate:{backgroundPosition:["0% 0%","100% 100%"]},transition:{duration:20,repeat:1/0,repeatType:"reverse"},style:{backgroundImage:"radial-gradient(circle at center, rgba(220, 38, 38, 0.1) 0%, transparent 50%)",backgroundSize:"100% 100%"}})]})}function mg(){return S.jsxs("div",{className:"absolute inset-0",children:[S.jsx(dg,{}),S.jsx(hg,{})]})}const fg=[{game:"God Of War Ragnarok",username:"krishurt9p",password:"sqVk3Ghpmk1988",imageUrl:"https://i0.wp.com/www.consolecreatures.com/wp-content/uploads/2022/11/reviewgodofwar.webp",description:"• Full Game Access\n• All Weapons & Armor\n• All Realms Unlocked\n• Special Abilities\n• Bonus Content\n• New Game+ Mode",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"M (Mature)"},{label:"Genre",value:"Action Adventure"},{label:"Release",value:"2024"},{label:"Playtime",value:"40+ hours"}],requirements:{cpu:"AMD Ryzen 5 3600 or Intel Core i5-10400",gpu:"AMD RX 6600 XT or NVIDIA RTX 3060",ram:"16 GB",storage:"119 GB SSD"},rarity:"legendary"},{game:"Street Fighter 6",username:"1578252610",password:"A220387723",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/1364780/header.jpg",description:"• Full Game Access\n• All Characters Unlocked\n• All Game Modes\n• Online Features\n• Fighting Ground\n• World Tour Mode",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"T (Teen)"},{label:"Genre",value:"Fighting"},{label:"Release",value:"2023"},{label:"Playtime",value:"50+ hours"}],requirements:{cpu:"Intel Core i5-7500 or AMD Ryzen 3 1200",gpu:"NVIDIA GTX 1060 or AMD RX 580",ram:"8 GB",storage:"60 GB SSD"},rarity:"epic"},{game:"Saints Row 2020",username:"kinga19942",password:"NSVO91LPr10NKOyYm",imageUrl:"https://cdn1.epicgames.com/offer/0d23bb77ee2f45b7a571bde68caddb09/EGS_SaintsRow_DeepSilverVolition_S1_2560x1440-1ba560d3f228fe5c7341777a6ac9abb7",description:"• Full Game Access\n• All DLC Content\n• All Weapons\n• Custom Character\n• All Vehicles\n• Special Items",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"M (Mature)"},{label:"Genre",value:"Action Adventure"},{label:"Release",value:"2022"},{label:"Playtime",value:"40+ hours"}],requirements:{cpu:"Intel Core i7-6700K or AMD Ryzen 5 3600",gpu:"NVIDIA GTX 1070 or AMD RX 5700",ram:"12 GB",storage:"50 GB SSD"},rarity:"epic"},{game:"Slime Rancher 2",username:"youzai5144",password:"Leyouz5987",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/1657630/header.jpg",description:"• Full Game Access\n• All Areas Unlocked\n• All Slimes Available\n• Special Equipment\n• Bonus Content\n• Early Access Updates",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"E (Everyone)"},{label:"Genre",value:"Adventure"},{label:"Release",value:"2022"},{label:"Playtime",value:"30+ hours"}],requirements:{cpu:"Intel Core i5-8400 or AMD Ryzen 5 2600",gpu:"NVIDIA GTX 1060 or AMD RX 580",ram:"8 GB",storage:"30 GB SSD"},rarity:"legendary"},{game:"Gotham Knights",username:"steamok3090498",password:"Mjc2MDQ5NTA=",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/1496790/header.jpg",description:"• Full Game Access\n• All Characters Unlocked\n• All Costumes\n• Special Abilities\n• Story Mode\n• Co-op Features",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"T (Teen)"},{label:"Genre",value:"Action RPG"},{label:"Release",value:"2022"},{label:"Playtime",value:"30+ hours"}],requirements:{cpu:"Intel Core i5-9600K or AMD Ryzen 5 3600",gpu:"NVIDIA GTX 1660 Ti or AMD RX 590",ram:"16 GB",storage:"45 GB SSD"},rarity:"epic"},{game:"Resident Evil 4 Remake",username:"steamok2091664",password:"steamok2091234",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/2050650/header.jpg",description:"• Full Game Access\n• All DLC Content\n• Mercenaries Mode\n• All Weapons Unlocked\n• Special Costumes\n• Bonus Content",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"M (Mature)"},{label:"Genre",value:"Survival Horror"},{label:"Release",value:"2023"},{label:"Playtime",value:"40+ hours"}],requirements:{cpu:"AMD Ryzen 5 3600 or Intel Core i5-10400",gpu:"AMD RX 5700 or NVIDIA RTX 2060",ram:"16 GB",storage:"60 GB SSD"},rarity:"mythic"},{game:"Black Myth: Wukong",username:"tomtran81",password:"80v5hzbt2",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/2358720/header.jpg",description:"• Full Game Access\n• All DLC Content\n• Special Edition Items\n• All Skills Unlocked\n• Exclusive Pre-order Bonuses\n• Digital Artbook",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"M (Mature)"},{label:"Genre",value:"Action RPG"},{label:"Release",value:"2024"},{label:"Playtime",value:"60+ hours"}],requirements:{cpu:"AMD Ryzen 7 3700X or Intel Core i7-9700K",gpu:"AMD RX 6700 XT or NVIDIA RTX 3070",ram:"16 GB",storage:"100 GB SSD"},rarity:"mythic"},{game:"S.T.A.L.K.E.R. 2",username:"seetenater1986",password:"SvW6XFWHws1988",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/1643320/header.jpg",description:"• Full Game Access\n• Early Access Content\n• All Weapons & Equipment\n• Special Edition Items\n• Exclusive Pre-order Bonuses\n• Survival Mode Access",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"M (Mature)"},{label:"Genre",value:"FPS/Survival"},{label:"Release",value:"2024"},{label:"Playtime",value:"50+ hours"}],requirements:{cpu:"AMD Ryzen 7 3700X or Intel Core i7-9700K",gpu:"AMD Radeon RX 6700 XT or NVIDIA RTX 3070",ram:"16 GB",storage:"150 GB SSD"},rarity:"mythic"},{game:"Watch Dogs: Legion",username:"NicoNtiaPhotoSica",password:"WATCH@2029",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/2239550/header.jpg",description:"• Full Game Access\n• All DLC Content\n• Season Pass\n• Online Features\n• All Characters\n• Special Operations",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"M (Mature)"},{label:"Genre",value:"Action-Adventure"},{label:"Release",value:"2020"},{label:"Playtime",value:"60+ hours"}],requirements:{cpu:"Intel Core i5-9600K or AMD Ryzen 5 3600",gpu:"NVIDIA RTX 2060S or AMD RX 5700",ram:"16 GB",storage:"100 GB SSD"},rarity:"mythic"},{game:"Mortal Kombat 1",username:"amygomez9e",password:"eCko4pjixz2000",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/1971870/header.jpg",description:"• Full Game Access\n• All Characters Unlocked\n• Premium Skins\n• Story Mode\n• Online Multiplayer\n• Fatalities Pack",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"M (Mature)"},{label:"Genre",value:"Fighting"},{label:"Release",value:"2023"},{label:"Playtime",value:"50+ hours"}],requirements:{cpu:"AMD Ryzen 5 3600 or Intel Core i5-8400",gpu:"NVIDIA RTX 2060 or AMD RX 5700",ram:"16 GB",storage:"100 GB SSD"},rarity:"mythic"},{game:"Baldur's Gate 3",username:"dudash_ruslan",password:"8_JDEXLy",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/1086940/header.jpg",description:"• Full Game Access\n• All Classes Unlocked\n• All Acts Available\n• Multiplayer Access\n• Character Creation\n• All Origin Characters",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"M (Mature)"},{label:"Genre",value:"RPG"},{label:"Release",value:"2023"},{label:"Playtime",value:"100+ hours"}],requirements:{cpu:"AMD Ryzen 5 3600 or Intel Core i5-10600K",gpu:"AMD RX 5700 XT or NVIDIA RTX 2060 SUPER",ram:"16 GB",storage:"150 GB SSD"},rarity:"legendary"},{game:"Dragons Dogma 2 Deluxe Edition",username:"mksir82042",password:"exlk66954F",imageUrl:"https://image.api.playstation.com/vulcan/ap/rnd/202311/1309/746f848d0be7107e301df1142745b334b64fbc87c218e3b1.jpg",description:"• Full Game Access\n• Deluxe Edition Content\n• All DLC Included\n• Bonus Items\n• Special Weapons\n• Exclusive Armor Sets",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"M (Mature)"},{label:"Genre",value:"Action RPG"},{label:"Release",value:"2024"},{label:"Playtime",value:"80+ hours"}],requirements:{cpu:"AMD Ryzen 5 3600X or Intel Core i7-9700",gpu:"AMD RX 6700 XT or NVIDIA RTX 3060 Ti",ram:"16 GB",storage:"100 GB SSD"},rarity:"legendary"},{game:"NBA 2K24",username:"mic0205",password:"gamerenkk1313!!",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/2338770/header.jpg",description:"• Full Game Access\n• All Teams Unlocked\n• MyTEAM Content\n• Online Features\n• Career Mode\n• Special Edition Items",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"E (Everyone)"},{label:"Genre",value:"Sports"},{label:"Release",value:"2023"},{label:"Playtime",value:"100+ hours"}],requirements:{cpu:"Intel Core i5-7400 or AMD Ryzen 3 1200",gpu:"NVIDIA GTX 1060 or AMD RX 580",ram:"8 GB",storage:"110 GB SSD"},rarity:"legendary"},{game:"Hogwarts Legacy",username:"ilovestalin88",password:"l1nexx1487",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/990080/header.jpg",description:"• Full Game Access\n• All Houses Available\n• Deluxe Edition Content\n• All Spells\n• Special Mounts\n• Exclusive Items",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"T (Teen)"},{label:"Genre",value:"Action RPG"},{label:"Release",value:"2023"},{label:"Playtime",value:"80+ hours"}],requirements:{cpu:"Intel Core i7-8700 or AMD Ryzen 5 3600",gpu:"NVIDIA RTX 2060 or AMD RX 6700 XT",ram:"16 GB",storage:"85 GB SSD"},rarity:"legendary"},{game:"Hitman World of Assassination",username:"wbtq1088781",password:"steamok333",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/1659040/header.jpg",description:"• Complete Trilogy Access\n• All DLC Locations\n• Unlocked Equipment\n• All Campaign Missions\n• Bonus Missions\n• Escalation Contracts",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"M (Mature)"},{label:"Genre",value:"Stealth"},{label:"Release",value:"2023"},{label:"Playtime",value:"100+ hours"}],requirements:{cpu:"Intel Core i5-6600 or AMD Ryzen 5 1600",gpu:"NVIDIA GTX 1070 or AMD RX 5600 XT",ram:"8 GB",storage:"120 GB SSD"},rarity:"legendary"},{game:"Dead Island 2",username:"pakalo63",password:"MUGapGqA5hYe",imageUrl:"https://cdn.wccftech.com/wp-content/uploads/2023/02/DI2.jpeg",description:"• Full Game Access\n• All Characters Unlocked\n• Bonus Weapons Pack\n• Special Abilities\n• All Areas Available\n• Multiplayer Access",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"M (Mature)"},{label:"Genre",value:"Action RPG"},{label:"Release",value:"2023"},{label:"Playtime",value:"30+ hours"}],requirements:{cpu:"AMD Ryzen 5 5600X or Intel i5-10600K",gpu:"AMD RX 6600 XT or NVIDIA RTX 2070",ram:"16 GB",storage:"70 GB SSD"},rarity:"legendary"},{game:"Need for Speed Unbound",username:"dakotabell2010",password:"scooter_123",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/1846380/header.jpg",description:"• Full Game Access\n• All Cars Unlocked\n• Premium Customization\n• Special Edition Content\n• Online Features\n• Exclusive Items",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"T (Teen)"},{label:"Genre",value:"Racing"},{label:"Release",value:"2022"},{label:"Playtime",value:"40+ hours"}],requirements:{cpu:"AMD Ryzen 5 3600 or Intel Core i7-8700",gpu:"NVIDIA RTX 2070 or AMD RX 5700",ram:"16 GB",storage:"50 GB SSD"},rarity:"legendary"},{game:"Cyberpunk 2077",username:"LUBERPUPER",password:"JJLFOXljecer",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/1091500/header.jpg",description:"• Full Game Access with All DLCs\n• Level 50 Character\n• Legendary Weapons & Cyberware\n• All Districts Unlocked\n• Completed Main Story\n• Rare In-Game Items",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"M (Mature)"},{label:"Genre",value:"RPG"},{label:"Release",value:"2020"},{label:"Playtime",value:"100+ hours"}],requirements:{cpu:"Intel Core i7-8700 or AMD Ryzen 5 3600",gpu:"NVIDIA RTX 2060 SUPER or AMD RX 5700 XT",ram:"16 GB",storage:"70 GB SSD"},rarity:"legendary"},{game:"Forza Horizon 5",username:"tuzerup",password:"tapMXmUPtK80a2dn",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/1551360/header.jpg",description:"• Full Game Access\n• All Car Packs\n• Premium Edition\n• Online Features\n• All Expansions\n• VIP Membership",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"E (Everyone)"},{label:"Genre",value:"Racing"},{label:"Release",value:"2021"},{label:"Playtime",value:"80+ hours"}],requirements:{cpu:"Intel Core i5-8400 or AMD Ryzen 5 3600",gpu:"NVIDIA GTX 1070 or AMD RX 590",ram:"16 GB",storage:"110 GB SSD"},rarity:"legendary"},{game:"THE WITCHER 3: WILD HUNT",username:"ksucha_a_a_",password:"ZDh5SxW6IBoU",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/292030/header.jpg",description:"• Full Game Access\n• All DLC Content\n• All Expansions\n• Special Items\n• All Gwent Cards\n• Bonus Content",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"M (Mature)"},{label:"Genre",value:"Action RPG"},{label:"Release",value:"2015"},{label:"Playtime",value:"100+ hours"}],requirements:{cpu:"Intel Core i5-2500K or AMD FX-8350",gpu:"NVIDIA GTX 770 or AMD Radeon RX 480",ram:"8 GB",storage:"50 GB"},rarity:"epic"},{game:"Cities Skylines 2",username:"93612408",password:"07545306",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/949230/header.jpg",description:"• Full Game Access\n• All DLC Content\n• All Building Packs\n• Modding Support\n• Scenario Editor\n• Workshop Access",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"E (Everyone)"},{label:"Genre",value:"City Builder"},{label:"Release",value:"2023"},{label:"Playtime",value:"50+ hours"}],requirements:{cpu:"Intel Core i7-6700K or AMD Ryzen 5 3600",gpu:"NVIDIA RTX 2080 or AMD RX 6700 XT",ram:"16 GB",storage:"60 GB SSD"},rarity:"epic"},{game:"No Man's Sky",username:"sdwrsk",password:"Sw084812",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/275850/header.jpg",description:"• Full Game Access\n• All Updates\n• Multiplayer Access\n• Base Building\n• All Vehicles\n• Special Items",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"T (Teen)"},{label:"Genre",value:"Space Exploration"},{label:"Release",value:"2016"},{label:"Playtime",value:"100+ hours"}],requirements:{cpu:"Intel Core i5-7400 or AMD Ryzen 5 1500X",gpu:"NVIDIA GTX 1060 or AMD RX 570",ram:"8 GB",storage:"15 GB"},rarity:"epic"},{game:"Elden Ring",username:"7ctl84gk",password:"MXemjxzeRN",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/1245620/header.jpg",description:"• Full Game Access\n• All Areas Unlocked\n• Multiplayer Access\n• All Classes Available\n• DLC Content\n• Special Items",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"M (Mature)"},{label:"Genre",value:"Action RPG"},{label:"Release",value:"2022"},{label:"Playtime",value:"100+ hours"}],requirements:{cpu:"AMD Ryzen 5 3600X or Intel Core i7-8700K",gpu:"AMD RX 5700 XT or NVIDIA RTX 2070",ram:"16 GB",storage:"60 GB SSD"},rarity:"epic"},{game:"Ghost of Tsushima",username:"ghosttsushima5",password:"7JAN3Q!F!7EW",imageUrl:"https://helios-i.mashable.com/imagery/articles/00iMVz5oU69RK9UEoPsZTMW/hero-image.fill.size_1248x702.v1623390188.jpg",description:"• Full Game Access\n• Directors Cut Content\n• All DLC Included\n• Multiplayer Access\n• All Armor Sets\n• Special Items",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"M (Mature)"},{label:"Genre",value:"Action Adventure"},{label:"Release",value:"2024"},{label:"Playtime",value:"50+ hours"}],requirements:{cpu:"AMD Ryzen 5 3600 or Intel Core i5-10400",gpu:"AMD RX 5700 or NVIDIA RTX 2060 SUPER",ram:"16 GB",storage:"75 GB SSD"},rarity:"epic"},{game:"Ready or Not",username:"tets64960",password:"Iw5Cc1On0Ff16t",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/1144200/header.jpg",description:"• Full Game Access\n• All Maps\n• Multiplayer Access\n• All Equipment\n• Special Items\n• Supporter Edition",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"M (Mature)"},{label:"Genre",value:"Tactical FPS"},{label:"Release",value:"2023"},{label:"Playtime",value:"40+ hours"}],requirements:{cpu:"AMD Ryzen 5 3600 or Intel Core i5-9600K",gpu:"AMD RX 5700 or NVIDIA RTX 2060",ram:"16 GB",storage:"90 GB SSD"},rarity:"epic"},{game:"Call of Duty WW2",username:"zbyszekch71",password:"FunpayMysxla",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/476600/header.jpg",description:"• Full Game Access\n• All DLC Maps\n• Multiplayer Access\n• Zombie Mode\n• Campaign Mode\n• Special Weapons",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"M (Mature)"},{label:"Genre",value:"FPS"},{label:"Release",value:"2017"},{label:"Playtime",value:"50+ hours"}],requirements:{cpu:"Intel Core i5-2400 or AMD Ryzen 5 1600",gpu:"NVIDIA GTX 970 or AMD RX 470",ram:"8 GB",storage:"90 GB HDD"},rarity:"epic"},{game:"Atomic Heart",username:"gaby_idf",password:"AtomicHeartFunpayTrashSergey",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/668580/header.jpg",description:"• Full Game Access\n• All Weapons\n• All Areas Unlocked\n• Special Abilities\n• Premium Content\n• Bonus Items",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"M (Mature)"},{label:"Genre",value:"Action RPG"},{label:"Release",value:"2023"},{label:"Playtime",value:"40+ hours"}],requirements:{cpu:"Intel Core i5-6600K or AMD Ryzen 5 2600",gpu:"NVIDIA GTX 1060 or AMD RX 580",ram:"8 GB",storage:"90 GB SSD"},rarity:"epic"},{game:"Dying Light 2: Reloaded Edition",username:"rehuidwswgq171",password:"qwerf2625",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/534380/header.jpg",description:"• Full Game Access\n• All DLCs\n• Multiplayer Access\n• Special Weapons\n• Bonus Content\n• Season Pass",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"M (Mature)"},{label:"Genre",value:"Action RPG"},{label:"Release",value:"2022"},{label:"Playtime",value:"100+ hours"}],requirements:{cpu:"Intel Core i5-8600K or AMD Ryzen 5 3600X",gpu:"NVIDIA RTX 2060 or AMD RX 6600 XT",ram:"16 GB",storage:"60 GB SSD"},rarity:"epic"},{game:"BeamNG.drive",username:"ohts03444",password:"Ms123123Ms",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/284160/header.jpg",description:"• Full Game Access\n• All Vehicles\n• All Maps\n• Mod Support\n• Scenarios\n• Multiplayer Beta",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"E (Everyone)"},{label:"Genre",value:"Vehicle Simulation"},{label:"Release",value:"2015"},{label:"Playtime",value:"50+ hours"}],requirements:{cpu:"Intel Core i5-7400 or AMD Ryzen 5 1500X",gpu:"NVIDIA GTX 1060 or AMD RX 580",ram:"16 GB",storage:"40 GB"},rarity:"epic"},{game:"Lethal Company",username:"Sb9Bt9Lm3Qm5",password:"Jp9Bl3Yh8Ab5",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/1966720/header.jpg",description:"• Full Game Access\n• Multiplayer Access\n• All Maps\n• All Equipment\n• Special Items\n• Workshop Support",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"T (Teen)"},{label:"Genre",value:"Horror Survival"},{label:"Release",value:"2023"},{label:"Playtime",value:"30+ hours"}],requirements:{cpu:"Intel Core i5-4590 or AMD Ryzen 3 1200",gpu:"NVIDIA GTX 970 or AMD RX 480",ram:"8 GB",storage:"2 GB"},rarity:"rare"},{game:"Stray",username:"Brahminsnare323",password:"xCZStAudn0Cs",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/1332010/header.jpg",description:"• Full Game Access\n• All Chapters\n• All Collectibles\n• Special Items\n• Bonus Content\n• Digital Artbook",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"E (Everyone)"},{label:"Genre",value:"Adventure"},{label:"Release",value:"2022"},{label:"Playtime",value:"8+ hours"}],requirements:{cpu:"Intel Core i5-8400 or AMD Ryzen 5 2600",gpu:"NVIDIA GTX 780 or AMD RX 470",ram:"8 GB",storage:"10 GB"},rarity:"rare"},{game:"Superhot",username:"osond430",password:"steamok556556",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/322500/header.jpg",description:"• Full Game Access\n• All Levels\n• Endless Mode\n• Challenge Mode\n• Special Abilities\n• Bonus Content",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"T (Teen)"},{label:"Genre",value:"Action"},{label:"Release",value:"2016"},{label:"Playtime",value:"15+ hours"}],requirements:{cpu:"Intel Core i3-3220 or AMD Phenom II X4",gpu:"NVIDIA GTX 650 or AMD HD 7750",ram:"4 GB",storage:"8 GB"},rarity:"rare"},{game:"Little Nightmares 2",username:"galyakushilenko1991",password:"IXi4M1lOVlsNprrr5",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/860510/header.jpg",description:"• Full Game Access\n• All Chapters\n• Bonus Content\n• Digital Artbook\n• Soundtrack\n• Special Items",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"T (Teen)"},{label:"Genre",value:"Horror Adventure"},{label:"Release",value:"2021"},{label:"Playtime",value:"15+ hours"}],requirements:{cpu:"Intel Core i5-2300 or AMD FX-4350",gpu:"NVIDIA GTX 570 or AMD HD 7850",ram:"4 GB",storage:"30 GB"},rarity:"rare"},{game:"Among Us",username:"elong8600",password:"Midnight6598!",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/945360/header.jpg",description:"• Full Game Access\n• All Maps\n• All Cosmetics\n• Online Play\n• Custom Games\n• Special Items",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"E (Everyone)"},{label:"Genre",value:"Party"},{label:"Release",value:"2018"},{label:"Playtime",value:"20+ hours"}],requirements:{cpu:"Intel Core i3-2100 or AMD equivalent",gpu:"Integrated Graphics",ram:"4 GB",storage:"1 GB"},rarity:"uncommon"},{game:"Subnautica: Below Zero",username:"kubix_2121",password:"PIKZmVxVrF9A",imageUrl:"https://cdn.cloudflare.steamstatic.com/steam/apps/848450/header.jpg",description:"• Full Game Access\n• All Areas Unlocked\n• Survival Mode\n• Freedom Mode\n• Creative Mode\n• Hardcore Mode",features:[{label:"Region",value:"Global"},{label:"Platform",value:"Steam"},{label:"Rating",value:"E (Everyone)"},{label:"Genre",value:"Survival Adventure"},{label:"Release",value:"2021"},{label:"Playtime",value:"40+ hours"}],requirements:{cpu:"Intel Core i3-6300 or AMD Ryzen 3 1200",gpu:"NVIDIA GTX 1050 Ti or AMD RX 570",ram:"8 GB",storage:"15 GB"},rarity:"uncommon"}],pg={common:{boxShadow:"0 0 20px rgba(255, 255, 255, 0.3)",animation:"glow-common"},uncommon:{boxShadow:"0 0 20px rgba(34, 197, 94, 0.3)",animation:"glow-uncommon"},rare:{boxShadow:"0 0 20px rgba(59, 130, 246, 0.3)",animation:"glow-rare"},epic:{boxShadow:"0 0 20px rgba(168, 85, 247, 0.3)",animation:"glow-epic"},legendary:{boxShadow:"0 0 20px rgba(234, 179, 8, 0.3)",animation:"glow-legendary"},mythic:{boxShadow:"0 0 20px rgba(239, 68, 68, 0.3)",animation:"glow-mythic"}},gg={common:{textColor:"text-white",borderColor:"border-gray-600",bgColor:"bg-gray-500/20",label:"COMMON",requiresPin:!0,pin:"1111",glowColor:"#ffffff",iconColor:"text-gray-400",textAccent:"text-gray-400",hoverAccent:"hover:text-gray-200"},uncommon:{textColor:"text-white",borderColor:"border-green-500/30",bgColor:"bg-green-500/20",label:"UNCOMMON",requiresPin:!0,pin:"2222",glowColor:"#22c55e",iconColor:"text-green-400",textAccent:"text-green-400",hoverAccent:"hover:text-green-200"},rare:{textColor:"text-blue-300",borderColor:"border-blue-500/30",bgColor:"bg-blue-500/20",label:"RARE",requiresPin:!0,pin:"8293",glowColor:"#3b82f6",iconColor:"text-blue-400",textAccent:"text-blue-400",hoverAccent:"hover:text-blue-200"},epic:{textColor:"text-purple-300",borderColor:"border-purple-500/30",bgColor:"bg-purple-500/20",label:"EPIC",requiresPin:!0,pin:"4617",glowColor:"#9333ea",iconColor:"text-purple-400",textAccent:"text-purple-400",hoverAccent:"hover:text-purple-200"},legendary:{textColor:"text-yellow-300",borderColor:"border-yellow-500/30",bgColor:"bg-yellow-500/20",label:"LEGENDARY",requiresPin:!0,pin:"2716",glowColor:"#eab308",iconColor:"text-yellow-400",textAccent:"text-yellow-400",hoverAccent:"hover:text-yellow-200"},mythic:{textColor:"text-red-300",borderColor:"border-red-500/30",bgColor:"bg-red-500/20",label:"MYTHIC",requiresPin:!0,pin:"5026",glowColor:"#ef4444",iconColor:"text-red-400",textAccent:"text-red-400",hoverAccent:"hover:text-red-200"}};function yg({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"}))}const vg=e.forwardRef(yg);function wg({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}))}const bg=e.forwardRef(wg);function xg({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 0 1 .865-.501 48.172 48.172 0 0 0 3.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"}))}const _g=e.forwardRef(xg);function Ig({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.76c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.076-4.076a1.526 1.526 0 0 1 1.037-.443 48.282 48.282 0 0 0 5.68-.494c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"}))}const kg=e.forwardRef(Ig);function Sg({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z"}))}const Tg=e.forwardRef(Sg);function Eg({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))}const Ng=e.forwardRef(Eg);function Ag({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))}const Cg=e.forwardRef(Ag);function jg({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 6.375c0 2.278-3.694 4.125-8.25 4.125S3.75 8.653 3.75 6.375m16.5 0c0-2.278-3.694-4.125-8.25-4.125S3.75 4.097 3.75 6.375m16.5 0v11.25c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125V6.375m16.5 0v3.75m-16.5-3.75v3.75m16.5 0v3.75C20.25 16.153 16.556 18 12 18s-8.25-1.847-8.25-4.125v-3.75m16.5 0c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125"}))}const Rg=e.forwardRef(jg);function Dg({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5A3.375 3.375 0 0 0 6.375 7.5H5.25m11.9-3.664A2.251 2.251 0 0 0 15 2.25h-1.5a2.251 2.251 0 0 0-2.15 1.586m5.8 0c.065.21.1.433.1.664v.75h-6V4.5c0-.231.035-.454.1-.664M6.75 7.5H4.875c-.621 0-1.125.504-1.125 1.125v12c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V16.5a9 9 0 0 0-9-9Z"}))}const Pg=e.forwardRef(Dg);function Og({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Mg=e.forwardRef(Og);function Lg({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 16.5V9.75m0 0 3 3m-3-3-3 3M6.75 19.5a4.5 4.5 0 0 1-1.41-8.775 5.25 5.25 0 0 1 10.233-2.33 3 3 0 0 1 3.758 3.848A3.752 3.752 0 0 1 18 19.5H6.75Z"}))}const Ug=e.forwardRef(Lg);function Fg({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v1.007a3 3 0 0 1-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0 1 15 18.257V17.25m6-12V15a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 15V5.25m18 0A2.25 2.25 0 0 0 18.75 3H5.25A2.25 2.25 0 0 0 3 5.25m18 0V12a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 12V5.25"}))}const Vg=e.forwardRef(Fg);function Bg({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 3v1.5M4.5 8.25H3m18 0h-1.5M4.5 12H3m18 0h-1.5m-15 3.75H3m18 0h-1.5M8.25 19.5V21M12 3v1.5m0 15V21m3.75-18v1.5m0 15V21m-9-1.5h10.5a2.25 2.25 0 0 0 2.25-2.25V6.75a2.25 2.25 0 0 0-2.25-2.25H6.75A2.25 2.25 0 0 0 4.5 6.75v10.5a2.25 2.25 0 0 0 2.25 2.25Zm.75-12h9v9h-9v-9Z"}))}const $g=e.forwardRef(Bg);function Gg({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 7.5-9-5.25L3 7.5m18 0-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"}))}const qg=e.forwardRef(Gg);function zg({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 1.5H8.25A2.25 2.25 0 0 0 6 3.75v16.5a2.25 2.25 0 0 0 2.25 2.25h7.5A2.25 2.25 0 0 0 18 20.25V3.75a2.25 2.25 0 0 0-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3"}))}const Kg=e.forwardRef(zg);function Hg({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const Wg=e.forwardRef(Hg);function Qg({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125M3.375 19.5h1.5C5.496 19.5 6 18.996 6 18.375m-3.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-1.5A1.125 1.125 0 0 1 18 18.375M20.625 4.5H3.375m17.25 0c.621 0 1.125.504 1.125 1.125M20.625 4.5h-1.5C18.504 4.5 18 5.004 18 5.625m3.75 0v1.5c0 .621-.504 1.125-1.125 1.125M3.375 4.5c-.621 0-1.125.504-1.125 1.125M3.375 4.5h1.5C5.496 4.5 6 5.004 6 5.625m-3.75 0v1.5c0 .621.504 1.125 1.125 1.125m0 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m1.5-3.75C5.496 8.25 6 7.746 6 7.125v-1.5M4.875 8.25C5.496 8.25 6 8.754 6 9.375v1.5m0-5.25v5.25m0-5.25C6 5.004 6.504 4.5 7.125 4.5h9.75c.621 0 1.125.504 1.125 1.125m1.125 2.625h1.5m-1.5 0A1.125 1.125 0 0 1 18 7.125v-1.5m1.125 2.625c-.621 0-1.125.504-1.125 1.125v1.5m2.625-2.625c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125M18 5.625v5.25M7.125 12h9.75m-9.75 0A1.125 1.125 0 0 1 6 10.875M7.125 12C6.504 12 6 12.504 6 13.125m0-2.25C6 11.496 5.496 12 4.875 12M18 10.875c0 .621-.504 1.125-1.125 1.125M18 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m-12 5.25v-5.25m0 5.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125m-12 0v-1.5c0-.621-.504-1.125-1.125-1.125M18 18.375v-5.25m0 5.25v-1.5c0-.621.504-1.125 1.125-1.125M18 13.125v1.5c0 .621.504 1.125 1.125 1.125M18 13.125c0-.621.504-1.125 1.125-1.125M6 13.125v1.5c0 .621-.504 1.125-1.125 1.125M6 13.125C6 12.504 5.496 12 4.875 12m-1.5 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M19.125 12h1.5m0 0c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h1.5m14.25 0h1.5"}))}const Xg=e.forwardRef(Qg);function Jg({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"}))}const Yg=e.forwardRef(Jg);function Zg({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25Z"}))}const ey=e.forwardRef(Zg);function ty({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"}))}const ny=e.forwardRef(ty);function ry({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"}))}const sy=e.forwardRef(ry);function iy({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const ay=e.forwardRef(iy);function oy({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const ly=e.forwardRef(oy);function cy({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12.75 19.5v-.75a7.5 7.5 0 0 0-7.5-7.5H4.5m0-6.75h.75c7.87 0 14.25 6.38 14.25 14.25v.75M6 18.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"}))}const uy=e.forwardRef(cy);function hy({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 17.25v-.228a4.5 4.5 0 0 0-.12-1.03l-2.268-9.64a3.375 3.375 0 0 0-3.285-2.602H7.923a3.375 3.375 0 0 0-3.285 2.602l-2.268 9.64a4.5 4.5 0 0 0-.12 1.03v.228m19.5 0a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3m19.5 0a3 3 0 0 0-3-3H5.25a3 3 0 0 0-3 3m16.5 0h.008v.008h-.008v-.008Zm-3 0h.008v.008h-.008v-.008Z"}))}const dy=e.forwardRef(hy);function my({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))}const fy=e.forwardRef(my);function py({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m0-10.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.75c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.57-.598-3.75h-.152c-3.196 0-6.1-1.25-8.25-3.286Zm0 13.036h.008v.008H12v-.008Z"}))}const gy=e.forwardRef(py);function yy({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"}))}const vy=e.forwardRef(yy);function wy({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"}))}const by=e.forwardRef(wy);function xy({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 18.75h-9m9 0a3 3 0 0 1 3 3h-15a3 3 0 0 1 3-3m9 0v-3.375c0-.621-.503-1.125-1.125-1.125h-.871M7.5 18.75v-3.375c0-.621.504-1.125 1.125-1.125h.872m5.007 0H9.497m5.007 0a7.454 7.454 0 0 1-.982-3.172M9.497 14.25a7.454 7.454 0 0 0 .981-3.172M5.25 4.236c-.982.143-1.954.317-2.916.52A6.003 6.003 0 0 0 7.73 9.728M5.25 4.236V4.5c0 2.108.966 3.99 2.48 5.228M5.25 4.236V2.721C7.456 2.41 9.71 2.25 12 2.25c2.291 0 4.545.16 6.75.47v1.516M7.73 9.728a6.726 6.726 0 0 0 2.748 1.35m8.272-6.842V4.5c0 2.108-.966 3.99-2.48 5.228m2.48-5.492a46.32 46.32 0 0 1 2.916.52 6.003 6.003 0 0 1-5.395 4.972m0 0a6.726 6.726 0 0 1-2.749 1.35m0 0a6.772 6.772 0 0 1-3.044 0"}))}const _y=e.forwardRef(xy);function Iy({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 20.25h12m-7.5-3v3m3-3v3m-10.125-3h17.25c.621 0 1.125-.504 1.125-1.125V4.875c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125Z"}))}const ky=e.forwardRef(Iy);function Sy({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const Ty=e.forwardRef(Sy);function Ey({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const Ny=e.forwardRef(Ey);function Ay({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M22 10.5h-6m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM4 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 10.374 21c-2.331 0-4.512-.645-6.374-1.766Z"}))}const Cy=e.forwardRef(Ay);function jy({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM3 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 9.374 21c-2.331 0-4.512-.645-6.374-1.766Z"}))}const Ry=e.forwardRef(jy);function Dy({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const Py=e.forwardRef(Dy);function Oy({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.288 15.038a5.25 5.25 0 0 1 7.424 0M5.106 11.856c3.807-3.808 9.98-3.808 13.788 0M1.924 8.674c5.565-5.565 14.587-5.565 20.152 0M12.53 18.22l-.53.53-.53-.53a.75.75 0 0 1 1.06 0Z"}))}const My=e.forwardRef(Oy);function Ly({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 8.25V18a2.25 2.25 0 0 0 2.25 2.25h13.5A2.25 2.25 0 0 0 21 18V8.25m-18 0V6a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 6v2.25m-18 0h18M5.25 6h.008v.008H5.25V6ZM7.5 6h.008v.008H7.5V6Zm2.25 0h.008v.008H9.75V6Z"}))}const Uy=e.forwardRef(Ly);function Fy({title:t,titleId:n,...r},s){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":n},r),t?e.createElement("title",{id:n},t):null,e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const Vy=e.forwardRef(Fy),By=fg.filter((e=>"mythic"===e.rarity||"legendary"===e.rarity)).slice(0,6);function $y(){return S.jsx("div",{className:"bg-black/60 py-16",children:S.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[S.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-12",children:[S.jsx("h2",{className:"text-4xl font-bold text-red-500 mb-4",children:"Latest Releases"}),S.jsx("p",{className:"text-gray-400 max-w-2xl mx-auto",children:"Check out our newest premium game accounts with exclusive content and features"}),S.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Made by ",S.jsx("span",{className:"text-red-500 font-semibold",children:"Andres_rios"})," and"," ",S.jsx("span",{className:"text-red-500 font-semibold",children:"MarcSpector"})]})]}),S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:By.map(((e,t)=>{const n=gg[e.rarity],r=pg[e.rarity];return S.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"glass-effect rounded-xl overflow-hidden group hover:scale-[1.02] transition-all duration-300",style:{boxShadow:r.boxShadow,animation:`${r.animation} 3s ease-in-out infinite`},children:[S.jsxs("div",{className:"relative h-48",children:[S.jsx("img",{src:e.imageUrl,alt:e.game,className:"w-full h-full object-cover"}),S.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black to-transparent"}),S.jsxs("div",{className:"absolute bottom-4 left-4",children:[S.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:e.game}),S.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${n.bgColor} ${n.textColor} border ${n.borderColor}`,children:n.label})]})]}),S.jsx("div",{className:"p-4",children:S.jsxs("div",{className:"space-y-3",children:[S.jsx("p",{className:"text-sm text-gray-400 line-clamp-2",children:e.description.split("\n")[0].replace("• ","")}),S.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[S.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[S.jsx("span",{className:`h-2 w-2 rounded-full ${n.textAccent}`}),S.jsx("span",{className:"text-gray-300",children:e.features.find((e=>"Genre"===e.label)).value})]}),S.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[S.jsx("span",{className:`h-2 w-2 rounded-full ${n.textAccent}`}),S.jsx("span",{className:"text-gray-300",children:e.features.find((e=>"Release"===e.label)).value})]}),S.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[S.jsx(Mg,{className:`h-4 w-4 ${n.textAccent}`}),S.jsx("span",{className:"text-gray-300",children:e.features.find((e=>"Playtime"===e.label)).value})]}),S.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[S.jsx(_y,{className:`h-4 w-4 ${n.textAccent}`}),S.jsx("span",{className:"text-gray-300",children:e.features.find((e=>"Rating"===e.label)).value})]})]})]})})]},t)}))}),S.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"text-center mt-12",children:S.jsx(s,{to:"/steam",className:"inline-flex items-center gap-2 px-6 py-3 bg-red-600 hover:bg-red-700 rounded-lg transition-all duration-300 text-white font-semibold",children:"View All Games"})})]})})}const Gy=[{icon:fy,title:"Secure Access",description:"Advanced security measures to protect your gaming accounts"},{icon:Yg,title:"Global Support",description:"Access to games from different regions and platforms"},{icon:qg,title:"Premium Content",description:"Exclusive access to rare items and premium features"},{icon:vy,title:"Instant Access",description:"Quick and easy access to your favorite games"},{icon:Ny,title:"Community",description:"Join a thriving community of gamers"},{icon:Mg,title:"24/7 Support",description:"Round-the-clock assistance for all your gaming needs"}];function qy(){return S.jsx("div",{className:"py-24 bg-gradient-to-b from-black/60 to-black/40",children:S.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[S.jsxs("div",{className:"text-center mb-16",children:[S.jsx("h2",{className:"text-4xl font-bold text-red-500 mb-4",children:"Why Choose Prime Nexo?"}),S.jsx("p",{className:"text-gray-400 max-w-2xl mx-auto",children:"Experience gaming like never before with our premium features and services"})]}),S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:Gy.map(((e,t)=>S.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"glass-effect p-8 rounded-xl hover:bg-white/5 transition-all duration-300",children:[S.jsx(e.icon,{className:"h-8 w-8 text-red-500 mb-4"}),S.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:e.title}),S.jsx("p",{className:"text-gray-400",children:e.description})]},t)))})]})})}function zy(){return S.jsx("div",{className:"max-w-7xl mx-auto px-6 mb-16",children:S.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-xl p-6",children:S.jsxs("div",{className:"flex items-start gap-4",children:[S.jsx(Wg,{className:"h-6 w-6 text-yellow-500 flex-shrink-0 mt-1"}),S.jsxs("div",{className:"space-y-4",children:[S.jsx("h3",{className:"text-lg font-semibold text-yellow-500",children:"🚨 Access Restricted: Log In or Sign Up Required! 🚨"}),S.jsx("p",{className:"text-gray-300",children:"To explore all pages, access premium accounts, and unlock exclusive content, you need to:"}),S.jsxs("ul",{className:"space-y-2 text-gray-300",children:[S.jsx("li",{children:"1️⃣ Log In if you're already a member."}),S.jsx("li",{children:"2️⃣ Sign Up to create an account and enjoy everything we offer!"})]}),S.jsx("p",{className:"text-yellow-400 font-medium",children:"🔒 Your gateway to full access starts here!"}),S.jsx("div",{className:"pt-4 flex flex-col sm:flex-row gap-4 items-center",children:S.jsxs("div",{className:"flex gap-4",children:[S.jsx(s,{to:"/auth",className:"px-6 py-2 bg-yellow-500 hover:bg-yellow-600 text-black font-semibold rounded-lg transition-colors",children:"Login"}),S.jsx(s,{to:"/auth?mode=signup",className:"px-6 py-2 bg-yellow-500/20 hover:bg-yellow-500/30 text-yellow-500 font-semibold rounded-lg border border-yellow-500/50 transition-colors",children:"Sign Up"})]})}),S.jsx("div",{className:"mt-4 p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:S.jsx("p",{className:"text-red-400 text-sm",children:"I am not responsible for anything. Anyone who attempts to bypass any website security measures or related protections will face consequences."})})]})]})})})}function Ky(){return S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"min-h-[80vh] flex items-center justify-center px-6 relative overflow-hidden",children:[S.jsx(mg,{}),S.jsx("div",{className:"max-w-7xl w-full mx-auto relative z-10",children:S.jsxs("div",{className:"text-center",children:[S.jsx(ug,{}),S.jsx(f.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"mt-8 text-xl text-gray-300 max-w-2xl mx-auto leading-relaxed",children:"Your ultimate destination for premium gaming experiences. Access exclusive accounts, cloud gaming, and streaming services in one secure platform."})]})})]}),S.jsx(zy,{}),S.jsx($y,{}),S.jsx(qy,{})]})}function Hy(){return S.jsx("div",{className:"min-h-screen",children:S.jsx(Ky,{})})}function Wy({onSearch:t,placeholder:n="Search..."}){const[r,s]=e.useState("");return S.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"relative max-w-xl mx-auto mb-8",children:S.jsxs("div",{className:"relative group",children:[S.jsx("input",{type:"text",value:r,onChange:e=>{const n=e.target.value;s(n),t(n)},placeholder:n,className:"w-full bg-black/50 border border-white/10 rounded-lg pl-12 pr-4 py-3 \n                   text-white placeholder-gray-400 \n                   focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent \n                   transition-all duration-300\n                   group-hover:border-white/20"}),S.jsx(ay,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 \n                                      text-gray-400 group-hover:text-gray-300 transition-colors duration-300"})]})})}function Qy(){return S.jsx("div",{className:"bg-black/90 border border-yellow-500/30 rounded-xl p-6 mb-8 shadow-lg",children:S.jsxs("div",{className:"flex items-start gap-4",children:[S.jsx(Wg,{className:"h-6 w-6 text-yellow-500 flex-shrink-0 mt-1"}),S.jsxs("div",{className:"space-y-2",children:[S.jsx("h3",{className:"text-lg font-semibold text-yellow-500",children:"Warning"}),S.jsxs("ul",{className:"space-y-2 text-gray-300",children:[S.jsx("li",{children:"• Disable cloud save and remote play in the steam settings"}),S.jsx("li",{children:"• If the game closes or you get disconnected, enter offline mode on Steam or use Big Picture mode"}),S.jsx("li",{children:"• For guarded accounts, wait until they become unguarded or use a new account"}),S.jsx("li",{children:"• All posts will be updated with new accounts for the same game!"}),S.jsx("li",{children:"• Ubisoft, Rockstar, and EA games may not work due to their protections, and some games have Denuvo that may stop you from playing, so try again later or use a new account"}),S.jsx("li",{className:"text-yellow-400",children:"• I'm not responsible for anything if you didn't follow my instructions"})]})]})]})})}function Xy({title:e,subtitle:t,count:n,countLabel:r}){return S.jsxs("div",{className:"h-[40vh] relative flex items-center justify-center mb-12 mt-16",children:[S.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black/95 via-black/90 to-black/80"}),S.jsxs("div",{className:"relative z-10 text-center max-w-4xl mx-auto px-6",children:[S.jsx(f.h1,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"text-7xl font-bold mb-6 text-red-500 drop-shadow-lg",children:e}),S.jsx(f.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"text-2xl text-gray-200 leading-relaxed drop-shadow-lg mb-8",children:t}),void 0!==n&&S.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"inline-block px-6 py-2 bg-gradient-to-r from-red-500/20 via-black/40 to-red-500/20 border border-red-500/30 rounded-lg",children:S.jsxs("span",{className:"text-white font-bold",children:[n," ",r||"Items"," Available"]})})]})]})}function Jy(){return S.jsx(Xy,{title:"Steam Accounts",subtitle:"Unlock Premium Gaming Experiences with Our Curated Collection",count:fg.length,countLabel:"Premium Accounts"})}function Yy({isOpen:t,onClose:n,onSubmit:r,rarity:s,error:i}){const[a,o]=e.useState(""),[l,c]=e.useState(""),[u,h]=e.useState(!1),d=gg[s];return t?S.jsx(p,{children:S.jsx(f.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:S.jsx(f.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1,x:u?[-10,10,-10,10,0]:0},transition:{duration:u?.4:.2,type:u?"spring":"tween"},className:"relative w-full max-w-sm rounded-lg overflow-hidden",style:{background:"rgba(0, 0, 0, 0.95)",boxShadow:`0 0 30px ${d.glowColor}40`},children:S.jsxs("div",{className:"p-6",children:[S.jsxs("div",{className:"flex justify-between items-center mb-6",children:[S.jsx("h3",{className:`text-2xl font-bold ${d.textColor}`,children:"Enter PIN"}),S.jsx("button",{onClick:()=>{n(),o(""),c("")},className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:S.jsx(Vy,{className:"h-5 w-5 text-white/70 hover:text-white"})})]}),S.jsxs("form",{onSubmit:e=>{e.preventDefault(),r(a),i&&(c(i),h(!0),setTimeout((()=>h(!1)),500))},className:"space-y-4",children:[S.jsx("input",{type:"password",maxLength:"4",value:a,onChange:e=>{o(e.target.value.replace(/\D/g,"").slice(0,4)),c("")},className:"w-full bg-black/50 border border-white/20 rounded-lg px-4 py-3 text-center text-2xl tracking-[1em] text-white placeholder-white/30 focus:outline-none focus:border-white/40",placeholder:"****",autoFocus:!0}),(l||i)&&S.jsx(f.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-400 text-sm text-center",children:l||i}),S.jsx("button",{type:"submit",disabled:4!==a.length,className:`w-full py-3 rounded-lg font-semibold text-white transition-all duration-300 ${d.bgColor} hover:brightness-110 disabled:opacity-50 disabled:cursor-not-allowed`,style:{boxShadow:`0 0 20px ${d.glowColor}40`},children:"Unlock"})]})]})})})}):null}function Zy({username:e,password:t,copied:n,onCopy:r,rarityConfig:s,account:i}){var a,o,l,c,u,h;return S.jsxs("div",{className:"space-y-6",children:[S.jsx("div",{className:"space-y-4",children:i.description.split("\n").map(((e,t)=>S.jsx("p",{className:"text-gray-300 flex items-center gap-2",children:e},t)))}),S.jsxs("div",{className:"grid grid-cols-2 gap-x-8 gap-y-2 text-sm",children:[S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsx("span",{className:"text-gray-400",children:"Region:"}),S.jsx("span",{className:"text-white",children:null==(a=i.features.find((e=>"Region"===e.label)))?void 0:a.value})]}),S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsx("span",{className:"text-gray-400",children:"Platform:"}),S.jsx("span",{className:"text-white",children:null==(o=i.features.find((e=>"Platform"===e.label)))?void 0:o.value})]}),S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsx("span",{className:"text-gray-400",children:"Rating:"}),S.jsx("span",{className:"text-white",children:null==(l=i.features.find((e=>"Rating"===e.label)))?void 0:l.value})]}),S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsx("span",{className:"text-gray-400",children:"Genre:"}),S.jsx("span",{className:"text-white",children:null==(c=i.features.find((e=>"Genre"===e.label)))?void 0:c.value})]}),S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsx("span",{className:"text-gray-400",children:"Release:"}),S.jsx("span",{className:"text-white",children:null==(u=i.features.find((e=>"Release"===e.label)))?void 0:u.value})]}),S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsx("span",{className:"text-gray-400",children:"Playtime:"}),S.jsx("span",{className:"text-white",children:null==(h=i.features.find((e=>"Playtime"===e.label)))?void 0:h.value})]})]}),S.jsxs("div",{className:"space-y-3",children:[S.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[S.jsx(Vg,{className:"h-5 w-5"}),S.jsx("span",{className:"font-semibold",children:"Recommended Specs (1080p High/Ultra):"})]}),S.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[S.jsxs("div",{children:[S.jsx("span",{className:"text-gray-400",children:"CPU:"}),S.jsx("p",{className:"text-white",children:i.requirements.cpu})]}),S.jsxs("div",{children:[S.jsx("span",{className:"text-gray-400",children:"GPU:"}),S.jsx("p",{className:"text-white",children:i.requirements.gpu})]}),S.jsxs("div",{children:[S.jsx("span",{className:"text-gray-400",children:"RAM:"}),S.jsx("p",{className:"text-white",children:i.requirements.ram})]}),S.jsxs("div",{children:[S.jsx("span",{className:"text-gray-400",children:"Storage:"}),S.jsx("p",{className:"text-white",children:i.requirements.storage})]})]})]}),S.jsxs("div",{className:"pt-6 border-t border-gray-800 space-y-4",children:[S.jsxs("div",{className:"flex items-center justify-between bg-gray-800/50 p-3 rounded-lg",children:[S.jsx("span",{className:"text-gray-300",children:"Username:"}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("span",{className:"text-gray-100",children:e}),S.jsx("button",{onClick:()=>r(e,"username"),className:"p-1.5 hover:bg-gray-700/50 rounded-lg transition-all duration-300",children:S.jsx(Pg,{className:"h-5 w-5 text-gray-400"})}),"username"===n&&S.jsx("span",{className:`text-xs ${s.textAccent}`,children:"Copied!"})]})]}),S.jsxs("div",{className:"flex items-center justify-between bg-gray-800/50 p-3 rounded-lg",children:[S.jsx("span",{className:"text-gray-300",children:"Password:"}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("span",{className:"text-gray-100",children:t}),S.jsx("button",{onClick:()=>r(t,"password"),className:"p-1.5 hover:bg-gray-700/50 rounded-lg transition-all duration-300",children:S.jsx(Pg,{className:"h-5 w-5 text-gray-400"})}),"password"===n&&S.jsx("span",{className:`text-xs ${s.textAccent}`,children:"Copied!"})]})]})]})]})}function ev({game:e,rarityConfig:t}){return S.jsxs("div",{className:"absolute bottom-4 left-4 space-y-2",children:[S.jsx("h3",{className:"text-2xl font-bold text-white",children:e}),S.jsx("span",{className:`inline-block px-4 py-1.5 rounded-full ${t.bgColor} ${t.textColor} text-sm font-bold tracking-wider shadow-lg border ${t.borderColor}`,children:t.label})]})}function tv({account:e}){var t,n,r,s,i,a;return S.jsxs("div",{className:"space-y-6 mb-6",children:[S.jsx("div",{className:"space-y-4",children:e.description.split("\n").map(((e,t)=>S.jsx("p",{className:"text-gray-300 flex items-center gap-2",children:e},t)))}),S.jsxs("div",{className:"grid grid-cols-2 gap-x-8 gap-y-2 text-sm",children:[S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx(Yg,{className:"h-5 w-5 text-gray-400"}),S.jsx("span",{className:"text-gray-400",children:"Region:"})]}),S.jsx("span",{className:"text-white",children:null==(t=e.features.find((e=>"Region"===e.label)))?void 0:t.value})]}),S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx(Vg,{className:"h-5 w-5 text-gray-400"}),S.jsx("span",{className:"text-gray-400",children:"Platform:"})]}),S.jsx("span",{className:"text-white",children:null==(n=e.features.find((e=>"Platform"===e.label)))?void 0:n.value})]}),S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx(by,{className:"h-5 w-5 text-gray-400"}),S.jsx("span",{className:"text-gray-400",children:"Rating:"})]}),S.jsx("span",{className:"text-white",children:null==(r=e.features.find((e=>"Rating"===e.label)))?void 0:r.value})]}),S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx(Xg,{className:"h-5 w-5 text-gray-400"}),S.jsx("span",{className:"text-gray-400",children:"Genre:"})]}),S.jsx("span",{className:"text-white",children:null==(s=e.features.find((e=>"Genre"===e.label)))?void 0:s.value})]}),S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx(bg,{className:"h-5 w-5 text-gray-400"}),S.jsx("span",{className:"text-gray-400",children:"Release:"})]}),S.jsx("span",{className:"text-white",children:null==(i=e.features.find((e=>"Release"===e.label)))?void 0:i.value})]}),S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx(Mg,{className:"h-5 w-5 text-gray-400"}),S.jsx("span",{className:"text-gray-400",children:"Playtime:"})]}),S.jsx("span",{className:"text-white",children:null==(a=e.features.find((e=>"Playtime"===e.label)))?void 0:a.value})]})]}),S.jsxs("div",{className:"space-y-4",children:[S.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[S.jsx(Vg,{className:"h-5 w-5"}),S.jsx("span",{className:"font-semibold",children:"Recommended Specs (1080p High/Ultra):"})]}),S.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[S.jsxs("div",{className:"space-y-4",children:[S.jsxs("div",{className:"flex items-start gap-3",children:[S.jsx($g,{className:"h-5 w-5 text-gray-400 mt-1 flex-shrink-0"}),S.jsxs("div",{children:[S.jsx("span",{className:"text-gray-400 text-sm",children:"CPU:"}),S.jsx("p",{className:"text-white text-sm",children:e.requirements.cpu})]})]}),S.jsxs("div",{className:"flex items-start gap-3",children:[S.jsx(Uy,{className:"h-5 w-5 text-gray-400 mt-1 flex-shrink-0"}),S.jsxs("div",{children:[S.jsx("span",{className:"text-gray-400 text-sm",children:"GPU:"}),S.jsx("p",{className:"text-white text-sm",children:e.requirements.gpu})]})]})]}),S.jsxs("div",{className:"space-y-4",children:[S.jsxs("div",{className:"flex items-start gap-3",children:[S.jsx(dy,{className:"h-5 w-5 text-gray-400 mt-1 flex-shrink-0"}),S.jsxs("div",{children:[S.jsx("span",{className:"text-gray-400 text-sm",children:"RAM:"}),S.jsx("p",{className:"text-white text-sm",children:e.requirements.ram})]})]}),S.jsxs("div",{className:"flex items-start gap-3",children:[S.jsx(Rg,{className:"h-5 w-5 text-gray-400 mt-1 flex-shrink-0"}),S.jsxs("div",{children:[S.jsx("span",{className:"text-gray-400 text-sm",children:"Storage:"}),S.jsx("p",{className:"text-white text-sm",children:e.requirements.storage})]})]})]})]})]})]})}function nv({account:t}){const[n,r]=e.useState(null),[s,i]=e.useState(!1),[a,o]=e.useState(!1),[l,c]=e.useState(""),u=gg[t.rarity],h=pg[t.rarity];return S.jsxs(S.Fragment,{children:[S.jsxs(f.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},whileHover:{scale:1.02},className:"glass-effect rounded-xl overflow-hidden",style:{boxShadow:h.boxShadow,animation:`${h.animation} 3s ease-in-out infinite`},children:[S.jsxs("div",{className:"relative",children:[S.jsx("div",{className:"w-full h-48 overflow-hidden",children:S.jsx("img",{src:t.imageUrl,alt:t.game,className:"w-full h-full object-cover"})}),S.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black to-transparent"}),S.jsx(ev,{game:t.game,rarityConfig:u})]}),S.jsx("div",{className:"p-6",children:s?S.jsx(Zy,{username:t.username,password:t.password,copied:n,onCopy:(e,t)=>{navigator.clipboard.writeText(e),r(t),setTimeout((()=>r(null)),2e3)},rarityConfig:u,account:t}):S.jsxs(S.Fragment,{children:[S.jsx(tv,{account:t}),S.jsxs(f.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>o(!0),className:`w-full px-4 py-3 rounded-lg text-white transition-all duration-300 flex items-center justify-center gap-2 ${u.bgColor} hover:brightness-110`,style:{boxShadow:`0 0 20px ${u.glowColor}40`},children:[S.jsx(sy,{className:"h-5 w-5"}),S.jsx("span",{children:"View Account Details"})]})]})})]}),S.jsx(Yy,{isOpen:a,onClose:()=>{o(!1),c("")},onSubmit:e=>{e===u.pin?(i(!0),o(!1),c("")):c("Incorrect PIN")},rarity:t.rarity,error:l})]})}function rv({currentPage:e,totalPages:t,onPageChange:n}){return S.jsxs("div",{className:"flex justify-center items-center gap-4 mt-12",children:[S.jsx(f.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>n(e-1),disabled:1===e,className:"p-2 rounded-lg bg-red-600 text-white disabled:opacity-50 disabled:cursor-not-allowed",children:S.jsx(Ng,{className:"h-5 w-5"})}),S.jsx("div",{className:"flex gap-2",children:[...Array(t)].map(((t,r)=>S.jsx(f.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>n(r+1),className:"w-10 h-10 rounded-lg "+(e===r+1?"bg-red-600 text-white":"bg-black/50 text-gray-300 hover:bg-black/70"),children:r+1},r)))}),S.jsx(f.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>n(e+1),disabled:e===t,className:"p-2 rounded-lg bg-red-600 text-white disabled:opacity-50 disabled:cursor-not-allowed",children:S.jsx(Cg,{className:"h-5 w-5"})})]})}function sv({accounts:e,currentPage:t,onPageChange:n}){const r=Math.ceil(e.length/21),s=21*(t-1),i=s+21,a=e.slice(s,i);return S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:a.map(((e,t)=>S.jsx(nv,{account:e},t)))}),r>1&&S.jsx(rv,{currentPage:t,totalPages:r,onPageChange:n})]})}const iv=[{label:"All",value:"all"},{label:"Mythic",value:"mythic"},{label:"Legendary",value:"legendary"},{label:"Epic",value:"epic"},{label:"Rare",value:"rare"},{label:"Uncommon",value:"uncommon"}];function av({selectedCategory:e,onCategoryChange:t,counts:n}){return S.jsx("div",{className:"flex flex-wrap gap-4 mb-8 justify-center",children:iv.map((r=>S.jsxs(f.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>t(r.value),className:"px-4 py-2 rounded-lg transition-all duration-300 "+(e===r.value?"bg-red-600 text-white":"bg-black/50 text-gray-300 hover:bg-black/70"),children:[r.label,n[r.value]>0&&S.jsx("span",{className:"ml-2 px-2 py-0.5 bg-black/30 rounded-full text-sm",children:n[r.value]})]},r.value)))})}const ov={mythic:1,legendary:2,epic:3,rare:4,uncommon:5,common:6};function lv(){const[t,n]=e.useState(""),[r,s]=e.useState("all"),[i,a]=e.useState(1),o=e.useMemo((()=>{let e=fg;return"all"!==r&&(e=e.filter((e=>e.rarity===r))),t&&(e=e.filter((e=>e.game.toLowerCase().includes(t.toLowerCase())||e.features.some((e=>e.value.toLowerCase().includes(t.toLowerCase())))))),n=e,[...n].sort(((e,t)=>ov[e.rarity]-ov[t.rarity]));var n}),[t,r]),l=e.useMemo((()=>{const e={all:fg.length,mythic:0,legendary:0,epic:0,rare:0,uncommon:0};return fg.forEach((t=>{e[t.rarity]++})),e}),[]);return S.jsxs(f.div,{initial:{opacity:0},animate:{opacity:1},className:"min-h-screen",children:[S.jsx(Jy,{}),S.jsxs("div",{className:"max-w-7xl mx-auto px-6 pb-16",children:[S.jsx(Wy,{onSearch:e=>{n(e),a(1)},placeholder:"Search games..."}),S.jsx(Qy,{}),S.jsx(av,{selectedCategory:r,onCategoryChange:e=>{s(e),a(1)},counts:l}),S.jsx(sv,{accounts:o,currentPage:i,onPageChange:a})]})]})}function cv({method:e}){return S.jsxs("div",{className:"space-y-6",children:[S.jsx("div",{className:"space-y-4",children:e.steps.map(((e,t)=>S.jsxs("div",{className:"flex items-start gap-3",children:[S.jsx("div",{className:"h-6 w-6 rounded-full bg-red-500/20 flex items-center justify-center flex-shrink-0 mt-1 font-bold text-white",children:t+1}),S.jsx("span",{className:"text-gray-300",children:e})]},t)))}),"working"===e.status&&S.jsxs("div",{className:"flex items-center gap-2 text-green-500",children:[S.jsx(Tg,{className:"h-5 w-5"}),S.jsx("span",{className:"text-sm font-semibold",children:"Currently Working"})]}),S.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-4",children:S.jsxs("div",{className:"flex items-start gap-3",children:[S.jsx(Wg,{className:"h-6 w-6 text-yellow-500 flex-shrink-0"}),S.jsx("p",{className:"text-yellow-200 text-sm",children:e.warning})]})})]})}function uv({method:t}){const[n,r]=e.useState(!1),[s,i]=e.useState(!1),[a,o]=e.useState(""),l=gg[t.rarity],c=pg[t.rarity];return S.jsxs(S.Fragment,{children:[S.jsx(f.div,{whileHover:{scale:1.02},className:"glass-effect rounded-xl overflow-hidden h-full",style:{boxShadow:c.boxShadow,animation:`${c.animation} 3s ease-in-out infinite`},children:S.jsxs("div",{className:"p-6 flex flex-col h-full",children:[S.jsxs("div",{className:"flex items-center justify-between mb-4",children:[S.jsx("h3",{className:"text-xl font-bold text-white",children:t.title}),S.jsx("div",{className:`\n              px-3 py-1 rounded-full ${l.bgColor} ${l.textColor}\n              text-sm font-bold tracking-wider shadow-lg border ${l.borderColor}\n            `,children:l.label})]}),S.jsx("div",{className:"flex-grow",children:n?S.jsx(cv,{method:t}):S.jsx(f.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>i(!0),className:`w-full px-4 py-3 rounded-lg text-white transition-all duration-300 flex items-center justify-center gap-2 ${l.bgColor} hover:brightness-110`,style:{boxShadow:`0 0 20px ${l.glowColor}40`},children:"View Method"})})]})}),S.jsx(Yy,{isOpen:s,onClose:()=>{i(!1),o("")},onSubmit:e=>{e===t.pin?(r(!0),i(!1),o("")):o("Incorrect PIN")},rarity:t.rarity,error:a})]})}const hv=[{id:"xbox-gamepass",title:"Xbox Game Pass Method",rarity:"epic",pin:"4617",steps:["Log in to an account that has Game Pass","Download the game you want","Play it for approximately 5 minutes, then exit the game","Log in to your main account and you will be able to play the game without owning Game Pass"],warning:"I'm not responsible for any errors or issues if you didn't follow my instructions correctly",status:"working"},{id:"steam-family",title:"Steam Family Sharing Method",rarity:"legendary",pin:"2716",steps:["Add a friend who owns the game to your Family Sharing","Enable Family Library Sharing in Steam settings","Wait for the games to become available","You can now play the shared games when your friend is not playing"],warning:"Make sure to follow Steam's Family Sharing guidelines to avoid any issues",status:"working"},{id:"epic-games",title:"Epic Games Free Games Method",rarity:"rare",pin:"8293",steps:["Create an Epic Games account","Visit the store every Thursday","Claim the free games within the available timeframe","The games will be permanently added to your library"],warning:"Don't forget to claim the games before they rotate out",status:"working"}];function dv(){return S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:hv.map(((e,t)=>S.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},children:S.jsx(uv,{method:e})},e.id)))})}function mv(){return S.jsx(Xy,{title:"Game Methods",subtitle:"Discover Various Gaming Methods and Techniques",count:hv.length,countLabel:"Methods"})}function fv(){return S.jsxs(f.div,{initial:{opacity:0},animate:{opacity:1},className:"min-h-screen",children:[S.jsx(mv,{}),S.jsx("div",{className:"max-w-7xl mx-auto px-6 pb-16",children:S.jsx(dv,{})})]})}const pv=[{icon:Ug,title:"Instant Play",description:"No downloads required. Start playing your favorite games instantly on GeForce NOW."},{icon:Kg,title:"Play Anywhere",description:"Access your games on any device - mobile, tablet, or computer."},{icon:Vg,title:"RTX Graphics",description:"Experience ray tracing and DLSS with NVIDIA's powerful cloud infrastructure."},{icon:My,title:"Low Latency",description:"Enjoy responsive gameplay with minimal input lag across supported regions."}];function gv(){return S.jsx(f.div,{initial:{opacity:0},animate:{opacity:1},className:"min-h-screen pt-24",children:S.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-12",children:[S.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-16",children:[S.jsx("h1",{className:"text-5xl font-bold text-red-500 mb-6",children:"GeForce NOW Gaming"}),S.jsx("p",{className:"text-xl text-gray-400 max-w-2xl mx-auto",children:"Experience the future of gaming with NVIDIA GeForce NOW. Play your favorite games on any device with our cloud-ready accounts."})]}),S.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-16",children:[S.jsxs(f.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"glass-effect cyber-border p-8 rounded-xl",children:[S.jsx("h3",{className:"text-2xl font-bold text-red-500 mb-4",children:"Why GeForce NOW?"}),S.jsxs("ul",{className:"space-y-4",children:[S.jsxs("li",{className:"flex items-start gap-3",children:[S.jsx("span",{className:"h-6 w-6 rounded-full bg-red-500/20 flex items-center justify-center flex-shrink-0 mt-1",children:"✓"}),S.jsx("span",{className:"text-gray-300",children:"Play on low-end PCs and laptops"})]}),S.jsxs("li",{className:"flex items-start gap-3",children:[S.jsx("span",{className:"h-6 w-6 rounded-full bg-red-500/20 flex items-center justify-center flex-shrink-0 mt-1",children:"✓"}),S.jsx("span",{className:"text-gray-300",children:"Access to powerful NVIDIA RTX graphics"})]}),S.jsxs("li",{className:"flex items-start gap-3",children:[S.jsx("span",{className:"h-6 w-6 rounded-full bg-red-500/20 flex items-center justify-center flex-shrink-0 mt-1",children:"✓"}),S.jsx("span",{className:"text-gray-300",children:"No game downloads or updates needed"})]}),S.jsxs("li",{className:"flex items-start gap-3",children:[S.jsx("span",{className:"h-6 w-6 rounded-full bg-red-500/20 flex items-center justify-center flex-shrink-0 mt-1",children:"✓"}),S.jsx("span",{className:"text-gray-300",children:"Play across multiple devices seamlessly"})]})]})]}),S.jsxs(f.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"glass-effect cyber-border p-8 rounded-xl",children:[S.jsx("h3",{className:"text-2xl font-bold text-red-500 mb-4",children:"Our GeForce NOW Benefits"}),S.jsxs("ul",{className:"space-y-4",children:[S.jsxs("li",{className:"flex items-start gap-3",children:[S.jsx("span",{className:"h-6 w-6 rounded-full bg-red-500/20 flex items-center justify-center flex-shrink-0 mt-1",children:"✓"}),S.jsx("span",{className:"text-gray-300",children:"Verified GeForce NOW compatible accounts"})]}),S.jsxs("li",{className:"flex items-start gap-3",children:[S.jsx("span",{className:"h-6 w-6 rounded-full bg-red-500/20 flex items-center justify-center flex-shrink-0 mt-1",children:"✓"}),S.jsx("span",{className:"text-gray-300",children:"Instant activation and setup"})]}),S.jsxs("li",{className:"flex items-start gap-3",children:[S.jsx("span",{className:"h-6 w-6 rounded-full bg-red-500/20 flex items-center justify-center flex-shrink-0 mt-1",children:"✓"}),S.jsx("span",{className:"text-gray-300",children:"Premium support for cloud gaming"})]}),S.jsxs("li",{className:"flex items-start gap-3",children:[S.jsx("span",{className:"h-6 w-6 rounded-full bg-red-500/20 flex items-center justify-center flex-shrink-0 mt-1",children:"✓"}),S.jsx("span",{className:"text-gray-300",children:"Regular account maintenance"})]})]})]})]}),S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:pv.map(((e,t)=>S.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2+.1*t},className:"feature-card text-center",children:[S.jsx(e.icon,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),S.jsx("h3",{className:"text-xl font-semibold text-red-400 mb-2",children:e.title}),S.jsx("p",{className:"text-gray-400",children:e.description})]},t)))})]})})}const yv=[{icon:Xg,title:"Movies",description:"Access a vast library of movies from various sources"},{icon:ky,title:"TV Shows",description:"Stream your favorite TV series and shows"},{icon:uy,title:"Add-ons",description:"Enhance your experience with community add-ons"}];function vv(){return S.jsx(f.div,{initial:{opacity:0},animate:{opacity:1},className:"min-h-screen pt-24",children:S.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-12",children:[S.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-16",children:[S.jsx("h1",{className:"text-5xl font-bold text-red-500 mb-6",children:"Stremio Streaming"}),S.jsx("p",{className:"text-xl text-gray-400 max-w-2xl mx-auto",children:"Enhance your Stremio experience with our curated collection of add-ons and streaming sources."})]}),S.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-16",children:[S.jsxs(f.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"glass-effect cyber-border p-8 rounded-xl",children:[S.jsx("h3",{className:"text-2xl font-bold text-red-500 mb-4",children:"About Stremio"}),S.jsx("p",{className:"text-gray-300 mb-6",children:"Stremio is a modern media center that's a one-stop solution for your video entertainment. Watch everything you want in one place."}),S.jsxs("a",{href:"https://stremio-addons.netlify.app/",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-red-500 hover:text-red-400 transition-colors",children:["Browse Add-ons",S.jsx(vg,{className:"h-5 w-5"})]})]}),S.jsxs(f.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"glass-effect cyber-border p-8 rounded-xl",children:[S.jsx("h3",{className:"text-2xl font-bold text-red-500 mb-4",children:"Getting Started"}),S.jsxs("ul",{className:"space-y-4",children:[S.jsxs("li",{className:"flex items-start gap-3",children:[S.jsx("span",{className:"h-6 w-6 rounded-full bg-red-500/20 flex items-center justify-center flex-shrink-0 mt-1",children:"1"}),S.jsx("span",{className:"text-gray-300",children:"Download and install Stremio"})]}),S.jsxs("li",{className:"flex items-start gap-3",children:[S.jsx("span",{className:"h-6 w-6 rounded-full bg-red-500/20 flex items-center justify-center flex-shrink-0 mt-1",children:"2"}),S.jsx("span",{className:"text-gray-300",children:"Visit the add-ons catalog"})]}),S.jsxs("li",{className:"flex items-start gap-3",children:[S.jsx("span",{className:"h-6 w-6 rounded-full bg-red-500/20 flex items-center justify-center flex-shrink-0 mt-1",children:"3"}),S.jsx("span",{className:"text-gray-300",children:"Install your preferred add-ons"})]}),S.jsxs("li",{className:"flex items-start gap-3",children:[S.jsx("span",{className:"h-6 w-6 rounded-full bg-red-500/20 flex items-center justify-center flex-shrink-0 mt-1",children:"4"}),S.jsx("span",{className:"text-gray-300",children:"Start streaming your content"})]})]})]})]}),S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:yv.map(((e,t)=>S.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2+.1*t},className:"feature-card text-center",children:[S.jsx(e.icon,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),S.jsx("h3",{className:"text-xl font-semibold text-red-400 mb-2",children:e.title}),S.jsx("p",{className:"text-gray-400",children:e.description})]},t)))})]})})}const wv=[{id:"epicgames",name:"Epic Games",description:"Premium Epic Games accounts with exclusive games",rarity:"mythic",status:"outOfStock",type:"gaming",link:"https://mega.nz/folder/example1",pin:"5026"},{id:"ubisoft",name:"Ubisoft",description:"Access to premium Ubisoft games and exclusive content",rarity:"mythic",status:"inStock",type:"gaming",link:"https://mega.nz/folder/example2",pin:"5026"},{id:"ea",name:"EA",description:"Premium EA accounts with latest games",rarity:"mythic",status:"outOfStock",type:"gaming",link:"https://mega.nz/folder/example3",pin:"5026"},{id:"battlenet",name:"Battle.net",description:"Access to Blizzard games and content",rarity:"mythic",status:"outOfStock",type:"gaming",link:"https://mega.nz/folder/example4",pin:"5026"},{id:"geforce-now",name:"GeForce Now",description:"Cloud gaming service with RTX support",rarity:"mythic",status:"outOfStock",type:"gaming",link:"https://mega.nz/folder/example5",pin:"5026"},{id:"playstation-plus",name:"PlayStation Plus",description:"Premium PlayStation Plus memberships",rarity:"mythic",status:"outOfStock",type:"gaming",link:"https://mega.nz/folder/example6",pin:"5026"},{id:"netflix",name:"Netflix",description:"Premium Netflix accounts with 4K UHD",rarity:"mythic",status:"outOfStock",type:"streaming",link:"https://mega.nz/folder/example7",pin:"5026"},{id:"roblox",name:"Roblox",description:"Premium Roblox accounts with Robux",rarity:"mythic",status:"unknown",type:"gaming",link:"https://mega.nz/folder/example8",pin:"5026"},{id:"chatgpt",name:"ChatGPT",description:"Premium ChatGPT accounts with GPT-4 access",rarity:"mythic",status:"unknown",type:"ai",link:"https://mega.nz/folder/example9",pin:"5026"},{id:"rockstar",name:"Rockstar",description:"Access to GTA and Red Dead Redemption",rarity:"legendary",status:"outOfStock",type:"gaming",link:"https://mega.nz/folder/example10",pin:"2716"},{id:"valorant",name:"Valorant",description:"Premium Valorant accounts with rare skins",rarity:"legendary",status:"outOfStock",type:"gaming",link:"https://mega.nz/folder/example11",pin:"2716"},{id:"amazon-prime",name:"Amazon Prime",description:"Full Amazon Prime membership access",rarity:"legendary",status:"outOfStock",type:"streaming",link:"https://mega.nz/folder/example12",pin:"2716"},{id:"duolingo",name:"Duolingo",description:"Premium language learning accounts",rarity:"legendary",status:"unknown",type:"education",link:"https://mega.nz/folder/example13",pin:"2716"},{id:"spotify",name:"Spotify",description:"Premium music streaming accounts",rarity:"legendary",status:"unknown",type:"streaming",link:"https://mega.nz/folder/example14",pin:"2716"},{id:"xbox-gamepass",name:"Xbox Game Pass",description:"Access to Xbox Game Pass library",rarity:"epic",status:"outOfStock",type:"gaming",link:"https://mega.nz/folder/example15",pin:"4617"},{id:"hbo-max",name:"HBO Max",description:"Premium streaming service with exclusive HBO content",rarity:"epic",status:"inStock",type:"streaming",link:"https://mega.nz/folder/example16",pin:"4617"},{id:"vpn",name:"VPN Services",description:"Premium VPN accounts for secure browsing",rarity:"epic",status:"inStock",type:"security",link:"https://mega.nz/folder/example17",pin:"4617"},{id:"iptv",name:"IPTV",description:"Premium IPTV service access",rarity:"epic",status:"inStock",type:"streaming",link:"https://mega.nz/folder/example18",pin:"4617"},{id:"disney-plus",name:"Disney+",description:"Stream Disney, Marvel, Star Wars content and more",rarity:"rare",status:"inStock",type:"streaming",link:"https://mega.nz/folder/example19",pin:"8293"},{id:"crunchyroll",name:"Crunchyroll",description:"Premium anime streaming service with simulcasts",rarity:"rare",status:"inStock",type:"streaming",link:"https://mega.nz/folder/example20",pin:"8293"},{id:"proxy",name:"Proxy Premium",description:"Premium proxy services for enhanced privacy",rarity:"rare",status:"inStock",type:"security",link:"https://mega.nz/folder/example21",pin:"8293"},{id:"league-of-legends",name:"League of Legends",description:"Premium LoL accounts with rare skins and champions",rarity:"uncommon",status:"inStock",type:"gaming",link:"https://mega.nz/folder/example22",pin:"2222"},{id:"hotmail",name:"Hotmail",description:"Premium Hotmail accounts for various purposes",rarity:"common",status:"inStock",type:"email",link:"https://mega.nz/folder/example23",pin:"1111"}];function bv({service:t}){const[n,r]=e.useState(!1),[s,i]=e.useState(""),a=gg[t.rarity],o=pg[t.rarity];return S.jsxs(S.Fragment,{children:[S.jsx(f.div,{whileHover:{scale:1.02},className:"glass-effect rounded-xl p-6 h-full",style:{boxShadow:o.boxShadow,animation:`${o.animation} 3s ease-in-out infinite`},children:S.jsxs("div",{className:"flex flex-col h-full",children:[S.jsxs("div",{className:"flex justify-between items-start mb-4",children:[S.jsx("h3",{className:"text-xl font-bold text-white",children:t.name}),S.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${a.bgColor} ${a.textColor} border ${a.borderColor}`,children:a.label})]}),S.jsx("p",{className:"text-gray-400 mb-6 flex-grow",children:t.description}),S.jsxs("div",{className:"flex justify-between items-center",children:[S.jsx("span",{className:"px-3 py-1 rounded-full text-sm "+("inStock"===t.status?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-red-500/20 text-red-400 border border-red-500/30"),children:"inStock"===t.status?"In Stock":"Out of Stock"}),S.jsxs(f.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>r(!0),disabled:"inStock"!==t.status,className:"px-4 py-2 rounded-lg transition-all duration-300 flex items-center gap-2 "+("inStock"===t.status?`${a.bgColor} ${a.textColor} hover:brightness-110`:"bg-gray-800 text-gray-500 cursor-not-allowed"),children:[S.jsx(sy,{className:"h-5 w-5"}),S.jsx("span",{children:"Access"})]})]})]})}),S.jsx(Yy,{isOpen:n,onClose:()=>{r(!1),i("")},onSubmit:e=>{e===t.pin?(window.open(t.link,"_blank"),r(!1),i("")):i("Incorrect PIN")},rarity:t.rarity,error:s})]})}function xv(){return S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:wv.map(((e,t)=>S.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},children:S.jsx(bv,{service:e})},e.id)))})}function _v(){return S.jsx(Xy,{title:"Premium Accounts",subtitle:"Access our exclusive collection of premium gaming and streaming accounts",count:wv.length,countLabel:"Premium Accounts"})}function Iv(){return S.jsxs(f.div,{initial:{opacity:0},animate:{opacity:1},className:"min-h-screen",children:[S.jsx(_v,{}),S.jsx("div",{className:"max-w-7xl mx-auto px-6 pb-16",children:S.jsx(xv,{})})]})}const kv=[{name:"GeForce NOW",description:"Cloud Gaming Service",icon:Ug,path:"/geforce-now"},{name:"Stremio",description:"Streaming Platform",icon:Xg,path:"/stremio"},{name:"Members",description:"Community Members",icon:Ny,path:"/members"},{name:"Feedback",description:"Support & Suggestions",icon:_g,path:"/feedback"}];function Sv(){return S.jsx(f.div,{initial:{opacity:0},animate:{opacity:1},className:"min-h-screen pt-24",children:S.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-12",children:[S.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-16",children:[S.jsx("h1",{className:"text-4xl font-bold text-red-500 mb-4",children:"Other Services"}),S.jsx("p",{className:"text-xl text-gray-400 max-w-2xl mx-auto",children:"Explore our additional services and community features"})]}),S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:kv.map(((e,t)=>S.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},children:S.jsx(s,{to:e.path,children:S.jsxs(f.div,{whileHover:{scale:1.02},className:"glass-effect rounded-xl p-8 h-full border border-white/10 hover:bg-white/5 transition-all duration-300",children:[S.jsx(e.icon,{className:"h-12 w-12 text-red-500 mb-4"}),S.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:e.name}),S.jsx("p",{className:"text-gray-300",children:e.description})]})})},e.name)))})]})})}function Tv(){const{members:t,onlineCount:n,isLoading:r}=function(){const[t,n]=e.useState([{id:"1",username:"Andres_rios",role:"Owner",discordId:"123456789012345678",joinDate:"2024-01-15",isOnline:!0},{id:"2",username:"MarcSpector",role:"Owner",discordId:"987654321098765432",joinDate:"2024-01-15",isOnline:!0}]),[r,s]=e.useState(2),[i,a]=e.useState(!0),[o,l]=e.useState(null);return e.useEffect((()=>{const e=qd(xd(Uh(ng,ig),Td("joinDate","desc")),(e=>{const t=[];e.forEach((e=>{t.push({id:e.id,...e.data()})})),n(t),a(!1)}),(e=>{console.error("Error fetching members:",e),l(e.message),a(!1)})),t=qd(xd(Uh(ng,sg)),(e=>{const t=e.docs.filter((e=>e.data().isOnline)).length;s(t)}));return()=>{e(),t()}}),[]),{members:t,onlineCount:r,isLoading:i,error:o,updateMemberStatus:async(e,t)=>{try{const n=Fh(ng,sg,e);await Gd(n,{isOnline:t,lastSeen:(new Date).toISOString()})}catch(n){console.error("Error updating member status:",n)}}}}();return r?S.jsx("div",{className:"min-h-screen pt-24 flex items-center justify-center",children:S.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-500"})}):S.jsx("div",{className:"min-h-screen pt-24",children:S.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-12",children:[S.jsxs(f.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center mb-12",children:[S.jsx("h1",{className:"text-4xl font-bold text-red-500 mb-4",children:"Community Members"}),S.jsx("p",{className:"text-gray-400 max-w-2xl mx-auto",children:"Meet our growing community of gamers and enthusiasts"}),S.jsx("div",{className:"mt-4 inline-block px-4 py-2 bg-red-500/20 border border-red-500/30 rounded-lg",children:S.jsxs("span",{className:"text-white font-bold",children:[t.length," Members • ",n," Online"]})})]}),S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map((e=>S.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"glass-effect rounded-xl p-6",children:S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsxs("div",{className:"relative",children:[e.profilePic?S.jsx("img",{src:e.profilePic,alt:e.username,className:"w-12 h-12 rounded-full object-cover"}):S.jsx("div",{className:"w-12 h-12 rounded-full bg-red-500/10 flex items-center justify-center",children:S.jsx(Py,{className:"w-6 h-6 text-red-500"})}),S.jsx("span",{className:"absolute -bottom-1 -right-1 w-3 h-3 rounded-full border-2 border-black "+(e.isOnline?"bg-green-500":"bg-gray-500")})]}),S.jsxs("div",{className:"flex-1",children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("h3",{className:"text-lg font-semibold text-white",children:e.username}),"Owner"===e.role&&S.jsx(by,{className:"w-5 h-5 text-yellow-500"})]}),S.jsxs("div",{className:"text-sm text-gray-400 mb-2",children:["Discord ID: ",e.discordId]}),S.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[S.jsx("span",{className:"px-2 py-0.5 rounded-full "+("Owner"===e.role?"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30":"bg-blue-500/20 text-blue-400"),children:e.role}),S.jsxs("span",{className:"text-gray-400 flex items-center gap-1",children:[S.jsx(Mg,{className:"w-4 h-4"}),e.isOnline?"Now":e.lastSeen||"Offline"]})]}),S.jsxs("div",{className:"mt-2 text-sm text-gray-400",children:["Joined ",new Date(e.joinDate).toLocaleDateString()]})]})]})},e.id)))})]})})}const Ev=e=>{let t;const n=new Set,r=(e,r)=>{const s="function"==typeof e?e(t):e;if(!Object.is(s,t)){const e=t;t=(null!=r?r:"object"!=typeof s||null===s)?s:Object.assign({},t,s),n.forEach((n=>n(t,e)))}},s=()=>t,i={setState:r,getState:s,getInitialState:()=>a,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{n.clear()}},a=t=e(r,s,i);return i};var Nv={exports:{}},Av={},Cv={exports:{}},jv={},Rv=e;var Dv="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Pv=Rv.useState,Ov=Rv.useEffect,Mv=Rv.useLayoutEffect,Lv=Rv.useDebugValue;function Uv(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Dv(e,n)}catch(r){return!0}}var Fv="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=Pv({inst:{value:n,getSnapshot:t}}),s=r[0].inst,i=r[1];return Mv((function(){s.value=n,s.getSnapshot=t,Uv(s)&&i({inst:s})}),[e,n,t]),Ov((function(){return Uv(s)&&i({inst:s}),e((function(){Uv(s)&&i({inst:s})}))}),[e]),Lv(n),n};jv.useSyncExternalStore=void 0!==Rv.useSyncExternalStore?Rv.useSyncExternalStore:Fv,Cv.exports=jv;var Vv=Cv.exports,Bv=e,$v=Vv;
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gv="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},qv=$v.useSyncExternalStore,zv=Bv.useRef,Kv=Bv.useEffect,Hv=Bv.useMemo,Wv=Bv.useDebugValue;Av.useSyncExternalStoreWithSelector=function(e,t,n,r,s){var i=zv(null);if(null===i.current){var a={hasValue:!1,value:null};i.current=a}else a=i.current;i=Hv((function(){function e(e){if(!l){if(l=!0,i=e,e=r(e),void 0!==s&&a.hasValue){var t=a.value;if(s(t,e))return o=t}return o=e}if(t=o,Gv(i,e))return t;var n=r(e);return void 0!==s&&s(t,n)?t:(i=e,o=n)}var i,o,l=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]}),[t,n,r,s]);var o=qv(e,i[0],i[1]);return Kv((function(){a.hasValue=!0,a.value=o}),[o]),Wv(o),o},Nv.exports=Av;const Qv=i(Nv.exports),{useDebugValue:Xv}=a,{useSyncExternalStoreWithSelector:Jv}=Qv;const Yv=e=>e;const Zv=e=>{const t="function"==typeof e?(e=>e?Ev(e):Ev)(e):e,n=(e,n)=>function(e,t=Yv,n){const r=Jv(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Xv(r),r}(t,e,n);return Object.assign(n,t),n},ew=e=>e?Zv(e):Zv,tw=ew(((e,t)=>({feedbacks:[],isLoading:!0,error:null,initialize:()=>{try{const t=qd(xd(Uh(ng,rg),Td("timestamp","desc"),Nd(50)),(t=>{const n=[];t.forEach((e=>{n.push({id:e.id,...e.data()})})),e({feedbacks:n,isLoading:!1})}),(t=>{console.error("Error fetching feedbacks:",t),e({error:t.message,isLoading:!1})}));return()=>{t(),e({feedbacks:[],isLoading:!0,error:null})}}catch(tk){return console.error("Error initializing feedback store:",tk),e({error:tk.message,isLoading:!1}),()=>{}}},addFeedback:async e=>{try{const t={...e,reactions:{"👍":0,"❤️":0,"🎮":0,"🌟":0,"🔥":0,"👏":0,"🎯":0,"💪":0},timestamp:Hd()};return{id:(await function(e,t){const n=Rh(e.firestore,$h),r=Fh(e),s=Dd(e.converter,t);return zd(n,[rd(nd(e.firestore),"addDoc",r._key,s,null!==e.converter,{}).toMutation(r._key,Ki.exists(!1))]).then((()=>r))}(Uh(ng,rg),t)).id,...t}}catch(tk){throw console.error("Error adding feedback:",tk),tk}},addReaction:async(e,n)=>{try{const r=Fh(ng,rg,e),s=t().feedbacks.find((t=>t.id===e));s&&await Gd(r,{[`reactions.${n}`]:(s.reactions[n]||0)+1})}catch(tk){throw console.error("Error adding reaction:",tk),tk}},cleanup:()=>{e({feedbacks:[],isLoading:!0,error:null})}}))),nw=[{id:"issue",label:"Report Issue",icon:Wg,color:"text-yellow-500"},{id:"suggestion",label:"Suggestion",icon:ny,color:"text-blue-500"},{id:"general",label:"General Feedback",icon:kg,color:"text-green-500"}];function rw(){const[t,n]=e.useState(""),[r,s]=e.useState(""),[i,a]=e.useState(""),[o,l]=e.useState(!1),[c,u]=e.useState(!1),{user:h}=lg(),d=tw((e=>e.addFeedback));return S.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"glass-effect rounded-xl p-8",children:S.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),t&&i&&!c)try{u(!0),await d({type:t,accountName:r.trim(),message:i.trim(),username:(null==h?void 0:h.username)||"Anonymous"}),l(!0),n(""),s(""),a(""),setTimeout((()=>{l(!1)}),3e3)}catch(tk){console.error("Error submitting feedback:",tk)}finally{u(!1)}},className:"space-y-6",children:[S.jsx("div",{className:"flex items-center gap-3 mb-6",children:S.jsx("div",{className:"px-3 py-1 rounded-full bg-red-500/20 text-red-400 border border-red-500/30",children:(null==h?void 0:h.username)||"Anonymous"})}),S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:nw.map((({id:e,label:r,icon:s,color:i})=>S.jsxs(f.button,{type:"button",whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>n(e),className:`p-4 rounded-lg border ${t===e?"border-red-500 bg-red-500/10":"border-white/10 hover:border-white/20"} transition-all duration-300`,children:[S.jsx(s,{className:`h-6 w-6 ${i} mx-auto mb-2`}),S.jsx("span",{className:"text-white",children:r})]},e)))}),S.jsxs("div",{className:"space-y-2",children:[S.jsx("label",{htmlFor:"accountName",className:"block text-gray-300",children:"Account/Service Name (Optional)"}),S.jsx("input",{type:"text",id:"accountName",value:r,onChange:e=>s(e.target.value),className:"w-full bg-black/50 border border-white/10 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-red-500",placeholder:"e.g., Steam Account, Netflix Account"})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx("label",{htmlFor:"message",className:"block text-gray-300",children:"Your Message"}),S.jsx("textarea",{id:"message",value:i,onChange:e=>a(e.target.value),className:"w-full h-32 bg-black/50 border border-white/10 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-red-500",placeholder:"Describe your feedback, issue, or suggestion...",required:!0})]}),S.jsx(f.button,{type:"submit",whileHover:{scale:1.02},whileTap:{scale:.98},disabled:!t||!i||c,className:"w-full py-3 bg-red-600 hover:bg-red-700 rounded-lg text-white transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Submitting...":"Submit Feedback"}),o&&S.jsx(f.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-center text-green-500",children:"Thank you for your feedback!"})]})})}function sw(){return S.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-12",children:[S.jsx("div",{className:"flex justify-center mb-6",children:S.jsx(_g,{className:"h-16 w-16 text-red-500"})}),S.jsx("h1",{className:"text-4xl font-bold text-red-500 mb-4",children:"Feedback & Support"}),S.jsx("p",{className:"text-xl text-gray-400 max-w-2xl mx-auto",children:"Help us improve by sharing your experience. Report issues, suggest new accounts, or provide general feedback."})]})}function iw(){return S.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-yellow-500/10 border border-yellow-500/30 rounded-xl p-6 mb-8",children:S.jsxs("div",{className:"flex items-start gap-4",children:[S.jsx(Wg,{className:"h-6 w-6 text-yellow-500 flex-shrink-0 mt-1"}),S.jsxs("div",{children:[S.jsx("h3",{className:"text-lg font-semibold text-yellow-500 mb-2",children:"Important Guidelines"}),S.jsxs("div",{className:"space-y-4",children:[S.jsxs("div",{children:[S.jsx("h4",{className:"text-yellow-400 mb-2",children:"Prohibited Content:"}),S.jsxs("ul",{className:"space-y-2 text-gray-300",children:[S.jsxs("li",{className:"flex items-center gap-2",children:[S.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-yellow-500"}),"No external links or promotions"]}),S.jsxs("li",{className:"flex items-center gap-2",children:[S.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-yellow-500"}),"No spam or repeated submissions"]}),S.jsxs("li",{className:"flex items-center gap-2",children:[S.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-yellow-500"}),"No personal information sharing"]}),S.jsxs("li",{className:"flex items-center gap-2",children:[S.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-yellow-500"}),"No harassment or offensive content"]})]})]}),S.jsxs("div",{children:[S.jsx("h4",{className:"text-yellow-400 mb-2",children:"Feedback Requirements:"}),S.jsxs("ul",{className:"space-y-2 text-gray-300",children:[S.jsxs("li",{className:"flex items-center gap-2",children:[S.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-yellow-500"}),"Must be clear and specific"]}),S.jsxs("li",{className:"flex items-center gap-2",children:[S.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-yellow-500"}),"Related to our services only"]}),S.jsxs("li",{className:"flex items-center gap-2",children:[S.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-yellow-500"}),"Constructive and solution-oriented"]}),S.jsxs("li",{className:"flex items-center gap-2",children:[S.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-yellow-500"}),"Respectful and professional tone"]})]})]}),S.jsxs("div",{className:"bg-red-500/10 rounded-lg p-4 border border-red-500/30",children:[S.jsx("p",{className:"text-red-400 font-semibold",children:"Warning:"}),S.jsx("p",{className:"text-gray-300",children:"Violation of these guidelines will result in your feedback being removed and potential restriction from submitting future feedback."})]})]})]})]})})}const aw=[{emoji:"👍",tooltip:"Like"},{emoji:"❤️",tooltip:"Love"},{emoji:"🎮",tooltip:"Gaming"},{emoji:"🌟",tooltip:"Amazing"},{emoji:"🔥",tooltip:"Hot"},{emoji:"👏",tooltip:"Applause"},{emoji:"🎯",tooltip:"On Point"},{emoji:"💪",tooltip:"Strong"}];function ow({feedbacks:e}){const t=tw((e=>e.addReaction));return S.jsxs("div",{className:"mt-16",children:[S.jsx("h2",{className:"text-2xl font-bold text-red-500 mb-6",children:"Community Feedback"}),S.jsx("div",{className:"space-y-6",children:0===e.length?S.jsx("div",{className:"text-center py-12 text-gray-400",children:"No feedback yet. Be the first to share your thoughts!"}):e.map((e=>{var n;return S.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"glass-effect rounded-xl p-6",children:S.jsxs("div",{className:"flex items-start gap-4",children:[S.jsx(Ty,{className:"h-10 w-10 text-gray-400"}),S.jsxs("div",{className:"flex-1",children:[S.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[S.jsx("span",{className:"font-semibold text-white",children:e.username}),S.jsx("span",{className:"text-gray-300",children:new Date(null==(n=e.timestamp)?void 0:n.toDate()).toLocaleString()}),S.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-red-500/20 text-red-400 border border-red-500/30",children:e.type.toUpperCase()}),e.accountName&&S.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-blue-500/20 text-blue-400 border border-blue-500/30",children:e.accountName})]}),S.jsx("p",{className:"text-gray-200 mb-4",children:e.message}),S.jsx("div",{className:"flex flex-wrap gap-2",children:aw.map((({emoji:n,tooltip:r})=>{var s;return S.jsxs("button",{onClick:()=>(async(e,n)=>{try{await t(e,n)}catch(tk){console.error("Error adding reaction:",tk)}})(e.id,n),className:"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-black/30 hover:bg-black/50 transition-colors group relative",title:r,children:[S.jsx("span",{className:"group-hover:scale-110 transition-transform",children:n}),S.jsx("span",{className:"text-sm text-gray-400",children:(null==(s=e.reactions)?void 0:s[n])||0}),S.jsx("span",{className:"absolute -top-8 left-1/2 transform -translate-x-1/2 px-2 py-1 bg-black/80 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity",children:r})]},n)}))})]})]})},e.id)}))})]})}function lw(){const{initialize:t,feedbacks:n,isLoading:r,error:s}=tw();return e.useEffect((()=>{const e=t();return()=>e()}),[t]),r?S.jsx("div",{className:"min-h-screen pt-24 flex items-center justify-center",children:S.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-500"})}):s?S.jsx("div",{className:"min-h-screen pt-24 flex items-center justify-center",children:S.jsxs("div",{className:"text-red-500",children:["Error loading feedbacks: ",s]})}):S.jsx(f.div,{initial:{opacity:0},animate:{opacity:1},className:"min-h-screen pt-24",children:S.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-12",children:[S.jsx(sw,{}),S.jsx(iw,{}),S.jsx(rw,{}),S.jsx(ow,{feedbacks:n})]})})}function cw(){r();return S.jsx("div",{className:"min-h-screen pt-24 pb-12 px-6",children:S.jsxs("div",{className:"max-w-md mx-auto",children:[S.jsxs(f.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center mb-12",children:[S.jsx("h1",{className:"text-4xl font-bold text-red-500 mb-4",children:"Welcome to Prime Nexo XYZ"}),S.jsx("p",{className:"text-gray-400",children:"Sign in with Discord to access premium gaming services"})]}),S.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"glass-effect p-8 rounded-xl",children:[S.jsxs("button",{onClick:()=>{const e=new URLSearchParams({client_id:"1315323672927666206",redirect_uri:"https://prime-nexo-xyz.netlify.app/auth/callback",response_type:"code",scope:"identify email"});window.location.href=`https://discord.com/api/oauth2/authorize?${e.toString()}`},className:"w-full py-3 bg-[#5865F2] hover:bg-[#4752C4] rounded-lg transition-colors duration-300 flex items-center justify-center gap-2",children:[S.jsx("svg",{className:"w-6 h-6",viewBox:"0 -28.5 256 256",version:"1.1",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid",children:S.jsx("path",{d:"M216.856339,16.5966031 C200.285002,8.84328665 182.566144,3.2084988 164.041564,0 C161.766523,4.11318106 159.108624,9.64549908 157.276099,14.0464379 C137.583995,11.0849896 118.072967,11.0849896 98.7430163,14.0464379 C96.9108417,9.64549908 94.1925838,4.11318106 91.8971895,0 C73.3526068,3.2084988 55.6133949,8.86399117 39.0420583,16.6376612 C5.61752293,67.146514 -3.4433191,116.400813 1.08711069,164.955721 C23.2560196,181.510915 44.7403634,191.567697 65.8621325,198.148576 C71.0772151,190.971126 75.7283628,183.341335 79.7352139,175.300261 C72.104019,172.400575 64.7949724,168.822202 57.8887866,164.667963 C59.7209612,163.310589 61.5131304,161.891452 63.2445898,160.431257 C105.36741,180.133187 151.134928,180.133187 192.754523,160.431257 C194.506336,161.891452 196.298154,163.310589 198.110326,164.667963 C191.183787,168.842556 183.854737,172.420929 176.223542,175.320965 C180.230393,183.341335 184.861538,190.991831 190.096624,198.16893 C211.238746,191.588051 232.743023,181.531619 254.911949,164.955721 C260.227747,108.668201 245.831087,59.8662432 216.856339,16.5966031 Z M85.4738752,135.09489 C72.8290281,135.09489 62.4592217,123.290155 62.4592217,108.914901 C62.4592217,94.5396472 72.607595,82.7145587 85.4738752,82.7145587 C98.3405064,82.7145587 108.709962,94.5189427 108.488529,108.914901 C108.508531,123.290155 98.3405064,135.09489 85.4738752,135.09489 Z M170.525237,135.09489 C157.88039,135.09489 147.510584,123.290155 147.510584,108.914901 C147.510584,94.5396472 157.658606,82.7145587 170.525237,82.7145587 C183.391518,82.7145587 193.761324,94.5189427 193.539891,108.914901 C193.539891,123.290155 183.391518,135.09489 170.525237,135.09489 Z",fill:"currentColor",fillRule:"nonzero"})}),"Continue with Discord"]}),S.jsx("div",{className:"mt-6 text-center",children:S.jsx("p",{className:"text-sm text-gray-400",children:"By continuing, you agree to our Terms of Service and Privacy Policy"})})]})]})})}function uw(){const t=r(),s=n(),{login:i}=lg();return e.useEffect((()=>{(async()=>{const e=new URLSearchParams(s.search).get("code");if(e)try{(await i(e)).success?t("/dashboard"):t("/auth",{state:{error:"Authentication failed"}})}catch(tk){console.error("Auth error:",tk),t("/auth",{state:{error:"Authentication failed"}})}else t("/auth")})()}),[s,i,t]),S.jsx("div",{className:"min-h-screen flex items-center justify-center",children:S.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-500"})})}function hw({onAuthorized:t}){const[n,r]=e.useState(""),[s,i]=e.useState(""),[a,o]=e.useState(""),[l,c]=e.useState(!1);return S.jsx("div",{className:"max-w-md mx-auto px-6",children:S.jsxs(f.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1,x:l?[-10,10,-10,10,0]:0},transition:{duration:l?.4:.2,type:l?"spring":"tween"},className:"glass-effect rounded-xl p-8",children:[S.jsxs("div",{className:"text-center mb-8",children:[S.jsx("h2",{className:"text-2xl font-bold text-red-500 mb-2",children:"Dashboard Access"}),S.jsx("p",{className:"text-gray-400",children:"Enter PIN and password to continue"})]}),S.jsxs("form",{onSubmit:e=>{e.preventDefault(),"673492815047236"===n&&"8@Tz!3YwL#q2RpN"===s?t():(o("Invalid PIN or password"),c(!0),setTimeout((()=>c(!1)),500))},className:"space-y-6",children:[S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"PIN"}),S.jsxs("div",{className:"relative",children:[S.jsx(ey,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),S.jsx("input",{type:"password",value:n,onChange:e=>{r(e.target.value),o("")},className:"w-full bg-black/50 border border-white/10 rounded-lg pl-10 pr-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-red-500",placeholder:"Enter PIN"})]})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),S.jsxs("div",{className:"relative",children:[S.jsx(sy,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),S.jsx("input",{type:"password",value:s,onChange:e=>{i(e.target.value),o("")},className:"w-full bg-black/50 border border-white/10 rounded-lg pl-10 pr-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-red-500",placeholder:"Enter password"})]})]}),a&&S.jsx(f.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:a}),S.jsx(f.button,{type:"submit",whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full py-3 bg-red-600 hover:bg-red-700 rounded-lg text-white transition-all duration-300",children:"Access Dashboard"})]})]})})}function dw({stats:e}){const t=[{icon:Ny,label:"Total Users",value:e.totalUsers,subValue:`${e.activeUsers} active`,color:"text-blue-500",bgColor:"bg-blue-500/20"},{icon:Cy,label:"Banned Users",value:e.bannedUsers,color:"text-red-500",bgColor:"bg-red-500/20"},{icon:Ry,label:"New Users",value:e.newUsers,subValue:"Last 24h",color:"text-green-500",bgColor:"bg-green-500/20"},{icon:dy,label:"Server Status",value:e.serverStatus,subValue:`${e.uptime} uptime`,color:"text-purple-500",bgColor:"bg-purple-500/20"}];return S.jsxs("div",{className:"glass-effect rounded-xl p-6",children:[S.jsx("h2",{className:"text-xl font-bold text-white mb-6",children:"Dashboard Overview"}),S.jsx("div",{className:"grid grid-cols-2 gap-4",children:t.map(((e,t)=>S.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"p-4 rounded-lg bg-black/30",children:[S.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[S.jsx("div",{className:`p-2 rounded-lg ${e.bgColor}`,children:S.jsx(e.icon,{className:`h-5 w-5 ${e.color}`})}),S.jsx("span",{className:"text-sm text-gray-400",children:e.label})]}),S.jsx("div",{className:"text-xl font-bold text-white",children:e.value}),e.subValue&&S.jsx("div",{className:"text-sm text-gray-400 mt-1",children:e.subValue})]},e.label)))})]})}function mw({metrics:e}){const t=[{icon:fy,label:"Threat Level",value:e.threatLevel,colorClass:(e=>{switch(e.toLowerCase()){case"high":return"text-red-500 bg-red-500/20";case"medium":return"text-yellow-500 bg-yellow-500/20";case"low":return"text-green-500 bg-green-500/20";default:return"text-gray-500 bg-gray-500/20"}})(e.threatLevel)},{icon:Wg,label:"Active Threats",value:e.activeThreats,colorClass:"text-yellow-500 bg-yellow-500/20"},{icon:sy,label:"Blocked Attacks",value:e.blockedAttacks,colorClass:"text-green-500 bg-green-500/20"},{icon:Yg,label:"VPN Detections",value:e.vpnDetections,colorClass:"text-blue-500 bg-blue-500/20"}];return S.jsxs("div",{className:"glass-effect rounded-xl p-6",children:[S.jsx("h2",{className:"text-xl font-bold text-white mb-6",children:"Security Overview"}),S.jsx("div",{className:"grid grid-cols-2 gap-4",children:t.map(((e,t)=>S.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"p-4 rounded-lg bg-black/30",children:[S.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[S.jsx("div",{className:`p-2 rounded-lg ${e.colorClass}`,children:S.jsx(e.icon,{className:"h-5 w-5"})}),S.jsx("span",{className:"text-sm text-gray-400",children:e.label})]}),S.jsx("div",{className:"text-xl font-bold text-white",children:e.value})]},e.label)))}),e.lastIncident&&S.jsx("div",{className:"mt-6 p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:S.jsxs("div",{className:"flex items-start gap-3",children:[S.jsx(Wg,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-1"}),S.jsxs("div",{children:[S.jsx("p",{className:"text-red-400 font-medium",children:"Last Security Incident"}),S.jsx("p",{className:"text-sm text-gray-300 mt-1",children:e.lastIncident})]})]})})]})}function fw(e){const t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new e.constructor(+e):"number"==typeof e||"[object Number]"===t||"string"==typeof e||"[object String]"===t?new Date(e):new Date(NaN)}function pw(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}const gw=6048e5;let yw={};function vw(){return yw}function ww(e,t){var n,r,s,i;const a=vw(),o=(null==t?void 0:t.weekStartsOn)??(null==(r=null==(n=null==t?void 0:t.locale)?void 0:n.options)?void 0:r.weekStartsOn)??a.weekStartsOn??(null==(i=null==(s=a.locale)?void 0:s.options)?void 0:i.weekStartsOn)??0,l=fw(e),c=l.getDay(),u=(c<o?7:0)+c-o;return l.setDate(l.getDate()-u),l.setHours(0,0,0,0),l}function bw(e){return ww(e,{weekStartsOn:1})}function xw(e){const t=fw(e),n=t.getFullYear(),r=pw(e,0);r.setFullYear(n+1,0,4),r.setHours(0,0,0,0);const s=bw(r),i=pw(e,0);i.setFullYear(n,0,4),i.setHours(0,0,0,0);const a=bw(i);return t.getTime()>=s.getTime()?n+1:t.getTime()>=a.getTime()?n:n-1}function _w(e){const t=fw(e);return t.setHours(0,0,0,0),t}function Iw(e){const t=fw(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function kw(e){if(!(t=e,t instanceof Date||"object"==typeof t&&"[object Date]"===Object.prototype.toString.call(t)||"number"==typeof e))return!1;var t;const n=fw(e);return!isNaN(Number(n))}const Sw={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function Tw(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const Ew={date:Tw({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:Tw({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:Tw({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},Nw={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function Aw(e){return(t,n)=>{let r;if("formatting"===((null==n?void 0:n.context)?String(n.context):"standalone")&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,s=(null==n?void 0:n.width)?String(n.width):t;r=e.formattingValues[s]||e.formattingValues[t]}else{const t=e.defaultWidth,s=(null==n?void 0:n.width)?String(n.width):e.defaultWidth;r=e.values[s]||e.values[t]}return r[e.argumentCallback?e.argumentCallback(t):t]}}const Cw={ordinalNumber:(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:Aw({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:Aw({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:Aw({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:Aw({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:Aw({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})};function jw(e){return(t,n={})=>{const r=n.width,s=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;const a=i[0],o=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?function(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n;return}(o,(e=>e.test(a))):function(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n;return}(o,(e=>e.test(a)));let c;c=e.valueCallback?e.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;return{value:c,rest:t.slice(a.length)}}}const Rw={ordinalNumber:(Dw={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)},(e,t={})=>{const n=e.match(Dw.matchPattern);if(!n)return null;const r=n[0],s=e.match(Dw.parsePattern);if(!s)return null;let i=Dw.valueCallback?Dw.valueCallback(s[0]):s[0];return i=t.valueCallback?t.valueCallback(i):i,{value:i,rest:e.slice(r.length)}}),era:jw({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:jw({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:jw({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:jw({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:jw({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})};var Dw;const Pw={code:"en-US",formatDistance:(e,t,n)=>{let r;const s=Sw[e];return r="string"==typeof s?s:1===t?s.one:s.other.replace("{{count}}",t.toString()),(null==n?void 0:n.addSuffix)?n.comparison&&n.comparison>0?"in "+r:r+" ago":r},formatLong:Ew,formatRelative:(e,t,n,r)=>Nw[e],localize:Cw,match:Rw,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Ow(e){const t=fw(e),n=function(e,t){const n=_w(e),r=_w(t),s=+n-Iw(n),i=+r-Iw(r);return Math.round((s-i)/864e5)}(t,function(e){const t=fw(e),n=pw(e,0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}(t));return n+1}function Mw(e){const t=fw(e),n=+bw(t)-+function(e){const t=xw(e),n=pw(e,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),bw(n)}(t);return Math.round(n/gw)+1}function Lw(e,t){var n,r,s,i;const a=fw(e),o=a.getFullYear(),l=vw(),c=(null==t?void 0:t.firstWeekContainsDate)??(null==(r=null==(n=null==t?void 0:t.locale)?void 0:n.options)?void 0:r.firstWeekContainsDate)??l.firstWeekContainsDate??(null==(i=null==(s=l.locale)?void 0:s.options)?void 0:i.firstWeekContainsDate)??1,u=pw(e,0);u.setFullYear(o+1,0,c),u.setHours(0,0,0,0);const h=ww(u,t),d=pw(e,0);d.setFullYear(o,0,c),d.setHours(0,0,0,0);const m=ww(d,t);return a.getTime()>=h.getTime()?o+1:a.getTime()>=m.getTime()?o:o-1}function Uw(e,t){const n=fw(e),r=+ww(n,t)-+function(e,t){var n,r,s,i;const a=vw(),o=(null==t?void 0:t.firstWeekContainsDate)??(null==(r=null==(n=null==t?void 0:t.locale)?void 0:n.options)?void 0:r.firstWeekContainsDate)??a.firstWeekContainsDate??(null==(i=null==(s=a.locale)?void 0:s.options)?void 0:i.firstWeekContainsDate)??1,l=Lw(e,t),c=pw(e,0);return c.setFullYear(l,0,o),c.setHours(0,0,0,0),ww(c,t)}(n,t);return Math.round(r/gw)+1}function Fw(e,t){return(e<0?"-":"")+Math.abs(e).toString().padStart(t,"0")}const Vw={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return Fw("yy"===t?r%100:r,t.length)},M(e,t){const n=e.getMonth();return"M"===t?String(n+1):Fw(n+1,2)},d:(e,t)=>Fw(e.getDate(),t.length),a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:(e,t)=>Fw(e.getHours()%12||12,t.length),H:(e,t)=>Fw(e.getHours(),t.length),m:(e,t)=>Fw(e.getMinutes(),t.length),s:(e,t)=>Fw(e.getSeconds(),t.length),S(e,t){const n=t.length,r=e.getMilliseconds();return Fw(Math.trunc(r*Math.pow(10,n-3)),t.length)}},Bw="midnight",$w="noon",Gw="morning",qw="afternoon",zw="evening",Kw="night",Hw={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if("yo"===t){const t=e.getFullYear(),r=t>0?t:1-t;return n.ordinalNumber(r,{unit:"year"})}return Vw.y(e,t)},Y:function(e,t,n,r){const s=Lw(e,r),i=s>0?s:1-s;if("YY"===t){return Fw(i%100,2)}return"Yo"===t?n.ordinalNumber(i,{unit:"year"}):Fw(i,t.length)},R:function(e,t){return Fw(xw(e),t.length)},u:function(e,t){return Fw(e.getFullYear(),t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return Fw(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return Fw(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return Vw.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return Fw(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const s=Uw(e,r);return"wo"===t?n.ordinalNumber(s,{unit:"week"}):Fw(s,t.length)},I:function(e,t,n){const r=Mw(e);return"Io"===t?n.ordinalNumber(r,{unit:"week"}):Fw(r,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getDate(),{unit:"date"}):Vw.d(e,t)},D:function(e,t,n){const r=Ow(e);return"Do"===t?n.ordinalNumber(r,{unit:"dayOfYear"}):Fw(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Fw(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Fw(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),s=0===r?7:r;switch(t){case"i":return String(s);case"ii":return Fw(s,t.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let s;switch(s=12===r?$w:0===r?Bw:r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let s;switch(s=r>=17?zw:r>=12?qw:r>=4?Gw:Kw,t){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),n.ordinalNumber(t,{unit:"hour"})}return Vw.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getHours(),{unit:"hour"}):Vw.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return"Ko"===t?n.ordinalNumber(r,{unit:"hour"}):Fw(r,t.length)},k:function(e,t,n){let r=e.getHours();return 0===r&&(r=24),"ko"===t?n.ordinalNumber(r,{unit:"hour"}):Fw(r,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Vw.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Vw.s(e,t)},S:function(e,t){return Vw.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(0===r)return"Z";switch(t){case"X":return Qw(r);case"XXXX":case"XX":return Xw(r);default:return Xw(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return Qw(r);case"xxxx":case"xx":return Xw(r);default:return Xw(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Ww(r,":");default:return"GMT"+Xw(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Ww(r,":");default:return"GMT"+Xw(r,":")}},t:function(e,t,n){return Fw(Math.trunc(e.getTime()/1e3),t.length)},T:function(e,t,n){return Fw(e.getTime(),t.length)}};function Ww(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),s=Math.trunc(r/60),i=r%60;return 0===i?n+String(s):n+String(s)+t+Fw(i,2)}function Qw(e,t){if(e%60==0){return(e>0?"-":"+")+Fw(Math.abs(e)/60,2)}return Xw(e,t)}function Xw(e,t=""){const n=e>0?"-":"+",r=Math.abs(e);return n+Fw(Math.trunc(r/60),2)+t+Fw(r%60,2)}const Jw=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},Yw=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},Zw={p:Yw,P:(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],s=n[2];if(!s)return Jw(e,t);let i;switch(r){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;default:i=t.dateTime({width:"full"})}return i.replace("{{date}}",Jw(r,t)).replace("{{time}}",Yw(s,t))}},eb=/^D+$/,tb=/^Y+$/,nb=["D","DD","YY","YYYY"];const rb=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,sb=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ib=/^'([^]*?)'?$/,ab=/''/g,ob=/[a-zA-Z]/;function lb(e,t,n){var r,s,i,a,o,l,c,u;const h=vw(),d=(null==n?void 0:n.locale)??h.locale??Pw,m=(null==n?void 0:n.firstWeekContainsDate)??(null==(s=null==(r=null==n?void 0:n.locale)?void 0:r.options)?void 0:s.firstWeekContainsDate)??h.firstWeekContainsDate??(null==(a=null==(i=h.locale)?void 0:i.options)?void 0:a.firstWeekContainsDate)??1,f=(null==n?void 0:n.weekStartsOn)??(null==(l=null==(o=null==n?void 0:n.locale)?void 0:o.options)?void 0:l.weekStartsOn)??h.weekStartsOn??(null==(u=null==(c=h.locale)?void 0:c.options)?void 0:u.weekStartsOn)??0,p=fw(e);if(!kw(p))throw new RangeError("Invalid time value");let g=t.match(sb).map((e=>{const t=e[0];if("p"===t||"P"===t){return(0,Zw[t])(e,d.formatLong)}return e})).join("").match(rb).map((e=>{if("''"===e)return{isToken:!1,value:"'"};const t=e[0];if("'"===t)return{isToken:!1,value:cb(e)};if(Hw[t])return{isToken:!0,value:e};if(t.match(ob))throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}}));d.localize.preprocessor&&(g=d.localize.preprocessor(p,g));const y={firstWeekContainsDate:m,weekStartsOn:f,locale:d};return g.map((r=>{if(!r.isToken)return r.value;const s=r.value;(!(null==n?void 0:n.useAdditionalWeekYearTokens)&&function(e){return tb.test(e)}(s)||!(null==n?void 0:n.useAdditionalDayOfYearTokens)&&function(e){return eb.test(e)}(s))&&function(e,t,n){const r=function(e,t,n){const r="Y"===e[0]?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}(e,t,n);if(console.warn(r),nb.includes(e))throw new RangeError(r)}(s,t,String(e));return(0,Hw[s[0]])(p,s,d.localize,y)})).join("")}function cb(e){const t=e.match(ib);return t?t[1].replace(ab,"'"):e}function ub({activities:e=[]}){return S.jsxs("div",{className:"glass-effect rounded-xl p-6",children:[S.jsx("h2",{className:"text-xl font-bold text-white mb-6",children:"Activity Monitor"}),S.jsx("div",{className:"space-y-4 max-h-[400px] overflow-y-auto custom-scrollbar",children:0===e.length?S.jsx("p",{className:"text-gray-400 text-center py-4",children:"No recent activities"}):e.map(((e,t)=>{const n=(e=>{switch(e){case"user":default:return Py;case"security":return fy;case"alert":return Wg}})(e.type),r=(e=>{switch(e){case"user":return"text-blue-400";case"security":return"text-green-400";case"alert":return"text-red-400";default:return"text-gray-400"}})(e.type);return S.jsxs(f.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*t},className:"flex items-start gap-4 p-4 bg-black/30 rounded-lg",children:[S.jsx("div",{className:`p-2 rounded-lg bg-black/20 ${r}`,children:S.jsx(n,{className:"h-5 w-5"})}),S.jsxs("div",{className:"flex-1",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsx("p",{className:"text-white font-medium",children:e.message}),S.jsx("span",{className:"text-sm text-gray-400",children:lb(new Date(e.timestamp),"HH:mm:ss")})]}),e.details&&S.jsx("p",{className:"text-sm text-gray-400 mt-1",children:e.details}),e.user&&S.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[S.jsx("span",{className:"text-sm text-gray-500",children:"by"}),S.jsx("span",{className:"text-sm text-gray-300",children:e.user})]})]})]},e.id||t)}))})]})}const hb=3e4;const db=new class{constructor(){this.isConnected=!1,this.pendingMessages=[]}setConnected(e){this.isConnected=e,e&&this.flushPendingMessages()}emit(e,t){this.isConnected||this.pendingMessages.push({event:e,data:t})}flushPendingMessages(){for(;this.pendingMessages.length>0;){const{event:e,data:t}=this.pendingMessages.shift();this.emit(e,t)}}};const mb=new class{constructor(){this.listeners=new Map,this.isSimulated=!1}subscribe(e,t){return this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t),()=>{var n;return null==(n=this.listeners.get(e))?void 0:n.delete(t)}}notify(e,t){var n;null==(n=this.listeners.get(e))||n.forEach((e=>e(t)))}clear(){this.listeners.clear()}};const fb=new class{constructor(){this.isInitialized=!1,this.reconnectAttempts=0,this.heartbeatInterval=null}initialize(){this.isInitialized}subscribe(e,t){return mb.subscribe(e,t)}emit(e,t){this.isInitialized||this.initialize(),db.emit(e,t)}startHeartbeat(){this.heartbeatInterval&&clearInterval(this.heartbeatInterval),this.heartbeatInterval=setInterval((()=>{this.emit("heartbeat",{timestamp:Date.now()})}),hb)}disconnect(){this.heartbeatInterval&&clearInterval(this.heartbeatInterval),mb.clear(),this.isInitialized=!1,db.setConnected(!1)}};function pb(){const t=function(){const[t,n]=e.useState({cpu:45,memory:65,disk:30,network:{in:52428800,out:31457280},responseTime:150});return e.useEffect((()=>{const e=fb.subscribe("serverMetrics",(e=>{n(e)})),t=setInterval((()=>{n((e=>({...e,cpu:Math.floor(20*Math.random())+35,memory:Math.floor(15*Math.random())+55,responseTime:Math.floor(100*Math.random())+100,network:{in:e.network.in+Math.floor(1024*Math.random()*1024),out:e.network.out+Math.floor(1024*Math.random()*1024)}})))}),5e3);return()=>{clearInterval(t),e&&e()}}),[]),t}(),n=e=>e>=90?"bg-red-500/20 text-red-400":e>=70?"bg-yellow-500/20 text-yellow-400":"bg-green-500/20 text-green-400",r=e=>{if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,t)).toFixed(2))} ${["B","KB","MB","GB","TB"][t]}`},s=[{label:"CPU Usage",value:`${t.cpu}%`,color:n(t.cpu)},{label:"Memory Usage",value:`${t.memory}%`,color:n(t.memory)},{label:"Network In",value:r(t.network.in),color:"bg-blue-500/20 text-blue-400"},{label:"Network Out",value:r(t.network.out),color:"bg-purple-500/20 text-purple-400"}];return S.jsxs("div",{className:"glass-effect rounded-xl p-6",children:[S.jsx("h2",{className:"text-xl font-bold text-white mb-6",children:"System Health"}),S.jsx("div",{className:"grid grid-cols-2 gap-4",children:s.map(((e,t)=>S.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:`p-4 rounded-lg ${e.color}`,children:[S.jsx("div",{className:"text-sm text-gray-400 mb-1",children:e.label}),S.jsx("div",{className:"text-xl font-bold",children:e.value})]},e.label)))}),S.jsx("div",{className:"mt-4 p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg",children:S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("div",{className:"h-2 w-2 rounded-full bg-blue-500"}),S.jsxs("span",{className:"text-sm text-gray-400",children:["Response Time: ",t.responseTime,"ms"]})]})})]})}const gb=ew(((e,t)=>({stats:{totalUsers:0,activeUsers:0,bannedUsers:0,newUsers:0,serverStatus:"Online",uptime:"0%",responseTime:0,cpuUsage:0,memoryUsage:0,networkTraffic:0,errorRate:0},securityMetrics:{threatLevel:"Low",activeThreats:0,blockedAttacks:0,suspiciousActivities:[],lastIncident:null,firewallStatus:"Active",vpnDetections:0,failedLogins:0},userActivities:[],systemLogs:[],activeAlerts:[],isInitialized:!1,isLoading:!0,error:null,initialize:async()=>{if(!t().isInitialized)try{const t=qd(Fh(ng,"system","stats"),(t=>{t.exists()&&e((e=>({stats:{...e.stats,...t.data()}})))})),n=qd(Fh(ng,"system","security"),(t=>{t.exists()&&e((e=>({securityMetrics:{...e.securityMetrics,...t.data()}})))})),r=qd(xd(Uh(ng,"activities"),Td("timestamp","desc")),(t=>{const n=[];t.forEach((e=>{n.push({id:e.id,...e.data()})})),e({userActivities:n})})),s=qd(xd(Uh(ng,"systemLogs"),Td("timestamp","desc")),(t=>{const n=[];t.forEach((e=>{n.push({id:e.id,...e.data()})})),e({systemLogs:n})})),i=qd(xd(Uh(ng,"alerts"),Id("active","==",!0)),(t=>{const n=[];t.forEach((e=>{n.push({id:e.id,...e.data()})})),e({activeAlerts:n})}));return e({isInitialized:!0,isLoading:!1}),()=>{t(),n(),r(),s(),i()}}catch(tk){e({error:tk.message,isLoading:!1}),console.error("Dashboard initialization error:",tk)}},clearAlert:async e=>{try{const t=Fh(ng,"alerts",e);await Gd(t,{active:!1,resolvedAt:(new Date).toISOString()})}catch(tk){throw console.error("Error clearing alert:",tk),tk}},cleanup:()=>{e({isInitialized:!1,activeAlerts:[],error:null})}})));function yb({alerts:e=[]}){const t=gb((e=>e.clearAlert));return S.jsx("div",{className:"space-y-4",children:S.jsx(p,{children:e.map((e=>S.jsx(f.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.95},className:"p-4 rounded-lg border "+("high"===e.severity?"bg-red-500/10 border-red-500/30":"medium"===e.severity?"bg-yellow-500/10 border-yellow-500/30":"bg-blue-500/10 border-blue-500/30"),children:S.jsxs("div",{className:"flex items-start gap-4",children:[S.jsx(Wg,{className:"h-6 w-6 flex-shrink-0 "+("high"===e.severity?"text-red-500":"medium"===e.severity?"text-yellow-500":"text-blue-500")}),S.jsxs("div",{className:"flex-1",children:[S.jsxs("div",{className:"flex items-start justify-between gap-4",children:[S.jsxs("div",{children:[S.jsx("h3",{className:"font-semibold text-white",children:e.title}),S.jsx("p",{className:"text-gray-300 mt-1",children:e.message})]}),S.jsx("button",{onClick:()=>t(e.id),className:"p-1 hover:bg-white/10 rounded-lg transition-colors",children:S.jsx(Vy,{className:"h-5 w-5 text-gray-400"})})]}),e.details&&S.jsx("div",{className:"mt-2 text-sm text-gray-400",children:e.details}),S.jsxs("div",{className:"mt-2 flex items-center gap-4 text-sm",children:[S.jsx("span",{className:"text-gray-500",children:new Date(e.timestamp).toLocaleTimeString()}),e.source&&S.jsxs("span",{className:"text-gray-400",children:["Source: ",e.source]})]})]})]})},e.id)))})})}const vb=ew(((e,t)=>({members:[],onlineUsers:new Set,isLoading:!0,error:null,fetchMembers:async()=>{try{const t=xd(Uh(ng,"members"),Td("joinDate","desc"));return qd(t,(t=>{const n=[];t.forEach((e=>{n.push({id:e.id,...e.data()})})),e({members:n,isLoading:!1})}),(t=>{console.error("Error fetching members:",t),e({error:t.message,isLoading:!1})}))}catch(tk){e({error:tk.message,isLoading:!1}),console.error("Error setting up members listener:",tk)}},updateMemberStatus:async(t,n)=>{if(t)try{const r=Fh(ng,"memberStatus",t);await $d(r,{isOnline:n,lastUpdated:Hd(),lastActive:n?"Now":(new Date).toISOString()},{merge:!0}),e((e=>{const r=new Set(e.onlineUsers);return n?r.add(t):r.delete(t),{onlineUsers:r}}))}catch(tk){console.error("Error updating member status:",tk.message)}},banMember:async(t,n)=>{if(t)try{const r=Fh(ng,"members",t);await Gd(r,{banned:!0,banReason:n,banDate:Hd()}),e((e=>({members:e.members.map((e=>e.id===t?{...e,banned:!0,banReason:n,banDate:(new Date).toISOString()}:e))})))}catch(tk){throw console.error("Error banning member:",tk.message),tk}},unbanMember:async t=>{if(t)try{const n=Fh(ng,"members",t);await Gd(n,{banned:!1,banReason:null,banDate:null}),e((e=>({members:e.members.map((e=>e.id===t?{...e,banned:!1,banReason:null,banDate:null}:e))})))}catch(tk){throw console.error("Error unbanning member:",tk.message),tk}},initializeRealtime:()=>qd(xd(Uh(ng,"memberStatus"),Id("isOnline","==",!0)),(t=>{const n=new Set;t.forEach((e=>{n.add(e.id)})),e({onlineUsers:n})}),(e=>{console.error("Error in status listener:",e)}))})));function wb({isOpen:t,onClose:n,onBan:r,username:s}){const[i,a]=e.useState(""),[o,l]=e.useState("");return t?S.jsx(p,{children:S.jsx(f.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:S.jsxs(f.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-black/95 rounded-lg p-6 max-w-md w-full border border-red-500/30",children:[S.jsxs("div",{className:"flex justify-between items-center mb-6",children:[S.jsx("h3",{className:"text-2xl font-bold text-red-500",children:"Ban Member"}),S.jsx("button",{onClick:n,className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:S.jsx(Vy,{className:"h-5 w-5 text-white/70 hover:text-white"})})]}),S.jsxs("form",{onSubmit:e=>{e.preventDefault(),i.trim()?(r(i),a(""),l("")):l("Please provide a reason for the ban")},className:"space-y-6",children:[S.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-500/10 rounded-lg border border-red-500/30",children:[S.jsx(Wg,{className:"h-6 w-6 text-red-500 flex-shrink-0"}),S.jsxs("div",{children:[S.jsx("p",{className:"text-red-400 font-medium",children:"Warning:"}),S.jsxs("p",{className:"text-gray-300",children:["You are about to ban ",S.jsx("span",{className:"font-semibold text-white",children:s}),". This action will:"]}),S.jsxs("ul",{className:"mt-2 space-y-1 text-sm text-gray-400",children:[S.jsx("li",{children:"• Block their access to all services"}),S.jsx("li",{children:"• Log their device fingerprint"}),S.jsx("li",{children:"• Record this action in security logs"})]})]})]}),S.jsxs("div",{className:"space-y-2",children:[S.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Ban Reason"}),S.jsx("textarea",{value:i,onChange:e=>{a(e.target.value),l("")},className:"w-full bg-black/50 border border-white/10 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-red-500",placeholder:"Enter the reason for this ban...",rows:"3"}),o&&S.jsx("p",{className:"text-sm text-red-500",children:o})]}),S.jsxs("div",{className:"flex gap-4 justify-end",children:[S.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded-lg text-white transition-colors",children:"Cancel"}),S.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-white transition-colors",children:"Ban Member"})]})]})]})})}):null}function bb({member:t}){const[n,r]=e.useState(!1),{banMember:s,unbanMember:i}=vb();return"Owner"===t.role?null:S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"flex items-center gap-3",children:t.banned?S.jsx(f.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{i(t.id)},className:"px-4 py-2 bg-green-500/20 text-green-400 rounded-lg hover:bg-green-500/30 transition-colors",children:"Unban"}):S.jsx(f.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>r(!0),className:"px-4 py-2 bg-red-500/20 text-red-400 rounded-lg hover:bg-red-500/30 transition-colors",children:"Ban"})}),S.jsx(wb,{isOpen:n,onClose:()=>r(!1),onBan:e=>{s(t.id,e),r(!1)},username:t.username})]})}const xb=[{label:"All Members",value:"all"},{label:"Online",value:"online"},{label:"Banned",value:"banned"}];function _b({filter:e,onFilterChange:t}){return S.jsx("div",{className:"flex gap-2",children:xb.map((n=>S.jsx(f.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>t(n.value),className:"px-4 py-2 rounded-lg transition-colors "+(e===n.value?"bg-red-600 text-white":"bg-black/50 text-gray-300 hover:bg-black/70"),children:n.label},n.value)))})}function Ib({members:e,onlineUsers:t}){const n=[{icon:Ny,label:"Total Members",value:e.length,color:"text-blue-500",bgColor:"bg-blue-500/20"},{icon:Py,label:"Online",value:t.size,color:"text-green-500",bgColor:"bg-green-500/20"},{icon:gy,label:"Banned",value:e.filter((e=>e.banned)).length,color:"text-red-500",bgColor:"bg-red-500/20"}];return S.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:n.map(((e,t)=>S.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"glass-effect p-6 rounded-xl",children:S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsx("div",{className:`p-3 rounded-lg ${e.bgColor}`,children:S.jsx(e.icon,{className:`h-6 w-6 ${e.color}`})}),S.jsxs("div",{children:[S.jsx("div",{className:"text-2xl font-bold text-white",children:e.value}),S.jsx("div",{className:"text-sm text-gray-400",children:e.label})]})]})},e.label)))})}function kb(){const{members:t,onlineUsers:n,fetchMembers:r,initializeRealtime:s}=vb(),[i,a]=e.useState(""),[o,l]=e.useState("all");e.useEffect((()=>{r();return s()}),[]);const c=t.filter((e=>{const t=e.username.toLowerCase().includes(i.toLowerCase())||e.email.toLowerCase().includes(i.toLowerCase())||e.discordId.includes(i);return"all"===o?t:"online"===o?t&&n.has(e.id):"banned"===o?t&&e.banned:t}));return S.jsxs("div",{className:"space-y-6",children:[S.jsx(Ib,{members:t,onlineUsers:n}),S.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-center",children:[S.jsxs("div",{className:"relative w-full md:w-96",children:[S.jsx("input",{type:"text",placeholder:"Search members...",value:i,onChange:e=>a(e.target.value),className:"w-full bg-black/50 border border-white/10 rounded-lg pl-12 pr-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-red-500"}),S.jsx(ay,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"})]}),S.jsx(_b,{filter:o,onFilterChange:l})]}),S.jsx("div",{className:"space-y-4",children:c.map((e=>S.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"glass-effect p-6 rounded-xl",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{className:"flex items-center gap-4",children:[S.jsxs("div",{className:"relative",children:[e.profilePic?S.jsx("img",{src:e.profilePic,alt:e.username,className:"w-12 h-12 rounded-full object-cover"}):S.jsx(Ty,{className:"w-12 h-12 text-gray-400"}),S.jsx("span",{className:"absolute -bottom-1 -right-1 w-3 h-3 rounded-full border-2 border-black "+(n.has(e.id)?"bg-green-500":"bg-gray-500")})]}),S.jsxs("div",{children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("h3",{className:"text-lg font-semibold text-white",children:e.username}),S.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs "+("Owner"===e.role?"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30":"Admin"===e.role?"bg-red-500/20 text-red-400 border border-red-500/30":"bg-blue-500/20 text-blue-400 border border-blue-500/30"),children:e.role})]}),S.jsxs("div",{className:"text-sm text-gray-400",children:["Discord ID: ",e.discordId]}),S.jsxs("div",{className:"text-sm text-gray-400",children:["Joined ",new Date(e.joinDate).toLocaleDateString()]})]})]}),S.jsx(bb,{member:e})]}),e.banned&&S.jsx("div",{className:"mt-4 p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:S.jsx("div",{className:"flex items-start gap-2",children:S.jsxs("div",{children:[S.jsx("p",{className:"text-sm text-red-400 font-medium",children:"Ban Information:"}),S.jsxs("p",{className:"text-sm text-gray-300",children:["Reason: ",e.banReason]}),S.jsxs("p",{className:"text-sm text-gray-400",children:["Banned on: ",new Date(e.banDate).toLocaleString()]})]})})})]},e.id)))})]})}function Sb(){const{initialize:t,cleanup:n,stats:r,securityMetrics:s,userActivities:i,activeAlerts:a,isLoading:o,error:l}=gb();return e.useEffect((()=>(t(),()=>n())),[]),o?S.jsx("div",{className:"flex items-center justify-center min-h-screen",children:S.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-500"})}):l?S.jsx("div",{className:"flex items-center justify-center min-h-screen",children:S.jsxs("div",{className:"text-red-500",children:["Error loading dashboard: ",l]})}):S.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8 space-y-8",children:[a.length>0&&S.jsx(yb,{alerts:a}),S.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[S.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:S.jsx(dw,{stats:r})}),S.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:S.jsx(mw,{metrics:s})})]}),S.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:S.jsx(kb,{})}),S.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[S.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"lg:col-span-2",children:S.jsx(ub,{activities:i})}),S.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:S.jsx(pb,{cpuUsage:r.cpuUsage,memoryUsage:r.memoryUsage,networkTraffic:r.networkTraffic,errorRate:r.errorRate})})]})]})}function Tb(){const[t,n]=e.useState(!1),{user:r}=lg();return r?S.jsx("div",{className:"min-h-screen pt-24",children:t?S.jsx(Sb,{}):S.jsx(hw,{onAuthorized:()=>n(!0)})}):S.jsx("div",{className:"min-h-screen pt-24 flex items-center justify-center",children:S.jsxs("div",{className:"text-center",children:[S.jsx("h1",{className:"text-3xl font-bold text-red-500 mb-4",children:"Access Denied"}),S.jsx("p",{className:"text-gray-400",children:"Please log in to access the dashboard."})]})})}const Eb={},Nb=function(e,t,n){if(!t||0===t.length)return e();const r=document.getElementsByTagName("link");return Promise.all(t.map((e=>{if((e=function(e){return"/"+e}(e))in Eb)return;Eb[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(!!n)for(let n=r.length-1;n>=0;n--){const s=r[n];if(s.href===e&&(!t||"stylesheet"===s.rel))return}else if(document.querySelector(`link[href="${e}"]${s}`))return;const i=document.createElement("link");return i.rel=t?"stylesheet":"modulepreload",t||(i.as="script",i.crossOrigin=""),i.href=e,document.head.appendChild(i),t?new Promise(((t,n)=>{i.addEventListener("load",t),i.addEventListener("error",(()=>n(new Error(`Unable to preload CSS for ${e}`))))})):void 0}))).then((()=>e())).catch((e=>{const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}))};class Ab extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class Cb extends Ab{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class jb extends Ab{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Rb extends Ab{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Db,Pb;(Pb=Db||(Db={})).Any="any",Pb.ApNortheast1="ap-northeast-1",Pb.ApNortheast2="ap-northeast-2",Pb.ApSouth1="ap-south-1",Pb.ApSoutheast1="ap-southeast-1",Pb.ApSoutheast2="ap-southeast-2",Pb.CaCentral1="ca-central-1",Pb.EuCentral1="eu-central-1",Pb.EuWest1="eu-west-1",Pb.EuWest2="eu-west-2",Pb.EuWest3="eu-west-3",Pb.SaEast1="sa-east-1",Pb.UsEast1="us-east-1",Pb.UsWest1="us-west-1",Pb.UsWest2="us-west-2";var Ob=globalThis&&globalThis.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function a(e){try{l(r.next(e))}catch(t){i(t)}}function o(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};class Mb{constructor(e,{headers:t={},customFetch:n,region:r=Db.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=(e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Nb((()=>Promise.resolve().then((()=>Qb))),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)})(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var n;return Ob(this,void 0,void 0,(function*(){try{const{headers:r,method:s,body:i}=t;let a,o={},{region:l}=t;l||(l=this.region),l&&"any"!==l&&(o["x-region"]=l),i&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&("undefined"!=typeof Blob&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",a=i):"string"==typeof i?(o["Content-Type"]="text/plain",a=i):"undefined"!=typeof FormData&&i instanceof FormData?a=i:(o["Content-Type"]="application/json",a=JSON.stringify(i)));const c=yield this.fetch(`${this.url}/${e}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),r),body:a}).catch((e=>{throw new Cb(e)})),u=c.headers.get("x-relay-error");if(u&&"true"===u)throw new jb(c);if(!c.ok)throw new Rb(c);let h,d=(null!==(n=c.headers.get("Content-Type"))&&void 0!==n?n:"text/plain").split(";")[0].trim();return h="application/json"===d?yield c.json():"application/octet-stream"===d?yield c.blob():"text/event-stream"===d?c:"multipart/form-data"===d?yield c.formData():yield c.text(),{data:h,error:null}}catch(tk){return{data:null,error:tk}}}))}}var Lb={},Ub={},Fb={},Vb={},Bb={},$b={},Gb=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();const qb=Gb.fetch,zb=Gb.fetch.bind(Gb),Kb=Gb.Headers,Hb=Gb.Request,Wb=Gb.Response,Qb=Object.freeze(Object.defineProperty({__proto__:null,Headers:Kb,Request:Hb,Response:Wb,default:zb,fetch:qb},Symbol.toStringTag,{value:"Module"})),Xb=o(Qb);var Jb={};Object.defineProperty(Jb,"__esModule",{value:!0});class Yb extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}Jb.default=Yb;var Zb=l&&l.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($b,"__esModule",{value:!0});const ex=Zb(Xb),tx=Zb(Jb);$b.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=ex.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let n=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((async e=>{var t,n,r;let s=null,i=null,a=null,o=e.status,l=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(i="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const r=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),c=null===(n=e.headers.get("content-range"))||void 0===n?void 0:n.split("/");r&&c&&c.length>1&&(a=parseInt(c[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(i)&&(i.length>1?(s={code:"PGRST116",details:`Results contain ${i.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},i=null,a=null,o=406,l="Not Acceptable"):i=1===i.length?i[0]:null)}else{const t=await e.text();try{s=JSON.parse(t),Array.isArray(s)&&404===e.status&&(i=[],s=null,o=200,l="OK")}catch(c){404===e.status&&""===t?(o=204,l="No Content"):s={message:t}}if(s&&this.isMaybeSingle&&(null===(r=null==s?void 0:s.details)||void 0===r?void 0:r.includes("0 rows"))&&(s=null,o=200,l="OK"),s&&this.shouldThrowOnError)throw new tx.default(s)}return{error:s,data:i,count:a,status:o,statusText:l}}));return this.shouldThrowOnError||(n=n.catch((e=>{var t,n,r;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(n=null==e?void 0:e.stack)&&void 0!==n?n:""}`,hint:"",code:`${null!==(r=null==e?void 0:e.code)&&void 0!==r?r:""}`},data:null,count:null,status:0,statusText:""}}))),n.then(e,t)}};var nx=l&&l.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Bb,"__esModule",{value:!0});const rx=nx($b);let sx=class extends rx.default{select(e){let t=!1;const n=(null!=e?e:"*").split("").map((e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e))).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:n,foreignTable:r,referencedTable:s=r}={}){const i=s?`${s}.order`:"order",a=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${void 0===n?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:n=t}={}){const r=void 0===n?"limit":`${n}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:n,referencedTable:r=n}={}){const s=void 0===r?"offset":`${r}.offset`,i=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(i,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:n=!1,buffers:r=!1,wal:s=!1,format:i="text"}={}){var a;const o=[e?"analyze":null,t?"verbose":null,n?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|"),l=null!==(a=this.headers.Accept)&&void 0!==a?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${l}"; options=${o};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Bb.default=sx;var ix=l&&l.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Vb,"__esModule",{value:!0});const ax=ix(Bb);let ox=class extends ax.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const n=Array.from(new Set(t)).map((e=>"string"==typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`)).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:n,type:r}={}){let s="";"plain"===r?s="pl":"phrase"===r?s="ph":"websearch"===r&&(s="w");const i=void 0===n?"":`(${n})`;return this.url.searchParams.append(e,`${s}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach((([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)})),this}not(e,t,n){return this.url.searchParams.append(e,`not.${t}.${n}`),this}or(e,{foreignTable:t,referencedTable:n=t}={}){const r=n?`${n}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,n){return this.url.searchParams.append(e,`${t}.${n}`),this}};Vb.default=ox;var lx=l&&l.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Fb,"__esModule",{value:!0});const cx=lx(Vb);Fb.default=class{constructor(e,{headers:t={},schema:n,fetch:r}){this.url=e,this.headers=t,this.schema=n,this.fetch=r}select(e,{head:t=!1,count:n}={}){const r=t?"HEAD":"GET";let s=!1;const i=(null!=e?e:"*").split("").map((e=>/\s/.test(e)&&!s?"":('"'===e&&(s=!s),e))).join("");return this.url.searchParams.set("select",i),n&&(this.headers.Prefer=`count=${n}`),new cx.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:n=!0}={}){const r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),n||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new cx.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:n=!1,count:r,defaultToNull:s=!0}={}){const i=[`resolution=${n?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),s||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new cx.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),this.headers.Prefer=n.join(","),new cx.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new cx.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};var ux={},hx={};Object.defineProperty(hx,"__esModule",{value:!0}),hx.version=void 0,hx.version="0.0.0-automated",Object.defineProperty(ux,"__esModule",{value:!0}),ux.DEFAULT_HEADERS=void 0;const dx=hx;ux.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${dx.version}`};var mx=l&&l.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ub,"__esModule",{value:!0});const fx=mx(Fb),px=mx(Vb),gx=ux;Ub.default=class e{constructor(e,{headers:t={},schema:n,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},gx.DEFAULT_HEADERS),t),this.schemaName=n,this.fetch=r}from(e){const t=new URL(`${this.url}/${e}`);return new fx.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(e,t={},{head:n=!1,get:r=!1,count:s}={}){let i;const a=new URL(`${this.url}/rpc/${e}`);let o;n||r?(i=n?"HEAD":"GET",Object.entries(t).filter((([e,t])=>void 0!==t)).map((([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`])).forEach((([e,t])=>{a.searchParams.append(e,t)}))):(i="POST",o=t);const l=Object.assign({},this.headers);return s&&(l.Prefer=`count=${s}`),new px.default({method:i,url:a,headers:l,schema:this.schemaName,body:o,fetch:this.fetch,allowEmpty:!1})}};var yx=l&&l.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Lb,"__esModule",{value:!0}),Lb.PostgrestError=Lb.PostgrestBuilder=Lb.PostgrestTransformBuilder=Lb.PostgrestFilterBuilder=Lb.PostgrestQueryBuilder=Lb.PostgrestClient=void 0;const vx=yx(Ub);Lb.PostgrestClient=vx.default;const wx=yx(Fb);Lb.PostgrestQueryBuilder=wx.default;const bx=yx(Vb);Lb.PostgrestFilterBuilder=bx.default;const xx=yx(Bb);Lb.PostgrestTransformBuilder=xx.default;const _x=yx($b);Lb.PostgrestBuilder=_x.default;const Ix=yx(Jb);Lb.PostgrestError=Ix.default;var kx=Lb.default={PostgrestClient:vx.default,PostgrestQueryBuilder:wx.default,PostgrestFilterBuilder:bx.default,PostgrestTransformBuilder:xx.default,PostgrestBuilder:_x.default,PostgrestError:Ix.default};const{PostgrestClient:Sx,PostgrestQueryBuilder:Tx,PostgrestFilterBuilder:Ex,PostgrestTransformBuilder:Nx,PostgrestBuilder:Ax}=kx,Cx={"X-Client-Info":"realtime-js/2.10.9"};var jx,Rx,Dx,Px,Ox,Mx,Lx,Ux,Fx,Vx,Bx;(Rx=jx||(jx={}))[Rx.connecting=0]="connecting",Rx[Rx.open=1]="open",Rx[Rx.closing=2]="closing",Rx[Rx.closed=3]="closed",(Px=Dx||(Dx={})).closed="closed",Px.errored="errored",Px.joined="joined",Px.joining="joining",Px.leaving="leaving",(Mx=Ox||(Ox={})).close="phx_close",Mx.error="phx_error",Mx.join="phx_join",Mx.reply="phx_reply",Mx.leave="phx_leave",Mx.access_token="access_token",(Lx||(Lx={})).websocket="websocket",(Fx=Ux||(Ux={})).Connecting="connecting",Fx.Open="open",Fx.Closing="closing",Fx.Closed="closed";class $x{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"==typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const r=t.getUint8(1),s=t.getUint8(2);let i=this.HEADER_LENGTH+2;const a=n.decode(e.slice(i,i+r));i+=r;const o=n.decode(e.slice(i,i+s));i+=s;return{ref:null,topic:a,event:o,payload:JSON.parse(n.decode(e.slice(i,e.byteLength)))}}}class Gx{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}(Bx=Vx||(Vx={})).abstime="abstime",Bx.bool="bool",Bx.date="date",Bx.daterange="daterange",Bx.float4="float4",Bx.float8="float8",Bx.int2="int2",Bx.int4="int4",Bx.int4range="int4range",Bx.int8="int8",Bx.int8range="int8range",Bx.json="json",Bx.jsonb="jsonb",Bx.money="money",Bx.numeric="numeric",Bx.oid="oid",Bx.reltime="reltime",Bx.text="text",Bx.time="time",Bx.timestamp="timestamp",Bx.timestamptz="timestamptz",Bx.timetz="timetz",Bx.tsrange="tsrange",Bx.tstzrange="tstzrange";const qx=(e,t,n={})=>{var r;const s=null!==(r=n.skipTypes)&&void 0!==r?r:[];return Object.keys(t).reduce(((n,r)=>(n[r]=zx(r,e,t,s),n)),{})},zx=(e,t,n,r)=>{const s=t.find((t=>t.name===e)),i=null==s?void 0:s.type,a=n[e];return i&&!r.includes(i)?Kx(i,a):Hx(a)},Kx=(e,t)=>{if("_"===e.charAt(0)){const n=e.slice(1,e.length);return Jx(t,n)}switch(e){case Vx.bool:return Wx(t);case Vx.float4:case Vx.float8:case Vx.int2:case Vx.int4:case Vx.int8:case Vx.numeric:case Vx.oid:return Qx(t);case Vx.json:case Vx.jsonb:return Xx(t);case Vx.timestamp:return Yx(t);case Vx.abstime:case Vx.date:case Vx.daterange:case Vx.int4range:case Vx.int8range:case Vx.money:case Vx.reltime:case Vx.text:case Vx.time:case Vx.timestamptz:case Vx.timetz:case Vx.tsrange:case Vx.tstzrange:default:return Hx(t)}},Hx=e=>e,Wx=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Qx=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Xx=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(tk){return console.log(`JSON parse error: ${tk}`),e}return e},Jx=(e,t)=>{if("string"!=typeof e)return e;const n=e.length-1,r=e[n];if("{"===e[0]&&"}"===r){let r;const i=e.slice(1,n);try{r=JSON.parse("["+i+"]")}catch(s){r=i?i.split(","):[]}return r.map((e=>Kx(t,e)))}return e},Yx=e=>"string"==typeof e?e.replace(" ","T"):e,Zx=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class e_{constructor(e,t,n={},r=1e4){this.channel=e,this.event=t,this.payload=n,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t(null===(n=this.receivedResp)||void 0===n?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},(e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter((t=>t.status===e)).forEach((e=>e.callback(t)))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var t_,n_,r_,s_,i_,a_,o_,l_;(n_=t_||(t_={})).SYNC="sync",n_.JOIN="join",n_.LEAVE="leave";class c_{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},(e=>{const{onJoin:t,onLeave:n,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=c_.syncState(this.state,e,t,n),this.pendingDiffs.forEach((e=>{this.state=c_.syncDiff(this.state,e,t,n)})),this.pendingDiffs=[],r()})),this.channel._on(n.diff,{},(e=>{const{onJoin:t,onLeave:n,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=c_.syncDiff(this.state,e,t,n),r())})),this.onJoin(((e,t,n)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:n})})),this.onLeave(((e,t,n)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:n})})),this.onSync((()=>{this.channel._trigger("presence",{event:"sync"})}))}static syncState(e,t,n,r){const s=this.cloneDeep(e),i=this.transformState(t),a={},o={};return this.map(s,((e,t)=>{i[e]||(o[e]=t)})),this.map(i,((e,t)=>{const n=s[e];if(n){const r=t.map((e=>e.presence_ref)),s=n.map((e=>e.presence_ref)),i=t.filter((e=>s.indexOf(e.presence_ref)<0)),l=n.filter((e=>r.indexOf(e.presence_ref)<0));i.length>0&&(a[e]=i),l.length>0&&(o[e]=l)}else a[e]=t})),this.syncDiff(s,{joins:a,leaves:o},n,r)}static syncDiff(e,t,n,r){const{joins:s,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),r||(r=()=>{}),this.map(s,((t,r)=>{var s;const i=null!==(s=e[t])&&void 0!==s?s:[];if(e[t]=this.cloneDeep(r),i.length>0){const n=e[t].map((e=>e.presence_ref)),r=i.filter((e=>n.indexOf(e.presence_ref)<0));e[t].unshift(...r)}n(t,i,r)})),this.map(i,((t,n)=>{let s=e[t];if(!s)return;const i=n.map((e=>e.presence_ref));s=s.filter((e=>i.indexOf(e.presence_ref)<0)),e[t]=s,r(t,s,n),0===s.length&&delete e[t]})),e}static map(e,t){return Object.getOwnPropertyNames(e).map((n=>t(n,e[n])))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce(((t,n)=>{const r=e[n];return t[n]="metas"in r?r.metas.map((e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e))):r,t}),{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(s_=r_||(r_={})).ALL="*",s_.INSERT="INSERT",s_.UPDATE="UPDATE",s_.DELETE="DELETE",(a_=i_||(i_={})).BROADCAST="broadcast",a_.PRESENCE="presence",a_.POSTGRES_CHANGES="postgres_changes",a_.SYSTEM="system",(l_=o_||(o_={})).SUBSCRIBED="SUBSCRIBED",l_.TIMED_OUT="TIMED_OUT",l_.CLOSED="CLOSED",l_.CHANNEL_ERROR="CHANNEL_ERROR";class u_{constructor(e,t={config:{}},n){this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=Dx.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new e_(this,Ox.join,this.params,this.timeout),this.rejoinTimer=new Gx((()=>this._rejoinUntilConnected()),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(()=>{this.state=Dx.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach((e=>e.send())),this.pushBuffer=[]})),this._onClose((()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Dx.closed,this.socket._remove(this)})),this._onError((e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=Dx.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Dx.errored,this.rejoinTimer.scheduleTimeout())})),this._on(Ox.reply,{},((e,t)=>{this._trigger(this._replyEventName(t),e)})),this.presence=new c_(this),this.broadcastEndpointURL=Zx(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var n,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:i,private:a}}=this.params;this._onError((t=>e&&e("CHANNEL_ERROR",t))),this._onClose((()=>e&&e("CLOSED")));const o={},l={broadcast:s,presence:i,postgres_changes:null!==(r=null===(n=this.bindings.postgres_changes)||void 0===n?void 0:n.map((e=>e.filter)))&&void 0!==r?r:[],private:a};this.socket.accessToken&&(o.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:l},o)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",(({postgres_changes:t})=>{var n;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),void 0!==t){const r=this.bindings.postgres_changes,s=null!==(n=null==r?void 0:r.length)&&void 0!==n?n:0,i=[];for(let n=0;n<s;n++){const s=r[n],{filter:{event:a,schema:o,table:l,filter:c}}=s,u=t&&t[n];if(!u||u.event!==a||u.schema!==o||u.table!==l||u.filter!==c)return this.unsubscribe(),void(e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes")));i.push(Object.assign(Object.assign({},s),{id:u.id}))}return this.bindings.postgres_changes=i,void(e&&e("SUBSCRIBED"))}e&&e("SUBSCRIBED")})).receive("error",(t=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(t).join(", ")||"error")))})).receive("timeout",(()=>{e&&e("TIMED_OUT")}))}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this._on(e,t,n)}async send(e,t={}){var n,r;if(this._canPush()||"broadcast"!==e.type)return new Promise((n=>{var r,s,i;const a=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(i=null===(s=null===(r=this.params)||void 0===r?void 0:r.config)||void 0===s?void 0:s.broadcast)||void 0===i?void 0:i.ack)||n("ok"),a.receive("ok",(()=>n("ok"))),a.receive("error",(()=>n("error"))),a.receive("timeout",(()=>n("timed out")))}));{const{event:s,payload:i}=e,a={method:"POST",headers:{Authorization:this.socket.accessToken?`Bearer ${this.socket.accessToken}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,a,null!==(n=t.timeout)&&void 0!==n?n:this.timeout);return await(null===(r=e.body)||void 0===r?void 0:r.cancel()),e.ok?"ok":"error"}catch(tk){return"AbortError"===tk.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Dx.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ox.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise((n=>{const r=new e_(this,Ox.leave,{},e);r.receive("ok",(()=>{t(),n("ok")})).receive("timeout",(()=>{t(),n("timed out")})).receive("error",(()=>{n("error")})),r.send(),this._canPush()||r.trigger("ok",{})}))}async _fetchWithTimeout(e,t,n){const r=new AbortController,s=setTimeout((()=>r.abort()),n),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(s),i}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new e_(this,e,t,n);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var r,s;const i=e.toLocaleLowerCase(),{close:a,error:o,leave:l,join:c}=Ox;if(n&&[a,o,l,c].indexOf(i)>=0&&n!==this._joinRef())return;let u=this._onMessage(i,t,n);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?null===(r=this.bindings.postgres_changes)||void 0===r||r.filter((e=>{var t,n,r;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(r=null===(n=e.filter)||void 0===n?void 0:n.event)||void 0===r?void 0:r.toLocaleLowerCase())===i})).map((e=>e.callback(u,n))):null===(s=this.bindings[i])||void 0===s||s.filter((e=>{var n,r,s,a,o,l;if(["broadcast","presence","postgres_changes"].includes(i)){if("id"in e){const i=e.id,a=null===(n=e.filter)||void 0===n?void 0:n.event;return i&&(null===(r=t.ids)||void 0===r?void 0:r.includes(i))&&("*"===a||(null==a?void 0:a.toLocaleLowerCase())===(null===(s=t.data)||void 0===s?void 0:s.type.toLocaleLowerCase()))}{const n=null===(o=null===(a=null==e?void 0:e.filter)||void 0===a?void 0:a.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===n||n===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===i})).map((e=>{if("object"==typeof u&&"ids"in u){const e=u.data,{schema:t,table:n,commit_timestamp:r,type:s,errors:i}=e,a={schema:t,table:n,commit_timestamp:r,eventType:s,new:{},old:{},errors:i};u=Object.assign(Object.assign({},a),this._getPayloadRecords(e))}e.callback(u,n)}))}_isClosed(){return this.state===Dx.closed}_isJoined(){return this.state===Dx.joined}_isJoining(){return this.state===Dx.joining}_isLeaving(){return this.state===Dx.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const r=e.toLocaleLowerCase(),s={type:r,filter:t,callback:n};return this.bindings[r]?this.bindings[r].push(s):this.bindings[r]=[s],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter((e=>{var r;return!((null===(r=e.type)||void 0===r?void 0:r.toLocaleLowerCase())===n&&u_.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ox.close,{},e)}_onError(e){this._on(Ox.error,{},(t=>e(t)))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Dx.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=qx(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=qx(e.columns,e.old_record)),t}}const h_=()=>{},d_="undefined"!=typeof WebSocket;class m_{constructor(e,t){var n;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=Cx,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=h_,this.conn=null,this.sendBuffer=[],this.serializer=new $x,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Nb((()=>Promise.resolve().then((()=>Qb))),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},this.endPoint=`${e}/${Lx.websocket}`,this.httpEndpoint=Zx(e),(null==t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null==t?void 0:t.params)&&(this.params=t.params),(null==t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null==t?void 0:t.timeout)&&(this.timeout=t.timeout),(null==t?void 0:t.logger)&&(this.logger=t.logger),(null==t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const r=null===(n=null==t?void 0:t.params)||void 0===n?void 0:n.apikey;if(r&&(this.accessToken=r,this.apiKey=r),this.reconnectAfterMs=(null==t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null==t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null==t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Gx((async()=>{this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(null==t?void 0:t.fetch),null==t?void 0:t.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null==t?void 0:t.worker)||!1,this.workerUrl=null==t?void 0:t.workerUrl}}connect(){if(!this.conn)if(this.transport)this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});else{if(d_)return this.conn=new WebSocket(this._endPointURL()),void this.setupConnection();this.conn=new f_(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),Nb((()=>import("./browser-56e92296.js").then((e=>e.b))),["assets/browser-56e92296.js","assets/vendor-786b7556.js"]).then((({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()}))}}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map((e=>e.unsubscribe())));return this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case jx.connecting:return Ux.Connecting;case jx.open:return Ux.Open;case jx.closing:return Ux.Closing;default:return Ux.Closed}}isConnected(){return this.connectionState()===Ux.Open}channel(e,t={config:{}}){const n=new u_(`realtime:${e}`,t,this);return this.channels.push(n),n}push(e){const{topic:t,event:n,payload:r,ref:s}=e,i=()=>{this.encode(e,(e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)}))};this.log("push",`${t} ${n} (${s})`,r),this.isConnected()?i():this.sendBuffer.push(i)}setAuth(e){if(e){let n=null;try{n=JSON.parse(atob(e.split(".")[1]))}catch(t){}if(n&&n.exp){if(!(Math.floor(Date.now()/1e3)-n.exp<0))return void this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`)}}this.accessToken=e,this.channels.forEach((t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(Ox.access_token,{access_token:e})}))}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find((t=>t.topic===e&&(t._isJoined()||t._isJoining())));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter((t=>t._joinRef()!==e._joinRef()))}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}_onConnMessage(e){this.decode(e.data,(e=>{let{topic:t,event:n,payload:r,ref:s}=e;(s&&s===this.pendingHeartbeatRef||n===(null==r?void 0:r.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${r.status||""} ${t} ${n} ${s&&"("+s+")"||""}`,r),this.channels.filter((e=>e._isMember(t))).forEach((e=>e._trigger(n,r,s))),this.stateChangeCallbacks.message.forEach((t=>t(e)))}))}async _onConnOpen(){if(this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this._sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this._sendHeartbeat()),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach((e=>e()))}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((t=>t(e)))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((t=>t(e)))}_triggerChanError(){this.channels.forEach((e=>e._trigger(Ox.error)))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const n=e.match(/\?/)?"&":"?";return`${e}${n}${new URLSearchParams(t)}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((e=>e())),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class f_{constructor(e,t,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=jx.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=n.close}}class p_ extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function g_(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class y_ extends p_{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class v_ extends p_{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var w_=globalThis&&globalThis.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function a(e){try{l(r.next(e))}catch(t){i(t)}}function o(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};const b_=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Nb((()=>Promise.resolve().then((()=>Qb))),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},x_=e=>{if(Array.isArray(e))return e.map((e=>x_(e)));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach((([e,n])=>{const r=e.replace(/([-_][a-z])/gi,(e=>e.toUpperCase().replace(/[-_]/g,"")));t[r]=x_(n)})),t};var __=globalThis&&globalThis.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function a(e){try{l(r.next(e))}catch(t){i(t)}}function o(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};const I_=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),k_=(e,t,n)=>__(void 0,void 0,void 0,(function*(){const r=yield w_(void 0,void 0,void 0,(function*(){return"undefined"==typeof Response?(yield Nb((()=>Promise.resolve().then((()=>Qb))),void 0)).Response:Response}));e instanceof r&&!(null==n?void 0:n.noResolveJson)?e.json().then((n=>{t(new y_(I_(n),e.status||500))})).catch((e=>{t(new v_(I_(e),e))})):t(new v_(I_(e),e))}));function S_(e,t,n,r,s,i){return __(this,void 0,void 0,(function*(){return new Promise(((a,o)=>{e(n,((e,t,n,r)=>{const s={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?s:(s.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),r&&(s.body=JSON.stringify(r)),Object.assign(Object.assign({},s),n))})(t,r,s,i)).then((e=>{if(!e.ok)throw e;return(null==r?void 0:r.noResolveJson)?e:e.json()})).then((e=>a(e))).catch((e=>k_(e,o,r)))}))}))}function T_(e,t,n,r){return __(this,void 0,void 0,(function*(){return S_(e,"GET",t,n,r)}))}function E_(e,t,n,r,s){return __(this,void 0,void 0,(function*(){return S_(e,"POST",t,r,s,n)}))}function N_(e,t,n,r,s){return __(this,void 0,void 0,(function*(){return S_(e,"DELETE",t,r,s,n)}))}var A_=globalThis&&globalThis.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function a(e){try{l(r.next(e))}catch(t){i(t)}}function o(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};const C_={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},j_={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class R_{constructor(e,t={},n,r){this.url=e,this.headers=t,this.bucketId=n,this.fetch=b_(r)}uploadOrUpdate(e,t,n,r){return A_(this,void 0,void 0,(function*(){try{let s;const i=Object.assign(Object.assign({},j_),r);let a=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(i.upsert)});const o=i.metadata;"undefined"!=typeof Blob&&n instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),o&&s.append("metadata",this.encodeMetadata(o)),s.append("",n)):"undefined"!=typeof FormData&&n instanceof FormData?(s=n,s.append("cacheControl",i.cacheControl),o&&s.append("metadata",this.encodeMetadata(o))):(s=n,a["cache-control"]=`max-age=${i.cacheControl}`,a["content-type"]=i.contentType,o&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null==r?void 0:r.headers)&&(a=Object.assign(Object.assign({},a),r.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),u=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:s,headers:a},(null==i?void 0:i.duplex)?{duplex:i.duplex}:{})),h=yield u.json();if(u.ok)return{data:{path:l,id:h.Id,fullPath:h.Key},error:null};return{data:null,error:h}}catch(tk){if(g_(tk))return{data:null,error:tk};throw tk}}))}upload(e,t,n){return A_(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",e,t,n)}))}uploadToSignedUrl(e,t,n,r){return A_(this,void 0,void 0,(function*(){const s=this._removeEmptyFolders(e),i=this._getFinalPath(s),a=new URL(this.url+`/object/upload/sign/${i}`);a.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:j_.upsert},r),i=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&n instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",n)):"undefined"!=typeof FormData&&n instanceof FormData?(e=n,e.append("cacheControl",t.cacheControl)):(e=n,i["cache-control"]=`max-age=${t.cacheControl}`,i["content-type"]=t.contentType);const o=yield this.fetch(a.toString(),{method:"PUT",body:e,headers:i}),l=yield o.json();if(o.ok)return{data:{path:s,fullPath:l.Key},error:null};return{data:null,error:l}}catch(tk){if(g_(tk))return{data:null,error:tk};throw tk}}))}createSignedUploadUrl(e,t){return A_(this,void 0,void 0,(function*(){try{let n=this._getFinalPath(e);const r=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(r["x-upsert"]="true");const s=yield E_(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:r}),i=new URL(this.url+s.url),a=i.searchParams.get("token");if(!a)throw new p_("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:a},error:null}}catch(tk){if(g_(tk))return{data:null,error:tk};throw tk}}))}update(e,t,n){return A_(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",e,t,n)}))}move(e,t,n){return A_(this,void 0,void 0,(function*(){try{return{data:yield E_(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==n?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(tk){if(g_(tk))return{data:null,error:tk};throw tk}}))}copy(e,t,n){return A_(this,void 0,void 0,(function*(){try{return{data:{path:(yield E_(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==n?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(tk){if(g_(tk))return{data:null,error:tk};throw tk}}))}createSignedUrl(e,t,n){return A_(this,void 0,void 0,(function*(){try{let r=this._getFinalPath(e),s=yield E_(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},(null==n?void 0:n.transform)?{transform:n.transform}:{}),{headers:this.headers});const i=(null==n?void 0:n.download)?`&download=${!0===n.download?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(tk){if(g_(tk))return{data:null,error:tk};throw tk}}))}createSignedUrls(e,t,n){return A_(this,void 0,void 0,(function*(){try{const r=yield E_(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),s=(null==n?void 0:n.download)?`&download=${!0===n.download?"":n.download}`:"";return{data:r.map((e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${s}`):null}))),error:null}}catch(tk){if(g_(tk))return{data:null,error:tk};throw tk}}))}download(e,t){return A_(this,void 0,void 0,(function*(){const n=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",r=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),s=r?`?${r}`:"";try{const t=this._getFinalPath(e),r=yield T_(this.fetch,`${this.url}/${n}/${t}${s}`,{headers:this.headers,noResolveJson:!0});return{data:yield r.blob(),error:null}}catch(tk){if(g_(tk))return{data:null,error:tk};throw tk}}))}info(e){return A_(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{const e=yield T_(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:x_(e),error:null}}catch(tk){if(g_(tk))return{data:null,error:tk};throw tk}}))}exists(e){return A_(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{return yield function(e,t,n,r){return __(this,void 0,void 0,(function*(){return S_(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)}))}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(tk){if(g_(tk)&&tk instanceof v_){const t=tk.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:tk}}throw tk}}))}getPublicUrl(e,t){const n=this._getFinalPath(e),r=[],s=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==s&&r.push(s);const i=void 0!==(null==t?void 0:t.transform)?"render/image":"object",a=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==a&&r.push(a);let o=r.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${n}${o}`)}}}remove(e){return A_(this,void 0,void 0,(function*(){try{return{data:yield N_(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(tk){if(g_(tk))return{data:null,error:tk};throw tk}}))}list(e,t,n){return A_(this,void 0,void 0,(function*(){try{const r=Object.assign(Object.assign(Object.assign({},C_),t),{prefix:e||""});return{data:yield E_(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(tk){if(g_(tk))return{data:null,error:tk};throw tk}}))}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const D_={"X-Client-Info":"storage-js/2.7.1"};var P_=globalThis&&globalThis.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function a(e){try{l(r.next(e))}catch(t){i(t)}}function o(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};class O_{constructor(e,t={},n){this.url=e,this.headers=Object.assign(Object.assign({},D_),t),this.fetch=b_(n)}listBuckets(){return P_(this,void 0,void 0,(function*(){try{return{data:yield T_(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(tk){if(g_(tk))return{data:null,error:tk};throw tk}}))}getBucket(e){return P_(this,void 0,void 0,(function*(){try{return{data:yield T_(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(tk){if(g_(tk))return{data:null,error:tk};throw tk}}))}createBucket(e,t={public:!1}){return P_(this,void 0,void 0,(function*(){try{return{data:yield E_(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(tk){if(g_(tk))return{data:null,error:tk};throw tk}}))}updateBucket(e,t){return P_(this,void 0,void 0,(function*(){try{const n=yield function(e,t,n,r,s){return __(this,void 0,void 0,(function*(){return S_(e,"PUT",t,r,s,n)}))}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:n,error:null}}catch(tk){if(g_(tk))return{data:null,error:tk};throw tk}}))}emptyBucket(e){return P_(this,void 0,void 0,(function*(){try{return{data:yield E_(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(tk){if(g_(tk))return{data:null,error:tk};throw tk}}))}deleteBucket(e){return P_(this,void 0,void 0,(function*(){try{return{data:yield N_(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(tk){if(g_(tk))return{data:null,error:tk};throw tk}}))}}class M_ extends O_{constructor(e,t={},n){super(e,t,n)}from(e){return new R_(this.url,this.headers,e,this.fetch)}}let L_="";L_="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const U_={headers:{"X-Client-Info":`supabase-js-${L_}/2.47.2`}},F_={schema:"public"},V_={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},B_={};var $_=globalThis&&globalThis.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function a(e){try{l(r.next(e))}catch(t){i(t)}}function o(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};const G_=(e,t,n)=>{const r=(e=>{let t;return t=e||("undefined"==typeof fetch?zb:fetch),(...e)=>t(...e)})(n),s="undefined"==typeof Headers?Kb:Headers;return(n,i)=>$_(void 0,void 0,void 0,(function*(){var a;const o=null!==(a=yield t())&&void 0!==a?a:e;let l=new s(null==i?void 0:i.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),r(n,Object.assign(Object.assign({},i),{headers:l}))}))};var q_=globalThis&&globalThis.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function a(e){try{l(r.next(e))}catch(t){i(t)}}function o(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};const z_="2.66.1",K_={"X-Client-Info":`gotrue-js/${z_}`},H_="X-Supabase-Api-Version",W_={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"};const Q_=()=>"undefined"!=typeof document,X_={tested:!1,writable:!1},J_=()=>{if(!Q_())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(t){return!1}if(X_.tested)return X_.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),X_.tested=!0,X_.writable=!0}catch(t){X_.tested=!0,X_.writable=!1}return X_.writable};function Y_(e){const t={},n=new URL(e);if(n.hash&&"#"===n.hash[0])try{new URLSearchParams(n.hash.substring(1)).forEach(((e,n)=>{t[n]=e}))}catch(r){}return n.searchParams.forEach(((e,n)=>{t[n]=e})),t}const Z_=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Nb((()=>Promise.resolve().then((()=>Qb))),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},eI=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},tI=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch(r){return n}},nI=async(e,t)=>{await e.removeItem(t)};class rI{constructor(){this.promise=new rI.promiseConstructor(((e,t)=>{this.resolve=e,this.reject=t}))}}function sI(e){const t=e.split(".");if(3!==t.length)throw new Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const n=t[1];return JSON.parse(function(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n,r,s,i,a,o,l,c="",u=0;for(e=e.replace("-","+").replace("_","/");u<e.length;)i=t.indexOf(e.charAt(u++)),a=t.indexOf(e.charAt(u++)),o=t.indexOf(e.charAt(u++)),l=t.indexOf(e.charAt(u++)),n=i<<2|a>>4,r=(15&a)<<4|o>>2,s=(3&o)<<6|l,c+=String.fromCharCode(n),64!=o&&0!=r&&(c+=String.fromCharCode(r)),64!=l&&0!=s&&(c+=String.fromCharCode(s));return c}(n))}function iI(e){return("0"+e.toString(16)).substr(-2)}async function aI(e){if(!("undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(n);return Array.from(r).map((e=>String.fromCharCode(e))).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function oI(e,t,n=!1){const r=function(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let n="";for(let r=0;r<56;r++)n+=e.charAt(Math.floor(Math.random()*t));return n}return crypto.getRandomValues(e),Array.from(e,iI).join("")}();let s=r;n&&(s+="/PASSWORD_RECOVERY"),await eI(e,`${t}-code-verifier`,s);const i=await aI(r);return[i,r===i?"plain":"s256"]}rI.promiseConstructor=Promise;const lI=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;class cI extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function uI(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class hI extends cI{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}class dI extends cI{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class mI extends cI{constructor(e,t,n,r){super(e,n,r),this.name=t,this.status=n}}class fI extends mI{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class pI extends mI{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class gI extends mI{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class yI extends mI{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class vI extends mI{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class wI extends mI{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function bI(e){return uI(e)&&"AuthRetryableFetchError"===e.name}class xI extends mI{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}var _I=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]])}return n};const II=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),kI=[502,503,504];async function SI(e){var t,n;if(!("object"==typeof(n=e)&&null!==n&&"status"in n&&"ok"in n&&"json"in n&&"function"==typeof n.json))throw new wI(II(e),0);if(kI.includes(e.status))throw new wI(II(e),e.status);let r,s;try{r=await e.json()}catch(a){throw new dI(II(a),a)}const i=function(e){const t=e.headers.get(H_);if(!t)return null;if(!t.match(lI))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(a){return null}}(e);if(i&&i.getTime()>=W_.timestamp&&"object"==typeof r&&r&&"string"==typeof r.code?s=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(s=r.error_code),s){if("weak_password"===s)throw new xI(II(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===s)throw new fI}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce(((e,t)=>e&&"string"==typeof t),!0))throw new xI(II(r),e.status,r.weak_password.reasons);throw new hI(II(r),e.status||500,s)}async function TI(e,t,n,r){var s;const i=Object.assign({},null==r?void 0:r.headers);i[H_]||(i[H_]=W_.name),(null==r?void 0:r.jwt)&&(i.Authorization=`Bearer ${r.jwt}`);const a=null!==(s=null==r?void 0:r.query)&&void 0!==s?s:{};(null==r?void 0:r.redirectTo)&&(a.redirect_to=r.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await async function(e,t,n,r,s,i){const a=((e,t,n,r)=>{const s={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),n))})(t,r,s,i);let o;try{o=await e(n,Object.assign({},a))}catch(l){throw console.error(l),new wI(II(l),0)}o.ok||await SI(o);if(null==r?void 0:r.noResolveJson)return o;try{return await o.json()}catch(l){await SI(l)}}(e,t,n+o,{headers:i,noResolveJson:null==r?void 0:r.noResolveJson},{},null==r?void 0:r.body);return(null==r?void 0:r.xform)?null==r?void 0:r.xform(l):{data:Object.assign({},l),error:null}}function EI(e){var t;let n=null;var r;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)));return{data:{session:n,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function NI(e){const t=EI(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce(((e,t)=>e&&"string"==typeof t),!0)&&(t.data.weak_password=e.weak_password),t}function AI(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function CI(e){return{data:e,error:null}}function jI(e){const{action_link:t,email_otp:n,hashed_token:r,redirect_to:s,verification_type:i}=e,a=_I(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:n,hashed_token:r,redirect_to:s,verification_type:i},user:Object.assign({},a)},error:null}}function RI(e){return e}var DI=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]])}return n};class PI{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=Z_(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await TI(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(tk){if(uI(tk))return{data:null,error:tk};throw tk}}async inviteUserByEmail(e,t={}){try{return await TI(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:AI})}catch(tk){if(uI(tk))return{data:{user:null},error:tk};throw tk}}async generateLink(e){try{const{options:t}=e,n=DI(e,["options"]),r=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(r.new_email=null==n?void 0:n.newEmail,delete r.newEmail),await TI(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:jI,redirectTo:null==t?void 0:t.redirectTo})}catch(tk){if(uI(tk))return{data:{properties:null,user:null},error:tk};throw tk}}async createUser(e){try{return await TI(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:AI})}catch(tk){if(uI(tk))return{data:{user:null},error:tk};throw tk}}async listUsers(e){var t,n,r,s,i,a,o;try{const l={nextPage:null,lastPage:0,total:0},c=await TI(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(n=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",per_page:null!==(s=null===(r=null==e?void 0:e.perPage)||void 0===r?void 0:r.toString())&&void 0!==s?s:""},xform:RI});if(c.error)throw c.error;const u=await c.json(),h=null!==(i=c.headers.get("x-total-count"))&&void 0!==i?i:0,d=null!==(o=null===(a=c.headers.get("link"))||void 0===a?void 0:a.split(","))&&void 0!==o?o:[];return d.length>0&&(d.forEach((e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),n=JSON.parse(e.split(";")[1].split("=")[1]);l[`${n}Page`]=t})),l.total=parseInt(h)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(tk){if(uI(tk))return{data:{users:[]},error:tk};throw tk}}async getUserById(e){try{return await TI(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:AI})}catch(tk){if(uI(tk))return{data:{user:null},error:tk};throw tk}}async updateUserById(e,t){try{return await TI(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:AI})}catch(tk){if(uI(tk))return{data:{user:null},error:tk};throw tk}}async deleteUser(e,t=!1){try{return await TI(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:AI})}catch(tk){if(uI(tk))return{data:{user:null},error:tk};throw tk}}async _listFactors(e){try{const{data:t,error:n}=await TI(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:n}}catch(tk){if(uI(tk))return{data:null,error:tk};throw tk}}async _deleteFactor(e){try{return{data:await TI(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(tk){if(uI(tk))return{data:null,error:tk};throw tk}}}const OI={getItem:e=>J_()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{J_()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{J_()&&globalThis.localStorage.removeItem(e)}};function MI(e={}){return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}const LI=!!(globalThis&&J_()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class UI extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class FI extends UI{}async function VI(e,t,n){LI&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout((()=>{r.abort(),LI&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)}),t),await globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},(async r=>{if(!r){if(0===t)throw LI&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new FI(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(LI)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}LI&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,r.name);try{return await n()}finally{LI&&console.log("@supabase/gotrue-js: navigatorLock: released",e,r.name)}}))}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();const BI={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:K_,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},$I=3e4;async function GI(e,t,n){return await n()}class qI{constructor(e){var t,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=qI.nextInstanceID,qI.nextInstanceID+=1,this.instanceID>0&&Q_()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},BI),e);if(this.logDebugMessages=!!r.debug,"function"==typeof r.debug&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new PI({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=Z_(r.fetch),this.lock=r.lock||GI,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Q_()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=VI:this.lock=GI,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:J_()?this.storage=OI:(this.memoryStorage={},this.storage=MI(this.memoryStorage)):(this.memoryStorage={},this.storage=MI(this.memoryStorage)),Q_()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}null===(n=this.broadcastChannel)||void 0===n||n.addEventListener("message",(async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}))}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${z_}) ${(new Date).toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,(async()=>await this._initialize())))()),await this.initializePromise}async _initialize(){var e;try{const t=!!Q_()&&await this._isPKCEFlow();if(this._debug("#_initialize()","begin","is PKCE flow",t),t||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:n,error:r}=await this._getSessionFromURL(t);if(r){if(this._debug("#_initialize()","error detecting session from URL",r),function(e){return uI(e)&&"AuthImplicitGrantRedirectError"===e.name}(r)){const t=null===(e=r.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:r}}return await this._removeSession(),{error:r}}const{session:s,redirectType:i}=n;return this._debug("#_initialize()","detected session in URL",s,"redirect type",i),await this._saveSession(s),setTimeout((async()=>{"recovery"===i?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)}),0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(tk){return uI(tk)?{error:tk}:{error:new dI("Unexpected error during initialization",tk)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,r;try{const s=await TI(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(n=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==n?n:{},gotrue_meta_security:{captcha_token:null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken}},xform:EI}),{data:i,error:a}=s;if(a||!i)return{data:{user:null,session:null},error:a};const o=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(tk){if(uI(tk))return{data:{user:null,session:null},error:tk};throw tk}}async signUp(e){var t,n,r;try{let s;if("email"in e){const{email:n,password:r,options:i}=e;let a=null,o=null;"pkce"===this.flowType&&([a,o]=await oI(this.storage,this.storageKey)),s=await TI(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==i?void 0:i.emailRedirectTo,body:{email:n,password:r,data:null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:a,code_challenge_method:o},xform:EI})}else{if(!("phone"in e))throw new gI("You must provide either an email or phone number and a password");{const{phone:t,password:i,options:a}=e;s=await TI(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:i,data:null!==(n=null==a?void 0:a.data)&&void 0!==n?n:{},channel:null!==(r=null==a?void 0:a.channel)&&void 0!==r?r:"sms",gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:EI})}}const{data:i,error:a}=s;if(a||!i)return{data:{user:null,session:null},error:a};const o=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(tk){if(uI(tk))return{data:{user:null,session:null},error:tk};throw tk}}async signInWithPassword(e){try{let t;if("email"in e){const{email:n,password:r,options:s}=e;t=await TI(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:n,password:r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:NI})}else{if(!("phone"in e))throw new gI("You must provide either an email or phone number and a password");{const{phone:n,password:r,options:s}=e;t=await TI(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:n,password:r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:NI})}}const{data:n,error:r}=t;return r?{data:{user:null,session:null},error:r}:n&&n.session&&n.user?(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:r}):{data:{user:null,session:null},error:new pI}}catch(tk){if(uI(tk))return{data:{user:null,session:null},error:tk};throw tk}}async signInWithOAuth(e){var t,n,r,s;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:null===(s=e.options)||void 0===s?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,(async()=>this._exchangeCodeForSession(e)))}async _exchangeCodeForSession(e){const t=await tI(this.storage,`${this.storageKey}-code-verifier`),[n,r]=(null!=t?t:"").split("/");try{const{data:t,error:s}=await TI(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:EI});if(await nI(this.storage,`${this.storageKey}-code-verifier`),s)throw s;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=r?r:null}),error:s}):{data:{user:null,session:null,redirectType:null},error:new pI}}catch(tk){if(uI(tk))return{data:{user:null,session:null,redirectType:null},error:tk};throw tk}}async signInWithIdToken(e){try{const{options:t,provider:n,token:r,access_token:s,nonce:i}=e,a=await TI(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:r,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:EI}),{data:o,error:l}=a;return l?{data:{user:null,session:null},error:l}:o&&o.session&&o.user?(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:o,error:l}):{data:{user:null,session:null},error:new pI}}catch(tk){if(uI(tk))return{data:{user:null,session:null},error:tk};throw tk}}async signInWithOtp(e){var t,n,r,s,i;try{if("email"in e){const{email:r,options:s}=e;let i=null,a=null;"pkce"===this.flowType&&([i,a]=await oI(this.storage,this.storageKey));const{error:o}=await TI(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:r,data:null!==(t=null==s?void 0:s.data)&&void 0!==t?t:{},create_user:null===(n=null==s?void 0:s.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},code_challenge:i,code_challenge_method:a},redirectTo:null==s?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){const{phone:t,options:n}=e,{data:a,error:o}=await TI(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(r=null==n?void 0:n.data)&&void 0!==r?r:{},create_user:null===(s=null==n?void 0:n.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},channel:null!==(i=null==n?void 0:n.channel)&&void 0!==i?i:"sms"}});return{data:{user:null,session:null,messageId:null==a?void 0:a.message_id},error:o}}throw new gI("You must provide either an email or phone number.")}catch(tk){if(uI(tk))return{data:{user:null,session:null},error:tk};throw tk}}async verifyOtp(e){var t,n;try{let r,s;"options"in e&&(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo,s=null===(n=e.options)||void 0===n?void 0:n.captchaToken);const{data:i,error:a}=await TI(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:r,xform:EI});if(a)throw a;if(!i)throw new Error("An error occurred on token verification.");const o=i.session,l=i.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(tk){if(uI(tk))return{data:{user:null,session:null},error:tk};throw tk}}async signInWithSSO(e){var t,n,r;try{let s=null,i=null;return"pkce"===this.flowType&&([s,i]=await oI(this.storage,this.storageKey)),await TI(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==n?n:void 0}),(null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:CI})}catch(tk){if(uI(tk))return{data:null,error:tk};throw tk}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._reauthenticate()))}async _reauthenticate(){try{return await this._useSession((async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new fI;const{error:r}=await TI(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}}))}catch(tk){if(uI(tk))return{data:{user:null,session:null},error:tk};throw tk}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:r,options:s}=e,{error:i}=await TI(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},redirectTo:null==s?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}if("phone"in e){const{phone:n,type:r,options:s}=e,{data:i,error:a}=await TI(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:a}}throw new gI("You must provide either an email or phone number and a type")}catch(tk){if(uI(tk))return{data:{user:null,session:null},error:tk};throw tk}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,(async()=>this._useSession((async e=>e))))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch(e){}})()),n}return await this.lock(`lock:${this.storageKey}`,e,(async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await tI(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=!!e.expires_at&&e.expires_at<=Date.now()/1e3;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,n,r)=>(t||"user"!==n||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,n,r))})}return{data:{session:e},error:null}}const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,(async()=>await this._getUser()))}async _getUser(e){try{return e?await TI(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:AI}):await this._useSession((async e=>{var t,n,r;const{data:s,error:i}=e;if(i)throw i;return(null===(t=s.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await TI(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(r=null===(n=s.session)||void 0===n?void 0:n.access_token)&&void 0!==r?r:void 0,xform:AI}):{data:{user:null},error:new fI}}))}catch(tk){if(uI(tk))return function(e){return uI(e)&&"AuthSessionMissingError"===e.name}(tk)&&(await this._removeSession(),await nI(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:tk};throw tk}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._updateUser(e,t)))}async _updateUser(e,t={}){try{return await this._useSession((async n=>{const{data:r,error:s}=n;if(s)throw s;if(!r.session)throw new fI;const i=r.session;let a=null,o=null;"pkce"===this.flowType&&null!=e.email&&([a,o]=await oI(this.storage,this.storageKey));const{data:l,error:c}=await TI(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:o}),jwt:i.access_token,xform:AI});if(c)throw c;return i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}}))}catch(tk){if(uI(tk))return{data:{user:null},error:tk};throw tk}}_decodeJWT(e){return sI(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._setSession(e)))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new fI;const t=Date.now()/1e3;let n=t,r=!0,s=null;const i=sI(e.access_token);if(i.exp&&(n=i.exp,r=n<=t),r){const{session:t,error:n}=await this._callRefreshToken(e.refresh_token);if(n)return{data:{user:null,session:null},error:n};if(!t)return{data:{user:null,session:null},error:null};s=t}else{const{data:r,error:i}=await this._getUser(e.access_token);if(i)throw i;s={access_token:e.access_token,refresh_token:e.refresh_token,user:r.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(tk){if(uI(tk))return{data:{session:null,user:null},error:tk};throw tk}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._refreshSession(e)))}async _refreshSession(e){try{return await this._useSession((async t=>{var n;if(!e){const{data:r,error:s}=t;if(s)throw s;e=null!==(n=r.session)&&void 0!==n?n:void 0}if(!(null==e?void 0:e.refresh_token))throw new fI;const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}}))}catch(tk){if(uI(tk))return{data:{user:null,session:null},error:tk};throw tk}}async _getSessionFromURL(e){try{if(!Q_())throw new yI("No browser detected.");if("implicit"===this.flowType&&!this._isImplicitGrantFlow())throw new yI("Not a valid implicit grant flow url.");if("pkce"==this.flowType&&!e)throw new vI("Not a valid PKCE flow url.");const t=Y_(window.location.href);if(e){if(!t.code)throw new vI("No code detected.");const{data:e,error:n}=await this._exchangeCodeForSession(t.code);if(n)throw n;const r=new URL(window.location.href);return r.searchParams.delete("code"),window.history.replaceState(window.history.state,"",r.toString()),{data:{session:e.session,redirectType:null},error:null}}if(t.error||t.error_description||t.error_code)throw new yI(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});const{provider_token:n,provider_refresh_token:r,access_token:s,refresh_token:i,expires_in:a,expires_at:o,token_type:l}=t;if(!(s&&a&&i&&l))throw new yI("No session defined in URL");const c=Math.round(Date.now()/1e3),u=parseInt(a);let h=c+u;o&&(h=parseInt(o));const d=h-c;1e3*d<=$I&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${u}s`);const m=h-u;c-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,h,c):c-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,h,c);const{data:f,error:p}=await this._getUser(s);if(p)throw p;const g={provider_token:n,provider_refresh_token:r,access_token:s,expires_in:u,expires_at:h,refresh_token:i,token_type:l,user:f.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:t.type},error:null}}catch(tk){if(uI(tk))return{data:{session:null,redirectType:null},error:tk};throw tk}}_isImplicitGrantFlow(){const e=Y_(window.location.href);return!(!Q_()||!e.access_token&&!e.error_description)}async _isPKCEFlow(){const e=Y_(window.location.href),t=await tI(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._signOut(e)))}async _signOut({scope:e}={scope:"global"}){return await this._useSession((async t=>{var n;const{data:r,error:s}=t;if(s)return{error:s};const i=null===(n=r.session)||void 0===n?void 0:n.access_token;if(i){const{error:t}=await this.admin.signOut(i,e);if(t&&(!function(e){return uI(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await nI(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>{await this.initializePromise,await this._acquireLock(-1,(async()=>{this._emitInitialSession(t)}))})(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession((async t=>{var n,r;try{const{data:{session:r},error:s}=t;if(s)throw s;await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(s){await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}}))}async resetPasswordForEmail(e,t={}){let n=null,r=null;"pkce"===this.flowType&&([n,r]=await oI(this.storage,this.storageKey,!0));try{return await TI(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(tk){if(uI(tk))return{data:null,error:tk};throw tk}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(tk){if(uI(tk))return{data:null,error:tk};throw tk}}async linkIdentity(e){var t;try{const{data:n,error:r}=await this._useSession((async t=>{var n,r,s,i,a;const{data:o,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(n=e.options)||void 0===n?void 0:n.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(s=e.options)||void 0===s?void 0:s.queryParams,skipBrowserRedirect:!0});return await TI(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(a=null===(i=o.session)||void 0===i?void 0:i.access_token)&&void 0!==a?a:void 0})}));if(r)throw r;return Q_()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null==n?void 0:n.url),{data:{provider:e.provider,url:null==n?void 0:n.url},error:null}}catch(tk){if(uI(tk))return{data:{provider:e.provider,url:null},error:tk};throw tk}}async unlinkIdentity(e){try{return await this._useSession((async t=>{var n,r;const{data:s,error:i}=t;if(i)throw i;return await TI(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(r=null===(n=s.session)||void 0===n?void 0:n.access_token)&&void 0!==r?r:void 0})}))}catch(tk){if(uI(tk))return{data:null,error:tk};throw tk}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await(n=async n=>(n>0&&await async function(e){return await new Promise((t=>{setTimeout((()=>t(null)),e)}))}(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await TI(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:EI})),r=(e,t)=>{const n=200*Math.pow(2,e);return t&&bI(t)&&Date.now()+n-s<$I},new Promise(((e,t)=>{(async()=>{for(let i=0;i<1/0;i++)try{const t=await n(i);if(!r(i,null,t))return void e(t)}catch(s){if(!r(i,s))return void t(s)}})()})))}catch(tk){if(this._debug(t,"error",tk),uI(tk))return{data:{session:null,user:null},error:tk};throw tk}finally{this._debug(t,"end")}var n,r}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),Q_()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const n=await tI(this.storage,this.storageKey);if(this._debug(t,"session from storage",n),!this._isValidSession(n))return this._debug(t,"session is not valid"),void(null!==n&&await this._removeSession());const r=Math.round(Date.now()/1e3),s=(null!==(e=n.expires_at)&&void 0!==e?e:1/0)<r+10;if(this._debug(t,`session has${s?"":" not"} expired with margin of 10s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:e}=await this._callRefreshToken(n.refresh_token);e&&(console.error(e),bI(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){return this._debug(t,"error",n),void console.error(n)}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new fI;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new rI;const{data:t,error:n}=await this._refreshAccessToken(e);if(n)throw n;if(!t.session)throw new fI;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const r={session:t.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(tk){if(this._debug(r,"error",tk),uI(tk)){const n={session:null,error:tk};return bI(tk)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(n),n}throw null===(n=this.refreshingDeferred)||void 0===n||n.reject(tk),tk}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,n=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],s=Array.from(this.stateChangeEmitters.values()).map((async n=>{try{await n.callback(e,t)}catch(s){r.push(s)}}));if(await Promise.all(s),r.length>0){for(let e=0;e<r.length;e+=1)console.error(r[e]);throw r[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await eI(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await nI(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Q_()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval((()=>this._autoRefreshTokenTick()),$I);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout((async()=>{await this.initializePromise,await this._autoRefreshTokenTick()}),0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,(async()=>{try{const t=Date.now();try{return await this._useSession((async e=>{const{data:{session:n}}=e;if(!n||!n.refresh_token||!n.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const r=Math.floor((1e3*n.expires_at-t)/$I);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),r<=3&&await this._callRefreshToken(n.refresh_token)}))}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(!(e.isAcquireTimeout||e instanceof UI))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Q_()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(tk){console.error("_handleVisibilityChange",tk)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,(async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const r=[`provider=${encodeURIComponent(t)}`];if((null==n?void 0:n.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),(null==n?void 0:n.scopes)&&r.push(`scopes=${encodeURIComponent(n.scopes)}`),"pkce"===this.flowType){const[e,t]=await oI(this.storage,this.storageKey),n=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});r.push(n.toString())}if(null==n?void 0:n.queryParams){const e=new URLSearchParams(n.queryParams);r.push(e.toString())}return(null==n?void 0:n.skipBrowserRedirect)&&r.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession((async t=>{var n;const{data:r,error:s}=t;return s?{data:null,error:s}:await TI(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(n=null==r?void 0:r.session)||void 0===n?void 0:n.access_token})}))}catch(tk){if(uI(tk))return{data:null,error:tk};throw tk}}async _enroll(e){try{return await this._useSession((async t=>{var n,r;const{data:s,error:i}=t;if(i)return{data:null,error:i};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:o,error:l}=await TI(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:null===(n=null==s?void 0:s.session)||void 0===n?void 0:n.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(r=null==o?void 0:o.totp)||void 0===r?void 0:r.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})}))}catch(tk){if(uI(tk))return{data:null,error:tk};throw tk}}async _verify(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var n;const{data:r,error:s}=t;if(s)return{data:null,error:s};const{data:i,error:a}=await TI(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(n=null==r?void 0:r.session)||void 0===n?void 0:n.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:a})}))}catch(tk){if(uI(tk))return{data:null,error:tk};throw tk}}))}async _challenge(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var n;const{data:r,error:s}=t;return s?{data:null,error:s}:await TI(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(n=null==r?void 0:r.session)||void 0===n?void 0:n.access_token})}))}catch(tk){if(uI(tk))return{data:null,error:tk};throw tk}}))}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=(null==e?void 0:e.factors)||[],r=n.filter((e=>"totp"===e.factor_type&&"verified"===e.status)),s=n.filter((e=>"phone"===e.factor_type&&"verified"===e.status));return{data:{all:n,totp:r,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,(async()=>await this._useSession((async e=>{var t,n;const{data:{session:r},error:s}=e;if(s)return{data:null,error:s};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const i=this._decodeJWT(r.access_token);let a=null;i.aal&&(a=i.aal);let o=a;(null!==(n=null===(t=r.user.factors)||void 0===t?void 0:t.filter((e=>"verified"===e.status)))&&void 0!==n?n:[]).length>0&&(o="aal2");return{data:{currentLevel:a,nextLevel:o,currentAuthenticationMethods:i.amr||[]},error:null}}))))}}qI.nextInstanceID=0;const zI=qI;class KI extends zI{constructor(e){super(e)}}var HI=globalThis&&globalThis.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function a(e){try{l(r.next(e))}catch(t){i(t)}}function o(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};class WI{constructor(e,t,n){var r,s,i;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const a=e.replace(/\/$/,"");this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;const o=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,l=function(e,t){const{db:n,auth:r,realtime:s,global:i}=e,{db:a,auth:o,realtime:l,global:c}=t,u={db:Object.assign(Object.assign({},a),n),auth:Object.assign(Object.assign({},o),r),realtime:Object.assign(Object.assign({},l),s),global:Object.assign(Object.assign({},c),i),accessToken:()=>q_(this,void 0,void 0,(function*(){return""}))};return e.accessToken?u.accessToken=e.accessToken:delete u.accessToken,u}(null!=n?n:{},{db:F_,realtime:B_,auth:Object.assign(Object.assign({},V_),{storageKey:o}),global:U_});this.storageKey=null!==(r=l.auth.storageKey)&&void 0!==r?r:"",this.headers=null!==(s=l.global.headers)&&void 0!==s?s:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(i=l.auth)&&void 0!==i?i:{},this.headers,l.global.fetch),this.fetch=G_(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},l.realtime)),this.rest=new Sx(`${a}/rest/v1`,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),l.accessToken||this._listenForAuthEvents()}get functions(){return new Mb(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new M_(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return HI(this,void 0,void 0,(function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return null!==(t=null===(e=n.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null}))}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:r,storageKey:s,flowType:i,lock:a,debug:o},l,c){var u;const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new KI({url:this.authUrl,headers:Object.assign(Object.assign({},h),l),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:r,flowType:i,lock:a,debug:o,fetch:c,hasCustomAuthorizationHeader:null!==(u="Authorization"in this.headers)&&void 0!==u&&u})}_initRealtimeClient(e){return new m_(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)}))}_handleTokenChanged(e,t,n){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===n?"SIGNED_OUT"===e&&(this.realtime.setAuth(this.supabaseKey),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):(this.realtime.setAuth(null!=n?n:null),this.changedAccessToken=n)}}const QI=new WI("https://xyzcompany.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",XI);var XI;QI.channel("schema-db-changes").on("postgres_changes",{event:"*",schema:"public"},(e=>{console.log("Change received!",e)})).subscribe();const JI=ew(((e,t)=>({users:[],onlineUsers:new Set,isLoading:!1,error:null,fetchUsers:async()=>{e({isLoading:!0});try{const{data:t,error:n}=await QI.from("users").select("*").order("created_at",{ascending:!1});if(n)throw n;e({users:t,isLoading:!1})}catch(tk){e({error:tk.message,isLoading:!1})}},addUser:async t=>{try{const{data:n,error:r}=await QI.from("users").insert([t]).select().single();if(r)throw r;return e((e=>({users:[...e.users,n]}))),n}catch(tk){throw e({error:tk.message}),tk}},updateUserProfile:async(t,n)=>{try{if(n.profilePic instanceof File){const e=n.profilePic.name.split(".").pop(),r=`${t}-${Date.now()}.${e}`,{error:s}=await QI.storage.from("profiles").upload(r,n.profilePic);if(s)throw s;const{data:{publicUrl:i}}=QI.storage.from("profiles").getPublicUrl(r);n.profilePic=i}const{data:r,error:s}=await QI.from("users").update(n).eq("id",t).select().single();if(s)throw s;return e((e=>({users:e.users.map((e=>e.id===t?{...e,...r}:e))}))),r}catch(tk){throw e({error:tk.message}),tk}},setOnlineStatus:(t,n)=>e((e=>{const r=new Set(e.onlineUsers);return n?r.add(t):r.delete(t),{onlineUsers:r}})),getUser:e=>t().users.find((t=>t.id===e)),isUserOnline:e=>t().onlineUsers.has(e)})));function YI(){const{user:t}=lg(),n=JI((e=>e.updateUserProfile)),[r,s]=e.useState(!1),[i,a]=e.useState(!1),[o,l]=e.useState("");return t?S.jsx("div",{className:"min-h-screen pt-24",children:S.jsx("div",{className:"max-w-4xl mx-auto px-6 py-12",children:S.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"glass-effect rounded-xl p-8",children:[S.jsxs("div",{className:"flex items-center gap-6 mb-8",children:[S.jsx("div",{className:"relative group",children:S.jsxs("label",{className:"cursor-pointer block",children:[t.avatar?S.jsx("img",{src:t.avatar,alt:t.username,className:"w-24 h-24 rounded-full object-cover"}):S.jsx(Ty,{className:"w-24 h-24 text-gray-400"}),S.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:S.jsx("span",{className:"text-white text-sm",children:i?"Uploading...":"Change"})}),S.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:async e=>{var r;const s=null==(r=e.target.files)?void 0:r[0];if(s)if(s.type.startsWith("image/"))if(s.size>5242880)l("Image size should be less than 5MB");else try{a(!0),l(""),await n(t.id,{profilePic:s})}catch(i){l("Failed to upload image. Please try again.")}finally{a(!1)}else l("Please select an image file")},disabled:i})]})}),S.jsxs("div",{children:[S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("h1",{className:"text-3xl font-bold text-white",children:t.username}),S.jsx("button",{onClick:()=>s(!r),className:"p-1 hover:bg-white/10 rounded-lg transition-colors",children:S.jsx(ly,{className:"h-5 w-5 text-gray-400"})})]}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("span",{className:"px-2 py-1 rounded-full text-sm "+("Owner"===t.role?"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30":"bg-blue-500/20 text-blue-400 border border-blue-500/30"),children:t.role||"Member"}),S.jsxs("span",{className:"text-gray-400",children:["Member since ",new Date(t.joinDate).toLocaleDateString()]})]})]})]}),o&&S.jsx("div",{className:"mb-4 p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400",children:o}),S.jsxs("div",{className:"space-y-6",children:[S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Discord ID"}),S.jsx("p",{className:"text-white",children:t.discordId})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email"}),S.jsx("p",{className:"text-white",children:t.email})]}),r&&S.jsx("div",{className:"pt-6 border-t border-gray-700",children:S.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-white transition-colors",children:"Save Changes"})})]})]})})}):S.jsx("div",{className:"min-h-screen pt-24 flex items-center justify-center",children:S.jsxs("div",{className:"text-center",children:[S.jsx("h1",{className:"text-3xl font-bold text-red-500 mb-4",children:"Access Denied"}),S.jsx("p",{className:"text-gray-400",children:"Please log in to view your profile."})]})})}const ZI=()=>{const{isAuthenticated:e}=lg();return e?S.jsx(c,{}):S.jsx(u,{to:"/auth"})};function ek(){return S.jsx(h,{children:S.jsx(og,{children:S.jsxs("div",{className:"min-h-screen bg-black",children:[S.jsx(cg,{}),S.jsxs(d,{children:[S.jsx(m,{path:"/",element:S.jsx(Hy,{})}),S.jsx(m,{path:"/auth",element:S.jsx(cw,{})}),S.jsx(m,{path:"/auth/callback",element:S.jsx(uw,{})}),S.jsxs(m,{element:S.jsx(ZI,{}),children:[S.jsx(m,{path:"/steam",element:S.jsx(lv,{})}),S.jsx(m,{path:"/methods",element:S.jsx(fv,{})}),S.jsx(m,{path:"/other-services",element:S.jsx(Sv,{})}),S.jsx(m,{path:"/geforce-now",element:S.jsx(gv,{})}),S.jsx(m,{path:"/stremio",element:S.jsx(vv,{})}),S.jsx(m,{path:"/accounts",element:S.jsx(Iv,{})}),S.jsx(m,{path:"/members",element:S.jsx(Tv,{})}),S.jsx(m,{path:"/feedback",element:S.jsx(lw,{})}),S.jsx(m,{path:"/dashboard",element:S.jsx(Tb,{})}),S.jsx(m,{path:"/profile",element:S.jsx(YI,{})})]})]})]})})})}T.createRoot(document.getElementById("root")).render(S.jsx(a.StrictMode,{children:S.jsx(ek,{})})),"serviceWorker"in navigator&&window.addEventListener("load",(()=>{navigator.serviceWorker.register("/sw.js").then((e=>{console.log("SW registered:",e)})).catch((e=>{console.log("SW registration failed:",e)}))}));
